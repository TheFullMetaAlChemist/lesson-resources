<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maxwell-Boltzmann Distribution Chemistry Game</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* --- Colors --- */
            --primary-color: #4a6fa5;        /* Main blue */
            --primary-dark: #3a5a80;         /* Darker blue */
            --secondary-color: #6c5ce7;       /* Purple accent */
            --secondary-dark: #5244b7;        /* Darker purple */
            --accent-color: #fdcb6e;         /* Yellow accent */
            --success-color: #00b894;        /* Green for correct */
            --success-dark: #008a70;         /* Darker green */
            --error-color: #d63031;          /* Red for incorrect */
            --error-dark: #b71c1c;           /* Darker red */
            --light-bg: #f7f9fc;             /* Very light grey background */
            --medium-bg: #eef1f5;            /* Light grey for containers */
            --dark-text: #2d3436;            /* Main text color */
            --light-text: #ffffff;           /* Text on dark backgrounds */
            --border-color: #dee2e6;         /* Standard border */
            --grid-line-color: #e9ecef;      /* Grid lines in graph */
            --shadow-color-light: rgba(45, 52, 54, 0.08); /* Soft shadow */
            --shadow-color-medium: rgba(45, 52, 54, 0.12);/* Medium shadow */

            /* Difficulty Colors */
            --easy-color: #a2d2ff;            /* Light blue */
            --easy-dark: #74b9ff;             /* Medium blue */
            --medium-color: #feca46;          /* Yellow */
            --medium-dark: #fabc2a;           /* Darker yellow */
            --hard-color: #ff8c94;            /* Light red/pink */
            --hard-dark: #ff7675;             /* Medium red */

            /* Player Colors */
            --player1-color: #64b5f6;          /* Player 1 blue */
            --player1-border: #1e88e5;         /* Player 1 darker blue */
            --player2-color: #ffb74d;          /* Player 2 orange */
            --player2-border: #fb8c00;         /* Player 2 darker orange */

            /* --- Layout & Typography --- */
            --border-radius: 8px;
            --transition-speed: 0.25s;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--light-bg);
            color: var(--dark-text);
            line-height: 1.6;
            padding: 25px;
            font-size: 16px; /* Base font size */
        }

        h1, h2, h3 {
            text-align: center;
            color: var(--primary-dark);
            margin-bottom: 1.2em;
        }
        h1 { font-size: 2.6em; font-weight: 700; letter-spacing: -0.5px;}
        h2 { font-size: 1.8em; font-weight: 600;}
        h3 { font-size: 1.3em; font-weight: 600; text-align: left; margin-top: 1.2em; margin-bottom: 0.8em;}

        .container {
            max-width: 1150px;
            margin: 25px auto;
            padding: 30px;
            background-color: var(--light-text);
            border-radius: var(--border-radius);
            box-shadow: 0 8px 25px var(--shadow-color-medium);
        }

        /* --- Controls Styling --- */
        .game-controls {
            display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center;
            gap: 20px; margin-bottom: 35px; padding: 20px;
            background-color: var(--medium-bg); border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
        }
        .control-group { display: flex; align-items: center; gap: 10px; }
        label { font-weight: 600; color: var(--primary-dark); font-size: 0.95em; }
        select {
            padding: 9px 14px; border: 1px solid var(--border-color); border-radius: var(--border-radius);
            background-color: var(--light-text); cursor: pointer; font-family: inherit; font-size: 0.95em;
            transition: border-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
        }
        select:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(74, 111, 165, 0.15); }
        select:disabled { background-color: #f8f9fa; cursor: not-allowed; opacity: 0.7; }

        /* --- Button Styling --- */
        button {
            padding: 10px 22px; border: none; border-radius: var(--border-radius); color: var(--light-text);
            cursor: pointer; font-weight: 600; font-size: 1em; font-family: inherit;
            transition: all var(--transition-speed) ease; box-shadow: 0 3px 5px var(--shadow-color-light);
            background-color: var(--primary-color); text-align: center;
        }
        button:hover:not(:disabled) { background-color: var(--primary-dark); transform: translateY(-2px); box-shadow: 0 5px 10px var(--shadow-color-medium); }
        button:active:not(:disabled) { transform: translateY(0px); box-shadow: 0 2px 4px var(--shadow-color-light); }
        button:disabled { background-color: #ced4da; color: #6c757d; cursor: not-allowed; box-shadow: none; opacity: 0.7; }

        .start-button { background-color: var(--success-color); padding: 12px 28px; font-size: 1.1em; }
        .start-button:hover:not(:disabled) { background-color: var(--success-dark); }
        .reset-button { background-color: var(--error-color); }
        .reset-button:hover:not(:disabled) { background-color: var(--error-dark); }
        .instructions-toggle { background-color: var(--secondary-color); padding: 9px 18px; }
        .instructions-toggle:hover:not(:disabled) { background-color: var(--secondary-dark); }

        /* --- Distribution Area Styling --- */
        .distribution-container {
            display: flex; flex-direction: column; align-items: center;
            margin: 35px 0; position: relative; height: 430px;
            padding: 35px 25px 45px 60px; /* Space for rotated label */
            background: linear-gradient(140deg, #ffffff 0%, #f5f7fa 100%);
            border-radius: var(--border-radius); box-shadow: 0 6px 15px var(--shadow-color-medium);
            border: 1px solid var(--border-color); overflow: hidden;
        }
        .grid-lines { position: absolute; top: 35px; left: 60px; width: calc(100% - 85px); height: 300px; z-index: 0; pointer-events: none; }
        .grid-lines line { stroke: var(--grid-line-color); stroke-width: 1; }
        .energy-levels { display: flex; justify-content: space-around; width: 100%; height: 300px; align-items: flex-end; position: relative; margin-top: 20px; padding: 0 10px; z-index: 2; }
        .energy-level { flex: 1; max-width: 65px; min-width: 30px; background-color: #e4eaf1; border-radius: 6px 6px 0 0; display: flex; flex-direction: column-reverse; align-items: center; position: relative; margin: 0 4px; transition: height var(--transition-speed) ease-out, background-color var(--transition-speed) ease; box-shadow: inset 0 -3px 6px rgba(0,0,0,0.04); }
        .energy-level-number { position: absolute; bottom: -28px; font-weight: 600; font-size: 0.9em; color: var(--primary-dark); }
        .token-container { width: 100%; display: flex; flex-direction: column-reverse; align-items: center; padding: 5px 0; gap: 4px; }
        .token { width: 85%; max-width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--dark-text); font-weight: 700; font-size: 13px; box-shadow: 0 3px 6px rgba(0,0,0,0.2); transition: transform 0.2s ease-out; border-style: solid; border-width: 2px; }
        .player1-token { background: linear-gradient(135deg, var(--player1-color), lighten(var(--player1-color), 12%)); border-color: var(--player1-border); }
        .player2-token { background: linear-gradient(135deg, var(--player2-color), lighten(var(--player2-color), 12%)); border-color: var(--player2-border); }
        .token.added { animation: popIn 0.3s ease-out forwards; }
        @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 70% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }

        /* --- Axis Styling --- */
        .axis { background-color: #555; position: absolute; z-index: 3; }
        .x-axis { width: calc(100% - 85px); height: 2px; bottom: 45px; left: 60px; background-color: #777; }
        .x-axis::after { content: 'Energy →'; position: absolute; right: -5px; bottom: -28px; font-weight: 600; font-size: 0.95em; color: var(--dark-text); }
        .y-axis { left: 60px; bottom: 45px; width: 2px; height: 300px; background-color: #777; }
        .y-axis::before {
            content: 'Number of Molecules'; position: absolute;
            top: 50%; left: -50px;
            transform: translateY(-50%) rotate(-90deg); transform-origin: center;
            font-weight: 600; white-space: nowrap; font-size: 0.95em; color: var(--dark-text);
        }

        /* --- Activation Energy & Curve Styling --- */
        .activation-energy { position: absolute; bottom: 45px; right: 18%; width: 2.5px; height: 60%; background-color: var(--error-color); z-index: 10; border-radius: 1px; }
        .activation-energy::before { content: 'Ea'; position: absolute; top: -30px; left: -10px; color: var(--error-color); font-weight: bold; font-size: 1.15em; }
        .distribution-curve { position: absolute; bottom: 45px; left: 60px; width: calc(100% - 85px); height: 300px; z-index: 5; pointer-events: none; }
        .mb-path-line { fill: none; stroke: var(--secondary-color); stroke-width: 3.5; stroke-linecap: round; filter: drop-shadow(0 1px 1px rgba(0,0,0,0.2)); }
        .mb-path-fill { fill: var(--secondary-color); opacity: 0.08; stroke: none; }

        /* --- Dynamic Difficulty Styling --- */
        #difficulty-choice-container {
            text-align: center; margin: 25px 0 30px 0; padding: 25px;
            background-color: var(--light-text); border-radius: var(--border-radius);
            box-shadow: 0 5px 15px var(--shadow-color-medium); border: 1px solid var(--border-color);
        }
        #difficulty-choice-container h3 { margin-bottom: 20px; color: var(--primary-dark); font-size: 1.4em; }
        .difficulty-buttons { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .difficulty-btn {
            padding: 12px 28px; font-size: 1.1em; min-width: 140px;
            color: var(--dark-text); border: 1px solid; box-shadow: 0 2px 4px var(--shadow-color-light);
        }
        .difficulty-btn.easy-btn { background-color: var(--easy-color); border-color: var(--easy-dark); }
        .difficulty-btn.easy-btn:hover:not(:disabled) { background-color: var(--easy-dark); border-color: darken(var(--easy-dark), 10%); transform: translateY(-2px); box-shadow: 0 4px 8px var(--shadow-color-light);}
        .difficulty-btn.medium-btn { background-color: var(--medium-color); border-color: var(--medium-dark); }
        .difficulty-btn.medium-btn:hover:not(:disabled) { background-color: var(--medium-dark); border-color: darken(var(--medium-dark), 10%); transform: translateY(-2px); box-shadow: 0 4px 8px var(--shadow-color-light);}
        .difficulty-btn.hard-btn { background-color: var(--hard-color); border-color: var(--hard-dark); }
        .difficulty-btn.hard-btn:hover:not(:disabled) { background-color: var(--hard-dark); border-color: darken(var(--hard-dark), 10%); transform: translateY(-2px); box-shadow: 0 4px 8px var(--shadow-color-light);}
        .difficulty-btn span { font-size: 0.9em; opacity: 0.8; margin-left: 4px; } /* Style the count span */

        /* --- Question Area Styling --- */
        .question-container {
            background-color: var(--light-text); padding: 30px; border-radius: var(--border-radius);
            margin: 30px 0; box-shadow: 0 5px 15px var(--shadow-color-medium);
            position: relative; border-left: 6px solid var(--primary-color);
            border: 1px solid var(--border-color);
        }
        .difficulty-label { position: absolute; top: 18px; right: 18px; padding: 5px 14px; border-radius: var(--border-radius); font-weight: 600; font-size: 0.9em; color: var(--dark-text); text-transform: capitalize; box-shadow: 0 1px 2px var(--shadow-color-light); }
        .easy { background-color: var(--easy-color); border: 1px solid var(--easy-dark);}
        .medium { background-color: var(--medium-color); border: 1px solid var(--medium-dark);}
        .hard { background-color: var(--hard-color); border: 1px solid var(--hard-dark);}
        .question-text { font-size: 1.2em; margin-bottom: 30px; font-weight: 400; color: var(--dark-text); line-height: 1.6; }
        .options { display: flex; flex-direction: column; gap: 14px; }
        .option {
            padding: 14px 20px; background-color: var(--medium-bg); border: 1px solid var(--border-color);
            border-radius: var(--border-radius); cursor: pointer;
            transition: all var(--transition-speed) ease; position: relative; font-size: 1em;
        }
        /* Only apply hover to non-feedback states */
        .option:hover:not(.selected):not(.correct):not(.incorrect) {
             background-color: #dce3ec; border-color: #adb5bd; transform: translateX(4px);
        }
        .option.selected { background-color: var(--primary-color); color: var(--light-text); border-color: var(--primary-dark); font-weight: 600; transform: translateX(0); box-shadow: 0 2px 5px rgba(74, 111, 165, 0.3); }
        .option.correct { background-color: var(--success-color); color: var(--light-text); border-color: var(--success-dark); font-weight: 600; transform: translateX(0); }
        .option.correct::after { content: '✔'; position: absolute; right: 18px; top: 50%; transform: translateY(-50%); font-size: 1.3em; color: var(--light-text); }
        .option.incorrect { background-color: var(--error-color); color: var(--light-text); border-color: var(--error-dark); font-weight: 600; transform: translateX(0); }
        .option.incorrect::after { content: '✖'; position: absolute; right: 18px; top: 50%; transform: translateY(-50%); font-size: 1.3em; color: var(--light-text); }
        .submit-btn { margin-top: 30px; width: 100%; padding: 14px; font-size: 1.15em; background-color: var(--secondary-color); }
        .submit-btn:hover:not(:disabled) { background-color: var(--secondary-dark); }

        /* --- Scoreboard & Message Styling --- */
        .scoreboard {
            display: flex; justify-content: space-around; flex-wrap: wrap;
            gap: 20px; margin-top: 35px; background-color: var(--medium-bg); padding: 25px;
            border-radius: var(--border-radius); box-shadow: inset 0 3px 6px var(--shadow-color-light);
            border: 1px solid var(--border-color);
        }
        .player-score {
            text-align: center; padding: 18px 35px; border-radius: var(--border-radius);
            min-width: 160px; transition: background-color var(--transition-speed) ease, opacity var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            box-shadow: 0 4px 8px var(--shadow-color-light); border-width: 2px; border-style: solid;
        }
         .player-score:hover { box-shadow: 0 6px 12px var(--shadow-color-medium); }
        .player-score div:first-child { font-weight: 600; margin-bottom: 8px; font-size: 1.15em; color: var(--dark-text); }
        .player1-score { background-color: var(--player1-color); border-color: var(--player1-border);}
        .player2-score { background-color: var(--player2-color); border-color: var(--player2-border);}
        .score-value { font-size: 2.4em; font-weight: 700; color: var(--primary-dark); }

        .game-message {
            text-align: center; margin: 35px 0; padding: 18px 25px;
            border-radius: var(--border-radius); background-color: var(--light-text);
            font-weight: 600; font-size: 1.15em; border: 1px solid var(--border-color);
            box-shadow: 0 5px 12px var(--shadow-color-light); color: var(--primary-dark);
            min-height: 60px; display: flex; align-items: center; justify-content: center;
        }

        /* --- Instructions Styling --- */
        .instructions {
            background-color: var(--light-text); padding: 25px; border-radius: var(--border-radius);
            margin: 25px 0; box-shadow: 0 5px 15px var(--shadow-color-medium);
            border-left: 6px solid var(--secondary-color); border: 1px solid var(--border-color);
        }
        .instructions-content { margin-top: 15px; padding-left: 15px; border-left: 3px solid var(--medium-bg); max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out, margin-top 0.5s ease-out, padding-top 0.5s ease-out; }
        .instructions-content.visible { max-height: 600px; margin-top: 25px; padding-top: 10px; }
        .instructions-content h4 { margin-top: 1.2em; margin-bottom: 0.6em; color: var(--primary-color); font-size: 1.1em; }
        .instructions-content ol, .instructions-content ul { margin-left: 25px; margin-bottom: 1.2em; }
        .instructions-content li { margin-bottom: 0.6em; }
        .instructions-content strong { color: var(--primary-dark); font-weight: 600; }

        /* --- Utility & Player Selector Styling --- */
        .hidden { display: none !important; }
        #player-selector { padding: 9px 16px; background-color: var(--light-text); border-radius: var(--border-radius); border: 1px solid var(--border-color); font-weight: 600; }
        #current-player { color: var(--secondary-color); display: inline-block; margin-left: 8px; font-weight: 700; }

        /* --- Responsive Adjustments --- */
        @media (max-width: 992px) {
             .game-controls { flex-direction: column; align-items: stretch; }
             .control-group { justify-content: space-between; }
             .control-group button { width: 100%; }
             .scoreboard { flex-direction: column; gap: 15px; }
             .player-score { min-width: unset; }
             .difficulty-buttons { flex-direction: column; gap: 10px; }
             .difficulty-btn { width: 100%; }
        }
        @media (max-width: 600px) { /* Mobile specific refinements */
            body { padding: 15px; font-size: 15px; }
            h1 { font-size: 2.1em; }
            .container { padding: 20px; }
            .game-controls { padding: 15px; gap: 15px; }
            .control-group button { padding: 12px 20px; }
            .distribution-container { height: 400px; padding: 25px 15px 40px 50px; }
            .grid-lines { left: 50px; width: calc(100% - 65px); top: 25px;}
            .y-axis { left: 50px; bottom: 40px; top: unset; height: 300px; } /* Ensure correct position */
            .y-axis::before { font-size: 0.85em; left: -40px; }
            .x-axis { left: 50px; width: calc(100% - 65px); bottom: 40px; }
            .x-axis::after { font-size: 0.85em; bottom: -25px;}
            .energy-level { max-width: 45px; min-width: 28px; margin: 0 2px;}
            .token { max-width: 32px; height: 32px; font-size: 11px; border-width: 1.5px; }
            .activation-energy { right: 15%; width: 2px; bottom: 40px; height: 60%;}
            .activation-energy::before { font-size: 1.05em; top: -25px; left: -8px; }
            .distribution-curve { left: 50px; width: calc(100% - 65px); bottom: 40px; height: 300px;}
            #difficulty-choice-container { padding: 20px; }
            #difficulty-choice-container h3 { font-size: 1.25em; }
            .difficulty-btn { padding: 10px 20px; font-size: 1em; min-width: unset; }
            .question-container { padding: 25px; }
            .question-text { font-size: 1.15em; margin-bottom: 25px;} /* Adjusted */
            .option { padding: 12px 18px; font-size: 0.95em;} /* Adjusted */
            .option.correct::after, .option.incorrect::after { font-size: 1.1em; right: 12px;}
            .submit-btn { padding: 12px; font-size: 1.1em; }
            .scoreboard { padding: 20px; }
            .player-score { padding: 15px 25px; }
            .score-value { font-size: 2.1em; }
            .game-message { padding: 15px 20px; font-size: 1.1em; min-height: 55px; }
            .instructions { padding: 20px; }
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>Maxwell-Boltzmann Chemistry Game</h1>

        <!-- Instructions Section -->
        <div class="instructions">
            <button class="instructions-toggle" onclick="toggleInstructions()">Show/Hide Instructions</button>
            <div class="instructions-content" id="instructions-content">
                 <h3>How to Play</h3>
                <h4>Overview:</h4>
                <p>Answer chemistry questions related to reaction rates and energy distributions. Before each question, choose the difficulty (Easy, Medium, Hard). Correct answers allow you to place 'molecule' tokens onto energy levels, aiming to build a Maxwell-Boltzmann distribution.</p>
                <h4>Game Modes:</h4>
                <ul>
                    <li><strong>Solo Mode:</strong> Choose difficulty, answer questions, place tokens. Score points for correct answers and bonus points for creating a distribution shape that resembles the target curve (peaking at lower energy, tailing off to the right).</li>
                    <li><strong>Two-Player Mode:</strong> Players take turns choosing difficulty and answering. Answer correctly to place your token (Blue for P1, Orange for P2). An incorrect answer passes the turn. The player with the highest score when questions run out wins.</li>
                </ul>
                 <h4>Token Placement:</h4>
                 <p>The difficulty level you choose influences where the token is most likely to be placed:</p>
                <ul>
                    <li><strong>Easy</strong> questions: Primarily place tokens on lower energy levels (1-4).</li>
                    <li><strong>Medium</strong> questions: Primarily place tokens on mid-range energy levels (3-7).</li>
                    <li><strong>Hard</strong> questions: Primarily place tokens on higher energy levels (6-10), helping to build the 'tail' of the distribution.</li> {/* Instruction Updated */}
                </ul>
                 <h4>Goal:</h4>
                <p>Visually represent the concept that most molecules have lower to average energy, while fewer have very high energy. Strategically choose difficulties to shape your distribution!</p>
            </div>
        </div>

        <!-- Game Controls Section -->
        <div class="game-controls">
            <div class="control-group">
                <label for="game-mode">Mode:</label>
                <select id="game-mode" onchange="updateGameMode()">
                    <option value="solo">Solo</option>
                    <option value="two-player">Two-Player</option>
                </select>
            </div>
            <div class="control-group hidden" id="player-selector-container">
                 <div id="player-selector">
                    <label>Turn:</label>
                    <div id="current-player">Player 1</div>
                 </div>
            </div>
            <div class="control-group">
                <button class="start-button" onclick="startGame()" id="start-button">Start Game</button>
                <button class="reset-button" onclick="resetGame()" id="reset-button" disabled>Reset Game</button>
            </div>
        </div>

         <!-- Dynamic Difficulty Choice Area -->
        <div id="difficulty-choice-container" class="hidden">
            <h3>Player <span id="choice-player-number">1</span>: Choose Question Difficulty</h3>
            <div class="difficulty-buttons">
                <button class="difficulty-btn easy-btn" id="choose-easy" onclick="selectQuestionDifficulty('easy')">Easy (<span id="easy-count">0</span> left)</button>
                <button class="difficulty-btn medium-btn" id="choose-medium" onclick="selectQuestionDifficulty('medium')">Medium (<span id="medium-count">0</span> left)</button>
                <button class="difficulty-btn hard-btn" id="choose-hard" onclick="selectQuestionDifficulty('hard')">Hard (<span id="hard-count">0</span> left)</button>
            </div>
        </div>

        <!-- Distribution Visualization Area -->
        <div class="distribution-container">
             <svg class="grid-lines" preserveAspectRatio="none" viewBox="0 0 100 100">
                <line x1="0" y1="80" x2="100" y2="80" /> <line x1="0" y1="60" x2="100" y2="60" /> <line x1="0" y1="40" x2="100" y2="40" /> <line x1="0" y1="20" x2="100" y2="20" /> <line x1="0" y1="0" x2="100" y2="0" />
             </svg>
            <svg class="distribution-curve" viewBox="0 0 100 100" preserveAspectRatio="none">
                <path class="mb-path-fill" d="M 0 100 V 98 C 5 90, 15 10, 25 5 S 45 2, 60 15 C 75 30, 90 65, 100 80 V 100 Z" vector-effect="non-scaling-stroke"/>
                <path class="mb-path-line" d="M 0 98 C 5 90, 15 10, 25 5 S 45 2, 60 15 C 75 30, 90 65, 100 80" vector-effect="non-scaling-stroke"/>
             </svg>
            <div class="y-axis axis"></div>
            <div class="energy-levels" id="energy-levels"></div>
            <div class="x-axis axis"></div>
            <div class="activation-energy"></div>
        </div>

        <!-- Question Display Area -->
        <div class="question-container hidden" id="question-container">
            <div class="difficulty-label" id="question-difficulty"></div>
            <div class="question-text" id="question-text"></div>
            <div class="options" id="options-container"></div>
            <button class="submit-btn" onclick="checkAnswer()" disabled id="submit-button">Submit Answer</button>
        </div>

        <!-- Scoreboard Area -->
        <div class="scoreboard" id="scoreboard">
            <div class="player-score player1-score" id="player1-score-box">
                <div>Player 1</div>
                <div class="score-value" id="player1-score">0</div>
            </div>
            <div class="player-score player2-score hidden" id="player2-score-container">
                <div>Player 2</div>
                <div class="score-value" id="player2-score">0</div>
            </div>
        </div>

        <!-- Game Message Area -->
        <div class="game-message" id="game-message">
            Select game mode and press Start Game!
        </div>
    </div>

    <script>
        // DOM Elements Caching
        const energyLevelsContainer = document.getElementById('energy-levels');
        const difficultyChoiceContainer = document.getElementById('difficulty-choice-container');
        const choicePlayerNumber = document.getElementById('choice-player-number');
        const questionContainer = document.getElementById('question-container');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const difficultyLabel = document.getElementById('question-difficulty');
        const submitButton = document.getElementById('submit-button');
        const scoreboard = document.getElementById('scoreboard');
        const p1ScoreDisplay = document.getElementById('player1-score');
        const p2ScoreDisplay = document.getElementById('player2-score');
        const p1ScoreBox = document.getElementById('player1-score-box');
        const p2ScoreContainer = document.getElementById('player2-score-container');
        const gameMessage = document.getElementById('game-message');
        const playerSelectorContainer = document.getElementById('player-selector-container');
        const currentPlayerDisplay = document.getElementById('current-player');
        const gameModeSelect = document.getElementById('game-mode');
        const startButton = document.getElementById('start-button');
        const resetButton = document.getElementById('reset-button');
        const instructionsContent = document.getElementById('instructions-content');
        const easyCountSpan = document.getElementById('easy-count');
        const mediumCountSpan = document.getElementById('medium-count');
        const hardCountSpan = document.getElementById('hard-count');
        const easyChoiceBtn = document.getElementById('choose-easy');
        const mediumChoiceBtn = document.getElementById('choose-medium');
        const hardChoiceBtn = document.getElementById('choose-hard');

        // Game state variables
        let gameMode = 'solo';
        let currentPlayer = 1;
        let player1Score = 0;
        let player2Score = 0;
        let currentQuestion = null;
        let currentDifficultyChoice = null;
        let selectedOptionElement = null;
        let gameStarted = false;
        let shuffledEasy = [];
        let shuffledMedium = [];
        let shuffledHard = [];
        let questionTimeout = null;

        // Constants
        const MAX_LEVELS = 10;
        const TARGET_LEVEL_HEIGHTS = [5, 25, 50, 70, 85, 75, 55, 35, 20, 10]; // % for visual guide
        const MAX_BAR_HEIGHT_PX = 300; // Matches CSS height

        // Initialization
        function initializeGame() {
            createEnergyLevels();
            updatePlayerDisplay(); // Sets initial visibility based on default mode
            resetButton.disabled = true;
            difficultyChoiceContainer.classList.add('hidden');
            questionContainer.classList.add('hidden');
        }

        function createEnergyLevels() {
            energyLevelsContainer.innerHTML = '';
            for (let i = 1; i <= MAX_LEVELS; i++) {
                const energyLevel = document.createElement('div');
                energyLevel.className = 'energy-level';
                energyLevel.id = `energy-level-${i}`;
                const heightPercent = TARGET_LEVEL_HEIGHTS[i - 1] || 5;
                energyLevel.style.height = `${(heightPercent / 100) * MAX_BAR_HEIGHT_PX}px`;
                const tokenContainer = document.createElement('div');
                tokenContainer.className = 'token-container';
                tokenContainer.id = `token-container-${i}`;
                energyLevel.appendChild(tokenContainer);
                const energyLevelNumber = document.createElement('div');
                energyLevelNumber.className = 'energy-level-number';
                energyLevelNumber.textContent = i;
                energyLevel.appendChild(energyLevelNumber);
                energyLevelsContainer.appendChild(energyLevel);
            }
        }

        // Game Controls
        function updateGameMode() { if (!gameStarted) { gameMode = gameModeSelect.value; updatePlayerDisplay(); } }

        function updatePlayerDisplay() {
            if (gameMode === 'two-player') {
                playerSelectorContainer.classList.remove('hidden');
                p2ScoreContainer.classList.remove('hidden');
                currentPlayerDisplay.textContent = `Player ${currentPlayer}`;
                p1ScoreBox.style.opacity = currentPlayer === 1 ? '1' : '0.65';
                p2ScoreContainer.style.opacity = currentPlayer === 2 ? '1' : '0.65';
            } else {
                playerSelectorContainer.classList.add('hidden');
                p2ScoreContainer.classList.add('hidden');
                p1ScoreBox.style.opacity = '1'; // P1 always visible in solo
            }
        }

        function startGame() {
            if (gameStarted) return;
            gameStarted = true;
            gameMode = gameModeSelect.value; // Lock mode
            resetScores();
            loadAndShuffleQuestions();
            currentPlayer = 1;
            clearAllTokens();
            gameMessage.textContent = 'Game started! Choose a difficulty.';
            gameMessage.style.color = 'var(--dark-text)';
            startButton.disabled = true;
            resetButton.disabled = false;
            gameModeSelect.disabled = true; // Disable mode change
            promptDifficultyChoice(); // Start the turn cycle
        }

        function resetGame() {
            gameStarted = false;
            clearTimeout(questionTimeout);
            resetScores();
            currentPlayer = 1;
            shuffledEasy = []; shuffledMedium = []; shuffledHard = [];
            clearAllTokens();
            difficultyChoiceContainer.classList.add('hidden');
            questionContainer.classList.add('hidden');
            gameMessage.textContent = 'Game Reset. Select mode and Start Game.';
            gameMessage.style.color = 'var(--dark-text)';
            startButton.disabled = false;
            resetButton.disabled = true;
            gameModeSelect.disabled = false; // Re-enable mode change
            updatePlayerDisplay(); // Reset UI elements
        }

        function clearAllTokens() {
            for (let i = 1; i <= MAX_LEVELS; i++) {
                const container = document.getElementById(`token-container-${i}`);
                if (container) container.innerHTML = '';
            }
        }
        function resetScores() { player1Score = 0; player2Score = 0; updateScoreboard(); }

        // Question Handling
        function loadAndShuffleQuestions() {
            shuffledEasy = shuffleArray([...easyQuestions]);
            shuffledMedium = shuffleArray([...mediumQuestions]);
            shuffledHard = shuffleArray([...hardQuestions]);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function promptDifficultyChoice() {
            clearTimeout(questionTimeout);
            questionContainer.classList.add('hidden'); // Hide question area

            const totalRemaining = shuffledEasy.length + shuffledMedium.length + shuffledHard.length;
            if (totalRemaining === 0 && gameStarted) { // Check gameStarted to prevent premature end on reset
                endGame();
                return;
            }

            updateDifficultyCountsAndButtons();
            choicePlayerNumber.textContent = currentPlayer;
            updatePlayerDisplay(); // Make sure the correct player score is highlighted *before* showing choice
            difficultyChoiceContainer.classList.remove('hidden');
            gameMessage.textContent = `Player ${currentPlayer}, choose a difficulty.`;
        }

        function updateDifficultyCountsAndButtons() {
            easyCountSpan.textContent = shuffledEasy.length;
            mediumCountSpan.textContent = shuffledMedium.length;
            hardCountSpan.textContent = shuffledHard.length;
            easyChoiceBtn.disabled = shuffledEasy.length === 0;
            mediumChoiceBtn.disabled = shuffledMedium.length === 0;
            hardChoiceBtn.disabled = shuffledHard.length === 0;
        }

        function selectQuestionDifficulty(chosenDifficulty) {
            if (!gameStarted) return;
            currentDifficultyChoice = chosenDifficulty; // Store player's choice
            let questionList;
            switch (chosenDifficulty) {
                case 'easy':   questionList = shuffledEasy; break;
                case 'medium': questionList = shuffledMedium; break;
                case 'hard':   questionList = shuffledHard; break;
                default: console.error("Invalid difficulty selected"); return;
            }
            // Re-check length just before pop in case of rapid clicks
            if (questionList.length === 0) { gameMessage.textContent = `No ${chosenDifficulty} questions left! Choose another.`; updateDifficultyCountsAndButtons(); return; }
            currentQuestion = questionList.pop(); // Get question object
            difficultyChoiceContainer.classList.add('hidden');
            displaySelectedQuestion(); // Show the fetched question
        }

        function displaySelectedQuestion() {
            if (!currentQuestion) return; // Safety check
            selectedOptionElement = null; // Reset selection
            submitButton.disabled = true; // Disable submit initially
            optionsContainer.querySelectorAll('.option').forEach(opt => { opt.className = 'option'; opt.onclick = () => selectOption(opt); }); // Reset styles/handlers

            questionText.textContent = currentQuestion.text; // Display full text
            difficultyLabel.textContent = currentQuestion.difficulty;
            difficultyLabel.className = `difficulty-label ${currentQuestion.difficulty}`;
            optionsContainer.innerHTML = '';
            // Use full text from question object's options array
            currentQuestion.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`; // Display option text
                optionElement.dataset.index = index;
                optionElement.onclick = () => selectOption(optionElement); // Add click handler
                optionsContainer.appendChild(optionElement);
            });
            questionContainer.classList.remove('hidden');
            gameMessage.textContent = `Player ${currentPlayer}, answer the question.`;
        }

        // --- MODIFIED selectOption FUNCTION ---
        function selectOption(optionElement) {
            // Prevent selection if game not started or if options are disabled (feedback phase)
            if (!gameStarted || optionElement.onclick === null) {
                return;
            }

            // Clear previous visual selection
            if (selectedOptionElement) {
                selectedOptionElement.classList.remove('selected');
            }

            // Select the new option
            optionElement.classList.add('selected');
            selectedOptionElement = optionElement; // Store the reference to the selected DOM element

            // Enable the submit button
            submitButton.disabled = false;
        }
        // --- END MODIFIED selectOption ---

        function checkAnswer() {
            if (!selectedOptionElement || !gameStarted) return;
            submitButton.disabled = true; // Disable submit immediately
            // Disable options visually immediately by removing the click handler
            optionsContainer.querySelectorAll('.option').forEach(opt => opt.onclick = null);

            const selectedIndex = parseInt(selectedOptionElement.dataset.index);
            const isCorrect = selectedIndex === currentQuestion.correctIndex;

            selectedOptionElement.classList.remove('selected'); // Remove selection style before applying feedback
            if (isCorrect) {
                selectedOptionElement.classList.add('correct');
                gameMessage.textContent = 'Correct!';
                gameMessage.style.color = 'var(--success-dark)';
                updateScore();
                addToken();
            } else {
                selectedOptionElement.classList.add('incorrect');
                const correctOption = optionsContainer.querySelector(`.option[data-index="${currentQuestion.correctIndex}"]`);
                if (correctOption) { correctOption.classList.add('correct'); } // Highlight correct one
                gameMessage.textContent = `Incorrect. The correct answer was ${String.fromCharCode(65 + currentQuestion.correctIndex)}.`;
                 gameMessage.style.color = 'var(--error-dark)';
                // --- Player Switch Logic ---
                if (gameMode === 'two-player') {
                    currentPlayer = currentPlayer === 1 ? 2 : 1;
                    // The next call to promptDifficultyChoice will update the UI for the NEW player
                }
                 // --- End Player Switch ---
            }

            clearTimeout(questionTimeout); // Clear any previous timeout
            // Go back to choosing difficulty for the next turn after a delay
            questionTimeout = setTimeout(promptDifficultyChoice, 2500);
        }

        // Token Placement & Scoring
        function addToken() {
            if (!currentDifficultyChoice) { console.error("Difficulty choice lost"); return; }
            let levelRange, weightBias;
            switch (currentDifficultyChoice) {
                case 'easy':   levelRange = [1, 2, 3, 4]; weightBias = 'low'; break;
                case 'medium': levelRange = [3, 4, 5, 6, 7]; weightBias = 'medium'; break;
                case 'hard':   levelRange = [6, 7, 8, 9, 10]; weightBias = 'high'; break; // Range for hard questions
                default:       levelRange = [1, 2, 3, 4, 5]; weightBias = 'low'; // Fallback
            }
            const level = getWeightedRandomLevel(levelRange, weightBias);
            const tokenContainer = document.getElementById(`token-container-${level}`);
            if (!tokenContainer) { console.error(`Token container ${level} not found.`); return; }
            const token = document.createElement('div');
            token.className = `token player${currentPlayer}-token added`;
            token.textContent = currentDifficultyChoice.charAt(0).toUpperCase(); // E, M, H
            tokenContainer.appendChild(token);
            setTimeout(() => token.classList.remove('added'), 300); // Remove animation class
        }

        function getWeightedRandomLevel(levels, bias) {
             if (!levels || levels.length === 0) return 1; // Fallback
            if (levels.length === 1) return levels[0];
            let weightedLevels = [];
            const n = levels.length;
            for (let i = 0; i < n; i++) {
                let weight = 1;
                 if (bias === 'low') weight = n - i;
                 // For 'high' bias (hard questions), still weight towards the start of *its* range (levels 6, 7)
                 else if (bias === 'high') weight = n - i;
                 else if (bias === 'medium') weight = n - Math.abs(i - Math.floor(n / 2));
                 else weight = 1; // Default uniform
                // Ensure weight is at least 1
                weight = Math.max(1, weight);
                for (let j = 0; j < weight; j++) { weightedLevels.push(levels[i]); }
            }
            const randomIndex = Math.floor(Math.random() * weightedLevels.length);
            return weightedLevels[randomIndex];
        }

        function updateScore() {
             if (!currentQuestion) return; // Safety check
            let points = 0;
            switch (currentQuestion.difficulty) { // Points based on actual question difficulty
                case 'easy': points = 1; break;
                case 'medium': points = 2; break;
                case 'hard': points = 3; break;
            }
             if (currentPlayer === 1) { player1Score += points; }
             else { if(gameMode === 'two-player') player2Score += points; } // Only score P2 in 2P mode
             updateScoreboard();
        }

        function updateScoreboard() {
            p1ScoreDisplay.textContent = player1Score;
            // Only update P2 score if the container is visible
            if (!p2ScoreContainer.classList.contains('hidden')) {
                p2ScoreDisplay.textContent = player2Score;
            }
        }

        // Game End & Bonus
        function endGame() {
            gameStarted = false; // Mark game as ended
            questionContainer.classList.add('hidden');
            difficultyChoiceContainer.classList.add('hidden');
            startButton.disabled = false; // Allow restart
            resetButton.disabled = false; // Keep reset enabled
            gameModeSelect.disabled = false; // Allow mode change

            let endMessage = "Game Over! ";
            if (gameMode === 'two-player') {
                 updateScoreboard(); // Final score update
                if (player1Score > player2Score) endMessage += `Player 1 wins with ${player1Score} points! (Player 2: ${player2Score})`;
                else if (player2Score > player1Score) endMessage += `Player 2 wins with ${player2Score} points! (Player 1: ${player1Score})`;
                else endMessage += `It's a tie at ${player1Score} points!`;
                // Reset opacity highlights
                p1ScoreBox.style.opacity = '1';
                p2ScoreContainer.style.opacity = '1';
            } else { // Solo Mode
                const distributionBonus = calculateDistributionBonus();
                player1Score += distributionBonus;
                updateScoreboard(); // Update score with bonus
                 endMessage += `Final Score: ${player1Score}`;
                if (distributionBonus > 0) endMessage += ` (including ${distributionBonus} bonus points for distribution shape!)`;
                else endMessage += ". Try to match the curve shape next time for bonus points!";
                 p1ScoreBox.style.opacity = '1'; // Ensure P1 box is fully visible
            }
            gameMessage.textContent = endMessage;
            gameMessage.style.color = 'var(--secondary-color)'; // Use accent color for final message
        }

        function calculateDistributionBonus() {
             const idealDistribution = [0.02, 0.10, 0.23, 0.25, 0.20, 0.10, 0.05, 0.03, 0.01, 0.01]; // Target %
             let actualCounts = Array(MAX_LEVELS).fill(0);
             let totalTokens = 0;
             for (let i = 1; i <= MAX_LEVELS; i++) {
                 const tokenContainer = document.getElementById(`token-container-${i}`);
                 if (tokenContainer) {
                     actualCounts[i-1] = tokenContainer.children.length;
                     totalTokens += actualCounts[i-1];
                 }
             }
             if (totalTokens < 5) return 0; // Need enough tokens to judge

             let actualDistribution = actualCounts.map(count => count / totalTokens);
             let differenceScore = 0; // Sum of squared differences
             for (let i = 0; i < MAX_LEVELS; i++) {
                 differenceScore += Math.pow(actualDistribution[i] - idealDistribution[i], 2);
             }
             // Award bonus points (lower difference is better)
             let bonus = 0;
             if (differenceScore < 0.05) bonus = 10;      // Excellent match
             else if (differenceScore < 0.10) bonus = 6;  // Good match
             else if (differenceScore < 0.20) bonus = 3;  // Fair match
             return bonus;
        }

        // UI Helpers
        function toggleInstructions() { instructionsContent.classList.toggle('visible'); }

        // Initial Load
        window.onload = initializeGame;

        // --- Question Data (Full Text RESTORED with Wording Refinements) ---
        const easyQuestions = [
            {
                text: "Which factor primarily affects the activation energy of a reaction?", // Reworded
                options: [
                    "The presence of a catalyst", // Reworded
                    "The presence of a catalyst and changes in temperature",
                    "Changes in the concentration of the reactants", // Reworded
                    "The presence of a catalyst and changes in the concentration of the reactants"
                ],
                correctIndex: 0,
                difficulty: "easy"
            },
            {
                text: "Why does a mixture of hydrogen gas and chlorine gas react faster at a temperature of 600 K than at 500 K?",
                options: [
                    "A higher proportion of successful collisions occurs at 600 K",
                    "A higher proportion of successful collisions occurs AND hydrogen molecules and chlorine molecules collide more frequently at 600 K", // Added AND
                    "The activation energy of the reaction is lower at 600 K",
                    "A higher proportion of successful collisions occurs, hydrogen molecules and chlorine molecules collide more frequently, and the activation energy is lower at 600 K"
                ],
                correctIndex: 1,
                difficulty: "easy"
            },
            // ... (Other easy questions remain the same unless they used 'only'/'just') ...
            {
                text: "How does the Maxwell-Boltzmann energy distribution curve change when the temperature is increased?",
                options: ["Stays the same", "Peak height decreases and moves to the left", "Peak height increases and moves to the right", "Peak height decreases and moves to the right"],
                correctIndex: 3, difficulty: "easy"
            },
            {
                text: "What does the area underneath the Maxwell-Boltzmann distribution curve represent?",
                options: ["The number of particles which can react with each other", "The total number of particles", "The total energy of the particles", "The total number of particles that have activation energy"],
                correctIndex: 1, difficulty: "easy"
            },
             {
                text: "What effect would adding a catalyst have on the activation energy (Ea) in a Maxwell-Boltzmann distribution?",
                options: ["Move Ea to the left and the peak would be unchanged", "Move Ea to the left and the peak would move to the right", "Move Ea to the left and the peak would move to the left", "The activation energy would be unchanged and the peak would move to the right"],
                correctIndex: 0, difficulty: "easy"
            },
            {
                text: "For the Haber process (N₂ + 3H₂ ⇌ 2NH₃, ΔH = −92.4 kJ mol⁻¹), which statement is true regarding the reaction rate?", // Clarified focus
                options: [
                    "Increasing the temperature will increase the rate of reaction",
                    "Increasing the temperature will increase the yield of ammonia", // Yield, not rate focused
                    "An iron catalyst will increase the yield of ammonia", // Yield, not rate focused
                    "Both increasing temperature and using iron catalyst will increase yield" // Yield, not rate focused
                ],
                correctIndex: 0, difficulty: "easy"
            },
            {
                text: "Which factor increases reaction rate through a mechanism *different* from altering collision frequency or the energy/orientation of collisions?", // Reworded
                options: [
                    "Addition of a catalyst",
                    "Increasing the concentration of a reactant",
                    "Increasing the pressure",
                    "Increasing the temperature"
                ],
                correctIndex: 0,
                difficulty: "easy"
            },
            {
                text: "For the Haber process (N₂ + 3H₂ ⇌ 2NH₃, ΔH = −92.4 kJ mol⁻¹), which statements accurately describe the effects of changing conditions?", // Reworded
                options: [
                    "A catalyst will shift the equilibrium to the right and increase the rate",
                    "An increase in pressure will shift the equilibrium to the right and increase the rate",
                    "An increase in temperature will shift the equilibrium to the left and increase the rate",
                    "Statements 2 and 3 are both accurate descriptions" // Reworded
                ],
                correctIndex: 3,
                difficulty: "easy"
            }
        ];
        const mediumQuestions = [
             {
                text: "What are the key reasons reaction rates increase as temperature increases?", // Reworded
                options: [
                    "The activation energy is less, collisions are more frequent, AND a greater proportion of molecules have energy > Ea",
                    "The activation energy is less AND collisions are more frequent",
                    "Collisions are more frequent AND a greater proportion of molecules have energy > Ea", // Reworded
                    "The activation energy becomes less" // Reworded
                ],
                correctIndex: 2,
                difficulty: "medium"
            },
            // ... (Other medium questions remain the same unless they used 'only'/'just') ...
             {
                text: "If the temperature of a gas is increased, what will happen to the point representing the peak of the Maxwell-Boltzmann distribution (the most probable energy value)?",
                options: ["Fewer molecules possess the most probable energy value so it will shift higher and to the left", "Fewer molecules possess the most probable energy value so it will shift lower and to the right", "More molecules possess the most probable energy value so it will shift to the left", "The position will stay the same but the area under the distribution curve increases"],
                correctIndex: 1, difficulty: "medium"
            },
            {
                text: "If the Maxwell-Boltzmann distribution for a gas at 200 K is represented by a curve, which of the following would most accurately represent the distribution at 400 K?",
                options: ["A curve with a higher, narrower peak shifted slightly to the right", "A curve with a lower, broader peak shifted significantly to the right", "A curve with the same height peak but shifted significantly to the right", "A curve with a higher peak shifted slightly to the left"],
                correctIndex: 1, difficulty: "medium"
            },
            {
                text: "In a Maxwell-Boltzmann distribution showing activation energy Ea, if a catalyst is added to the reaction, the new position of Ea would be:",
                options: ["To the left of the original Ea (lower energy)", "To the right of the original Ea (higher energy)", "At the same position as the original Ea", "At the peak of the energy distribution"],
                correctIndex: 0, difficulty: "medium"
            },
             {
                text: "What happens when an effective catalyst is added to a gaseous mixture with a Maxwell-Boltzmann distribution?",
                options: ["The height of the peak remains the same and the activation energy moves to the right", "The height of the peak decreases and the activation energy moves to the left", "The height of the peak remains the same and the activation energy moves to the left", "The height of the peak decreases and the activation energy moves to the right"],
                correctIndex: 2, difficulty: "medium"
            },
            {
                text: "When water is added to a hydrochloric acid solution before adding calcium carbonate, the reaction rate decreases. Which hypothesis correctly explains this difference?",
                options: [
                    "The proportion of reactant molecules possessing the activation energy is reduced", // Reworded
                    "Both the frequency of collisions and the proportion of effective collisions are reduced",
                    "The frequency of collisions between reactant molecules is reduced due to lower concentration", // Reworded
                    "All three factors (collision frequency, effective collisions, proportion with Ea) are reduced"
                ],
                correctIndex: 2,
                difficulty: "medium"
            },
             {
                text: "In a Maxwell-Boltzmann distribution, when temperature is decreased by 10°C, what happens to molecules with very low energy (H), moderate energy near the peak (J), and high energy above activation energy (K)?",
                options: ["H decreases, J increases, K decreases", "H increases, J decreases, K decreases", "H increases, J decreases, K increases", "H decreases, J decreases, K increases"],
                correctIndex: 1, difficulty: "medium"
            },
            {
                text: "The addition of a catalyst to a reaction provides an alternate mechanism with:",
                options: ["Lower activation energy and lower reaction rate", "Lower activation energy and higher reaction rate", "Higher activation energy and lower reaction rate", "Higher activation energy and higher reaction rate"],
                correctIndex: 1, difficulty: "medium"
            },
            {
                text: "Consider the neutralization reaction: NaOH(aq) + HCl(aq) → H₂O(l) + NaCl(aq). Which species concentration could a student change to investigate the rate of reaction (assuming it's not instantaneous)?",
                options: ["H⁺ (from HCl) or OH⁻ (from NaOH)", "Cl⁻", "Na⁺", "H₂O"],
                correctIndex: 0, difficulty: "medium"
            }
        ];
        const hardQuestions = [
             {
                text: "For the reaction H₂SO₄(aq) + 2NaOH(aq) → Na₂SO₄(aq) + 2H₂O(l), if ΔH is -62 kJ and the energy released by bond-making is 157 kJ, what is the energy absorbed for bond-breaking?", // Clarified question
                options: [
                    "The bond breaking energy is less than bond making energy, the equation is correct, AND the activation energy is 219 kJ mol⁻¹",
                    "The energy required for bond breaking (95 kJ) is less than the energy released by bond making (157 kJ), AND the stoichiometric equation shown is correct.", // Reworded
                    "The stoichiometric equation shown is correct AND the activation energy is 219 kJ mol⁻¹",
                    "The energy required for bond breaking is less than the energy released by bond making." // Reworded
                ],
                correctIndex: 1,
                difficulty: "hard"
            },
            // ... (Other hard questions remain the same unless they used 'only'/'just') ...
            {
                text: "A nucleophilic substitution reaction takes place between 2-bromopropane and sodium hydroxide in a total volume of 300 cm³. An organic compound and 0.32 g of an inorganic salt (NaBr, Molar Mass ≈ 103 g/mol) are formed in 30 seconds. Which organic product and rate of reaction are correct?",
                options: ["Propan-1-ol and 2.07 × 10⁻² mol dm⁻³ min⁻¹", "Propan-2-ol and 3.46 × 10⁻⁴ mol dm⁻³ s⁻¹", "Propan-1-ol and 3.46 × 10⁻⁴ mol dm⁻³ s⁻¹", "Propan-2-ol and 2.07 × 10⁻² mol dm⁻³ min⁻¹"],
                correctIndex: 3, difficulty: "hard"
            },
             {
                text: "Iron is an important catalyst (e.g., Haber process: Fe(s); S₂O₈²⁻ + I⁻ reaction: Fe²⁺/Fe³⁺ aq). Which statement accurately describes iron's role or related concepts?", // Reworded
                options: [
                    "Iron changes oxidation state, it acts as a heterogeneous catalyst shifting Haber equilibrium right, AND catalysts increase the proportion of molecules with energy > Ea.",
                    "Iron changes oxidation state AND it acts as a heterogeneous catalyst shifting Haber equilibrium right.",
                    "Iron acts as a heterogeneous catalyst shifting Haber equilibrium right AND catalysts increase the proportion of molecules with energy > Ea.",
                    "Iron changes its oxidation state during homogeneous catalysis (e.g., the S₂O₈²⁻ reaction)." // Reworded
                ],
                correctIndex: 3,
                difficulty: "hard"
            },
             {
                text: "From graphs showing product concentration vs. time (curve flattening) and rate vs. acid concentration (straight line through origin) for Mg + HCl reaction, which conclusions are supported?", // Reworded
                options: [
                    "All three are supported: Rate decreases as reactants decrease; Rate of heat output increases with concentration; Rate doubles when [HCl] doubles.",
                    "Statements supported: Rate decreases as reactants decrease AND Rate of heat output increases with concentration.",
                    "Statements supported: Rate of heat output increases with concentration AND Rate doubles when [HCl] doubles.",
                    "Statement supported: Rate decreases as reactants decrease." // Reworded
                ],
                correctIndex: 0,
                difficulty: "hard"
            },
             {
                text: "Which statement about the molecules in a gas sample at a constant temperature is correct?",
                 options: ["All molecules have the same kinetic energy.", "The average kinetic energy of the molecules is constant.", "All molecules are moving at the same speed.", "The pressure of the gas is directly proportional to the Celsius temperature."],
                correctIndex: 1, difficulty: "hard"
            }
        ];

    </script>
</body>
</html>
