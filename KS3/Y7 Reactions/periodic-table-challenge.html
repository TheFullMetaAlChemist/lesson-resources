<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Periodic Table Learning Game</title>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #e74c3c;
            --background-color: #f5f5f5;
            --card-color: #ffffff;
            --text-color: #333333;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 20px;
            max-width: 1500px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
        }

        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .start-screen, .selection-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            margin-bottom: 20px;
        }

        .start-content, .selection-content {
            max-width: 900px;
            background-color: var(--card-color);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }

        .start-content h2, .selection-content h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
        }
        
        .settings-bar {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .reset-progress-btn {
            background-color: #f0f0f0;
            color: #e74c3c;
            border: 1px solid #e74c3c;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .reset-progress-btn:hover {
            background-color: #e74c3c;
            color: white;
        }

        .start-info {
            margin-bottom: 30px;
        }

        .start-info ul {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .start-info li {
            margin-bottom: 8px;
        }

        .mode-selection {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-card {
            flex: 1;
            min-width: 250px;
            max-width: 350px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s;
        }

        .mode-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .mode-card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .mode-card p {
            margin-bottom: 10px;
        }

        .mode-btn {
            margin-top: 15px;
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .mode-btn:hover {
            background-color: #2980b9;
        }

        .selection-screen {
            display: none;
        }

        .practice-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }

        .option-group h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .round-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .round-option {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #f0f0f0;
            border: 2px solid #ddd;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .round-option:hover {
            background-color: #e0e0e0;
            border-color: #ccc;
        }

        .round-option.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .round-option.locked {
            background-color: #f0f0f0;
            color: #aaa;
            border-color: #ddd;
            cursor: not-allowed;
            position: relative;
        }

        .round-option.locked::after {
            content: 'ðŸ”’';
            position: absolute;
            font-size: 18px;
        }

        .mode-options {
            display: flex;
            gap: 20px;
        }

        .mode-option {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mode-option:hover {
            background-color: #e9ecef;
        }

        .mode-option input {
            margin-bottom: 10px;
        }

        .selection-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .start-btn, .back-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .start-btn {
            background-color: var(--secondary-color);
            color: white;
        }

        .start-btn:hover {
            background-color: #27ae60;
        }

        .back-btn {
            background-color: #f0f0f0;
            color: #333;
        }

        .back-btn:hover {
            background-color: #e0e0e0;
        }

        .game-main {
            width: 100%;
            display: none;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .game-mode-badge {
            background-color: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .timer-container {
            display: flex;
            align-items: center;
            gap: 5px;
            background-color: #f0f0f0;
            padding: 5px 10px;
            border-radius: 20px;
        }

        .timer {
            font-weight: bold;
            font-family: monospace;
            font-size: 1.1rem;
        }

        .switch-mode-btn {
            background-color: #f0f0f0;
            color: #333;
            border: none;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .switch-mode-btn:hover {
            background-color: #e0e0e0;
        }

        .page-container {
            display: grid;
            grid-template-columns: minmax(0, 3fr) minmax(0, 2fr);
            gap: 20px;
            min-height: 600px;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .rounds-progress {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .round-progress-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 0.9rem;
        }

        .round-indicator {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
            position: relative;
            cursor: pointer;
        }

        .round-indicator.symbol-complete::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 50%;
            height: 100%;
            background-color: var(--secondary-color);
            border-radius: 40px 0 0 40px;
            z-index: 1;
        }

        .round-indicator.name-complete::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50%;
            height: 100%;
            background-color: var(--secondary-color);
            border-radius: 0 40px 40px 0;
            z-index: 1;
        }

        .round-indicator.complete {
            background-color: var(--secondary-color);
        }
        
        .round-indicator.current {
            border: 3px solid var(--primary-color);
        }

        .round-indicator span {
            position: relative;
            z-index: 2;
        }

        .round-indicator.locked {
            background-color: #95a5a6;
            cursor: not-allowed;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--card-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .round-info {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .game-mode-info {
            font-size: 1rem;
            color: var(--primary-color);
            font-weight: bold;
        }

        .score-info {
            font-size: 1.2rem;
        }

        .progress-container {
            width: 100%;
            background-color: #ddd;
            border-radius: 5px;
            height: 20px;
            margin-top: 10px;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--secondary-color);
            border-radius: 5px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.8rem;
            font-weight: bold;
            color: #333;
        }

        .question-container {
            background-color: var(--card-color);
            border-radius: 8px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16);
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .question-prompt {
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .question-element {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary-color);
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            background-color: rgba(52, 152, 219, 0.1);
            display: inline-block;
            min-width: 100px;
        }

        .question-element .element-atomic-number {
            font-size: 1rem;
            opacity: 0.7;
            position: relative;
            top: -1.5rem;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .option-card {
            background-color: var(--card-color);
            border: 2px solid rgba(52, 152, 219, 0.3);
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 10px 5px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
            font-size: 0.95rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 60px;
            word-wrap: break-word;
            hyphens: auto;
        }

        .option-card .element-number {
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .option-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            background-color: rgba(52, 152, 219, 0.05);
        }

        .option-card.correct {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        .option-card.incorrect {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
        }

        .option-card.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .feedback-message {
            height: 30px;
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .feedback-correct {
            color: var(--secondary-color);
        }

        .feedback-incorrect {
            color: var(--accent-color);
        }

        .element-details {
            background-color: var(--card-color);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .element-details h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .element-details-symbol {
            font-size: 2rem;
            font-weight: bold;
            background-color: var(--primary-color);
            color: white;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
        }

        .element-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .element-info-item {
            background-color: var(--background-color);
            padding: 10px;
            border-radius: 5px;
        }

        .element-info-label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .no-element-selected {
            text-align: center;
            padding: 30px;
            color: #888;
            font-style: italic;
        }

        .periodic-table-container {
            margin-top: 20px;
            background-color: var(--card-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .periodic-table-container h3 {
            text-align: center;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .mini-periodic-table {
            display: grid;
            grid-template-columns: repeat(18, 1fr);
            gap: 2px;
            font-size: 0.7rem;
        }

        .mini-element {
            width: 100%;
            aspect-ratio: 1/1;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #eee;
            border-radius: 3px;
            position: relative;
        }

        .mini-element.current-round {
            background-color: rgba(52, 152, 219, 0.2);
        }

        .mini-element.completed {
            background-color: rgba(46, 204, 113, 0.2);
        }

        .mini-element.empty {
            background-color: transparent;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--card-color);
            padding: 30px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .modal h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .modal p {
            margin-bottom: 20px;
        }

        @media (max-width: 1200px) {
            .page-container {
                grid-template-columns: 1fr;
            }
            
            .options-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 768px) {
            .options-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .option-card {
                padding: 8px 5px;
                font-size: 0.85rem;
                min-height: 50px;
            }
            
            .question-element {
                font-size: 2.5rem;
            }
        }
        
        @media (max-width: 480px) {
            .options-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Periodic Table Challenge</h1>
        <p>Learn the elements of the periodic table step by step</p>
        <div class="settings-bar">
            <button id="reset-progress-btn" class="reset-progress-btn">Reset Progress</button>
        </div>
    </header>
    
    <!-- Start Screen -->
    <div id="start-screen" class="start-screen">
        <div class="start-content">
            <h2>Welcome to the Periodic Table Challenge!</h2>
            <div class="start-info">
                <p>This game will help you learn the symbols and names of elements in the periodic table.</p>
                <p><strong>How to play:</strong></p>
                <ul>
                    <li>The game is divided into rounds of increasing difficulty</li>
                    <li>For each round, you must complete both Symbolâ†’Name and Nameâ†’Symbol modes</li>
                    <li>Select the correct name or symbol for each element that appears</li>
                    <li>You must complete all elements in each round to advance</li>
                </ul>
                <p><strong>Choose your game mode:</strong></p>
            </div>
            <div class="mode-selection">
                <div class="mode-card" id="practice-mode-card">
                    <h3>Practice Mode</h3>
                    <p>â€¢ Select any round and mode</p>
                    <p>â€¢ Learn at your own pace</p>
                    <p>â€¢ No time pressure</p>
                    <button id="practice-mode-btn" class="mode-btn">Start Practice</button>
                </div>
                <div class="mode-card" id="challenge-mode-card">
                    <h3>Challenge Mode</h3>
                    <p>â€¢ Start with Round 1 and progress sequentially</p>
                    <p>â€¢ Timer tracks your speed</p>
                    <p>â€¢ Test your knowledge against the clock</p>
                    <button id="challenge-mode-btn" class="mode-btn">Start Challenge</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Practice Mode Selection Screen -->
    <div id="practice-selection" class="selection-screen">
        <div class="selection-content">
            <h2>Practice Mode</h2>
            <p>Select a round and mode to practice:</p>
            
            <div class="practice-options">
                <div class="option-group">
                    <h3>Select Round:</h3>
                    <div class="round-options" id="practice-round-options">
                        <!-- Round options will be generated here -->
                    </div>
                </div>
                
                <div class="option-group">
                    <h3>Select Mode:</h3>
                    <div class="mode-options">
                        <label class="mode-option">
                            <input type="radio" name="practice-mode" value="symbol-to-name" checked>
                            <span>Symbol â†’ Name</span>
                        </label>
                        <label class="mode-option">
                            <input type="radio" name="practice-mode" value="name-to-symbol">
                            <span>Name â†’ Symbol</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="selection-buttons">
                <button id="start-practice-btn" class="start-btn">Start Practice</button>
                <button id="back-to-main-btn" class="back-btn">Back to Main Menu</button>
            </div>
        </div>
    </div>
    
    <!-- Main Game Container (initially hidden) -->
    <div id="game-main" class="game-main">
        <div class="game-header">
            <div class="game-mode-badge" id="game-mode-badge">Practice Mode</div>
            <div class="timer-container" id="timer-container" style="display: none;">
                <div class="timer-label">Time:</div>
                <div class="timer" id="timer">00:00</div>
            </div>
            <button id="switch-mode-btn" class="switch-mode-btn">Switch to Challenge Mode</button>
        </div>
        
        <div class="rounds-progress" id="rounds-progress">
            <!-- Round indicators will be generated here -->
        </div>

        <div class="page-container">
            <div class="game-container">
                <div class="game-info">
                    <div>
                        <div class="round-info">Round 1: Elements 1-20</div>
                        <div class="game-mode-info">Mode: Symbol â†’ Name</div>
                    </div>
                    <div class="score-info">Score: <span id="score">0</span></div>
                </div>

                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                    <div class="progress-text" id="progress-text">0/0</div>
                </div>

                <div class="question-container">
                    <div class="question-prompt" id="question-prompt">What is the name of this element?</div>
                    <div class="question-element" id="question-element">
                        <div class="element-atomic-number" id="atomic-number">1</div>
                        H
                    </div>
                    <div class="options-grid" id="options-grid">
                        <!-- Options will be generated here -->
                    </div>
                    <div class="feedback-message" id="feedback-message"></div>
                </div>
            </div>

            <div class="info-container">
                <div class="element-details" id="element-details">
                    <!-- Element details will be displayed here -->
                </div>

                <div class="periodic-table-container">
                    <h3>Progress Overview</h3>
                    <div class="mini-periodic-table" id="mini-periodic-table">
                        <!-- Mini periodic table will be generated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="round-complete-modal">
        <div class="modal-content">
            <h2>Mode Complete!</h2>
            <p>You've completed the <span id="completed-mode-name">Symbol â†’ Name</span> mode for Round <span id="completed-round">1</span>!</p>
            <p>Your score: <span id="round-score">0</span></p>
            <button id="continue-btn" class="start-btn">Continue</button>
        </div>
    </div>

    <div class="modal" id="game-complete-modal">
        <div class="modal-content">
            <h2>Congratulations!</h2>
            <p>You've mastered the periodic table!</p>
            <p>Final score: <span id="final-score">0</span></p>
            <button id="restart-game-btn" class="start-btn">Start Over</button>
        </div>
    </div>

    <script>
        // Element data
        const elements = [
            // Round 1: Elements 1-20
            { atomicNumber: 1, symbol: 'H', name: 'Hydrogen', atomicMass: 1.008, category: 'Nonmetal', discovery: '1766' },
            { atomicNumber: 2, symbol: 'He', name: 'Helium', atomicMass: 4.0026, category: 'Noble Gas', discovery: '1868' },
            { atomicNumber: 3, symbol: 'Li', name: 'Lithium', atomicMass: 6.94, category: 'Alkali Metal', discovery: '1817' },
            { atomicNumber: 4, symbol: 'Be', name: 'Beryllium', atomicMass: 9.0122, category: 'Alkaline Earth Metal', discovery: '1798' },
            { atomicNumber: 5, symbol: 'B', name: 'Boron', atomicMass: 10.81, category: 'Metalloid', discovery: '1808' },
            { atomicNumber: 6, symbol: 'C', name: 'Carbon', atomicMass: 12.011, category: 'Nonmetal', discovery: 'Prehistoric' },
            { atomicNumber: 7, symbol: 'N', name: 'Nitrogen', atomicMass: 14.007, category: 'Nonmetal', discovery: '1772' },
            { atomicNumber: 8, symbol: 'O', name: 'Oxygen', atomicMass: 15.999, category: 'Nonmetal', discovery: '1774' },
            { atomicNumber: 9, symbol: 'F', name: 'Fluorine', atomicMass: 18.998, category: 'Halogen', discovery: '1886' },
            { atomicNumber: 10, symbol: 'Ne', name: 'Neon', atomicMass: 20.180, category: 'Noble Gas', discovery: '1898' },
            { atomicNumber: 11, symbol: 'Na', name: 'Sodium', atomicMass: 22.990, category: 'Alkali Metal', discovery: '1807' },
            { atomicNumber: 12, symbol: 'Mg', name: 'Magnesium', atomicMass: 24.305, category: 'Alkaline Earth Metal', discovery: '1808' },
            { atomicNumber: 13, symbol: 'Al', name: 'Aluminum', atomicMass: 26.982, category: 'Post-transition Metal', discovery: '1825' },
            { atomicNumber: 14, symbol: 'Si', name: 'Silicon', atomicMass: 28.085, category: 'Metalloid', discovery: '1824' },
            { atomicNumber: 15, symbol: 'P', name: 'Phosphorus', atomicMass: 30.974, category: 'Nonmetal', discovery: '1669' },
            { atomicNumber: 16, symbol: 'S', name: 'Sulfur', atomicMass: 32.06, category: 'Nonmetal', discovery: 'Prehistoric' },
            { atomicNumber: 17, symbol: 'Cl', name: 'Chlorine', atomicMass: 35.45, category: 'Halogen', discovery: '1774' },
            { atomicNumber: 18, symbol: 'Ar', name: 'Argon', atomicMass: 39.948, category: 'Noble Gas', discovery: '1894' },
            { atomicNumber: 19, symbol: 'K', name: 'Potassium', atomicMass: 39.098, category: 'Alkali Metal', discovery: '1807' },
            { atomicNumber: 20, symbol: 'Ca', name: 'Calcium', atomicMass: 40.078, category: 'Alkaline Earth Metal', discovery: '1808' },
            
            // Round 2: Common elements in secondary school (21-36)
            { atomicNumber: 21, symbol: 'Sc', name: 'Scandium', atomicMass: 44.956, category: 'Transition Metal', discovery: '1879' },
            { atomicNumber: 22, symbol: 'Ti', name: 'Titanium', atomicMass: 47.867, category: 'Transition Metal', discovery: '1791' },
            { atomicNumber: 23, symbol: 'V', name: 'Vanadium', atomicMass: 50.942, category: 'Transition Metal', discovery: '1801' },
            { atomicNumber: 24, symbol: 'Cr', name: 'Chromium', atomicMass: 51.996, category: 'Transition Metal', discovery: '1797' },
            { atomicNumber: 25, symbol: 'Mn', name: 'Manganese', atomicMass: 54.938, category: 'Transition Metal', discovery: '1774' },
            { atomicNumber: 26, symbol: 'Fe', name: 'Iron', atomicMass: 55.845, category: 'Transition Metal', discovery: 'Prehistoric' },
            { atomicNumber: 27, symbol: 'Co', name: 'Cobalt', atomicMass: 58.933, category: 'Transition Metal', discovery: '1735' },
            { atomicNumber: 28, symbol: 'Ni', name: 'Nickel', atomicMass: 58.693, category: 'Transition Metal', discovery: '1751' },
            { atomicNumber: 29, symbol: 'Cu', name: 'Copper', atomicMass: 63.546, category: 'Transition Metal', discovery: 'Prehistoric' },
            { atomicNumber: 30, symbol: 'Zn', name: 'Zinc', atomicMass: 65.38, category: 'Transition Metal', discovery: 'Prehistoric' },
            { atomicNumber: 31, symbol: 'Ga', name: 'Gallium', atomicMass: 69.723, category: 'Post-transition Metal', discovery: '1875' },
            { atomicNumber: 32, symbol: 'Ge', name: 'Germanium', atomicMass: 72.630, category: 'Metalloid', discovery: '1886' },
            { atomicNumber: 33, symbol: 'As', name: 'Arsenic', atomicMass: 74.922, category: 'Metalloid', discovery: 'Ancient' },
            { atomicNumber: 34, symbol: 'Se', name: 'Selenium', atomicMass: 78.971, category: 'Nonmetal', discovery: '1817' },
            { atomicNumber: 35, symbol: 'Br', name: 'Bromine', atomicMass: 79.904, category: 'Halogen', discovery: '1826' },
            { atomicNumber: 36, symbol: 'Kr', name: 'Krypton', atomicMass: 83.798, category: 'Noble Gas', discovery: '1898' },
            
            // Round 3: Elements 37-54
            { atomicNumber: 37, symbol: 'Rb', name: 'Rubidium', atomicMass: 85.468, category: 'Alkali Metal', discovery: '1861' },
            { atomicNumber: 38, symbol: 'Sr', name: 'Strontium', atomicMass: 87.62, category: 'Alkaline Earth Metal', discovery: '1790' },
            { atomicNumber: 39, symbol: 'Y', name: 'Yttrium', atomicMass: 88.906, category: 'Transition Metal', discovery: '1794' },
            { atomicNumber: 40, symbol: 'Zr', name: 'Zirconium', atomicMass: 91.224, category: 'Transition Metal', discovery: '1789' },
            { atomicNumber: 41, symbol: 'Nb', name: 'Niobium', atomicMass: 92.906, category: 'Transition Metal', discovery: '1801' },
            { atomicNumber: 42, symbol: 'Mo', name: 'Molybdenum', atomicMass: 95.95, category: 'Transition Metal', discovery: '1781' },
            { atomicNumber: 43, symbol: 'Tc', name: 'Technetium', atomicMass: 98, category: 'Transition Metal', discovery: '1937' },
            { atomicNumber: 44, symbol: 'Ru', name: 'Ruthenium', atomicMass: 101.07, category: 'Transition Metal', discovery: '1844' },
            { atomicNumber: 45, symbol: 'Rh', name: 'Rhodium', atomicMass: 102.91, category: 'Transition Metal', discovery: '1803' },
            { atomicNumber: 46, symbol: 'Pd', name: 'Palladium', atomicMass: 106.42, category: 'Transition Metal', discovery: '1803' },
            { atomicNumber: 47, symbol: 'Ag', name: 'Silver', atomicMass: 107.87, category: 'Transition Metal', discovery: 'Prehistoric' },
            { atomicNumber: 48, symbol: 'Cd', name: 'Cadmium', atomicMass: 112.41, category: 'Transition Metal', discovery: '1817' },
            { atomicNumber: 49, symbol: 'In', name: 'Indium', atomicMass: 114.82, category: 'Post-transition Metal', discovery: '1863' },
            { atomicNumber: 50, symbol: 'Sn', name: 'Tin', atomicMass: 118.71, category: 'Post-transition Metal', discovery: 'Prehistoric' },
            { atomicNumber: 51, symbol: 'Sb', name: 'Antimony', atomicMass: 121.76, category: 'Metalloid', discovery: 'Ancient' },
            { atomicNumber: 52, symbol: 'Te', name: 'Tellurium', atomicMass: 127.60, category: 'Metalloid', discovery: '1783' },
            { atomicNumber: 53, symbol: 'I', name: 'Iodine', atomicMass: 126.90, category: 'Halogen', discovery: '1811' },
            { atomicNumber: 54, symbol: 'Xe', name: 'Xenon', atomicMass: 131.29, category: 'Noble Gas', discovery: '1898' },
            
            // Round 4: Elements 55-74
            { atomicNumber: 55, symbol: 'Cs', name: 'Cesium', atomicMass: 132.91, category: 'Alkali Metal', discovery: '1860' },
            { atomicNumber: 56, symbol: 'Ba', name: 'Barium', atomicMass: 137.33, category: 'Alkaline Earth Metal', discovery: '1808' },
            { atomicNumber: 57, symbol: 'La', name: 'Lanthanum', atomicMass: 138.91, category: 'Lanthanide', discovery: '1839' },
            { atomicNumber: 58, symbol: 'Ce', name: 'Cerium', atomicMass: 140.12, category: 'Lanthanide', discovery: '1803' },
            { atomicNumber: 59, symbol: 'Pr', name: 'Praseodymium', atomicMass: 140.91, category: 'Lanthanide', discovery: '1885' },
            { atomicNumber: 60, symbol: 'Nd', name: 'Neodymium', atomicMass: 144.24, category: 'Lanthanide', discovery: '1885' },
            { atomicNumber: 61, symbol: 'Pm', name: 'Promethium', atomicMass: 145, category: 'Lanthanide', discovery: '1945' },
            { atomicNumber: 62, symbol: 'Sm', name: 'Samarium', atomicMass: 150.36, category: 'Lanthanide', discovery: '1879' },
            { atomicNumber: 63, symbol: 'Eu', name: 'Europium', atomicMass: 151.96, category: 'Lanthanide', discovery: '1901' },
            { atomicNumber: 64, symbol: 'Gd', name: 'Gadolinium', atomicMass: 157.25, category: 'Lanthanide', discovery: '1880' },
            { atomicNumber: 65, symbol: 'Tb', name: 'Terbium', atomicMass: 158.93, category: 'Lanthanide', discovery: '1843' },
            { atomicNumber: 66, symbol: 'Dy', name: 'Dysprosium', atomicMass: 162.50, category: 'Lanthanide', discovery: '1886' },
            { atomicNumber: 67, symbol: 'Ho', name: 'Holmium', atomicMass: 164.93, category: 'Lanthanide', discovery: '1878' },
            { atomicNumber: 68, symbol: 'Er', name: 'Erbium', atomicMass: 167.26, category: 'Lanthanide', discovery: '1843' },
            { atomicNumber: 69, symbol: 'Tm', name: 'Thulium', atomicMass: 168.93, category: 'Lanthanide', discovery: '1879' },
            { atomicNumber: 70, symbol: 'Yb', name: 'Ytterbium', atomicMass: 173.05, category: 'Lanthanide', discovery: '1878' },
            { atomicNumber: 71, symbol: 'Lu', name: 'Lutetium', atomicMass: 174.97, category: 'Lanthanide', discovery: '1907' },
            { atomicNumber: 72, symbol: 'Hf', name: 'Hafnium', atomicMass: 178.49, category: 'Transition Metal', discovery: '1923' },
            { atomicNumber: 73, symbol: 'Ta', name: 'Tantalum', atomicMass: 180.95, category: 'Transition Metal', discovery: '1802' },
            { atomicNumber: 74, symbol: 'W', name: 'Tungsten', atomicMass: 183.84, category: 'Transition Metal', discovery: '1783' },
            
            // Round 5: Elements 75-92 (last naturally occurring)
            { atomicNumber: 75, symbol: 'Re', name: 'Rhenium', atomicMass: 186.21, category: 'Transition Metal', discovery: '1925' },
            { atomicNumber: 76, symbol: 'Os', name: 'Osmium', atomicMass: 190.23, category: 'Transition Metal', discovery: '1803' },
            { atomicNumber: 77, symbol: 'Ir', name: 'Iridium', atomicMass: 192.22, category: 'Transition Metal', discovery: '1803' },
            { atomicNumber: 78, symbol: 'Pt', name: 'Platinum', atomicMass: 195.08, category: 'Transition Metal', discovery: '1735' },
            { atomicNumber: 79, symbol: 'Au', name: 'Gold', atomicMass: 196.97, category: 'Transition Metal', discovery: 'Prehistoric' },
            { atomicNumber: 80, symbol: 'Hg', name: 'Mercury', atomicMass: 200.59, category: 'Transition Metal', discovery: 'Ancient' },
            { atomicNumber: 81, symbol: 'Tl', name: 'Thallium', atomicMass: 204.38, category: 'Post-transition Metal', discovery: '1861' },
            { atomicNumber: 82, symbol: 'Pb', name: 'Lead', atomicMass: 207.2, category: 'Post-transition Metal', discovery: 'Ancient' },
            { atomicNumber: 83, symbol: 'Bi', name: 'Bismuth', atomicMass: 208.98, category: 'Post-transition Metal', discovery: 'Ancient' },
            { atomicNumber: 84, symbol: 'Po', name: 'Polonium', atomicMass: 209, category: 'Post-transition Metal', discovery: '1898' },
            { atomicNumber: 85, symbol: 'At', name: 'Astatine', atomicMass: 210, category: 'Halogen', discovery: '1940' },
            { atomicNumber: 86, symbol: 'Rn', name: 'Radon', atomicMass: 222, category: 'Noble Gas', discovery: '1900' },
            { atomicNumber: 87, symbol: 'Fr', name: 'Francium', atomicMass: 223, category: 'Alkali Metal', discovery: '1939' },
            { atomicNumber: 88, symbol: 'Ra', name: 'Radium', atomicMass: 226, category: 'Alkaline Earth Metal', discovery: '1898' },
            { atomicNumber: 89, symbol: 'Ac', name: 'Actinium', atomicMass: 227, category: 'Actinide', discovery: '1899' },
            { atomicNumber: 90, symbol: 'Th', name: 'Thorium', atomicMass: 232.04, category: 'Actinide', discovery: '1829' },
            { atomicNumber: 91, symbol: 'Pa', name: 'Protactinium', atomicMass: 231.04, category: 'Actinide', discovery: '1913' },
            { atomicNumber: 92, symbol: 'U', name: 'Uranium', atomicMass: 238.03, category: 'Actinide', discovery: '1789' },
            
            // Bonus Round: Synthetic elements (93-118)
            { atomicNumber: 93, symbol: 'Np', name: 'Neptunium', atomicMass: 237, category: 'Actinide', discovery: '1940' },
            { atomicNumber: 94, symbol: 'Pu', name: 'Plutonium', atomicMass: 244, category: 'Actinide', discovery: '1940' },
            { atomicNumber: 95, symbol: 'Am', name: 'Americium', atomicMass: 243, category: 'Actinide', discovery: '1944' },
            { atomicNumber: 96, symbol: 'Cm', name: 'Curium', atomicMass: 247, category: 'Actinide', discovery: '1944' },
            { atomicNumber: 97, symbol: 'Bk', name: 'Berkelium', atomicMass: 247, category: 'Actinide', discovery: '1949' },
            { atomicNumber: 98, symbol: 'Cf', name: 'Californium', atomicMass: 251, category: 'Actinide', discovery: '1950' },
            { atomicNumber: 99, symbol: 'Es', name: 'Einsteinium', atomicMass: 252, category: 'Actinide', discovery: '1952' },
            { atomicNumber: 100, symbol: 'Fm', name: 'Fermium', atomicMass: 257, category: 'Actinide', discovery: '1952' },
            { atomicNumber: 101, symbol: 'Md', name: 'Mendelevium', atomicMass: 258, category: 'Actinide', discovery: '1955' },
            { atomicNumber: 102, symbol: 'No', name: 'Nobelium', atomicMass: 259, category: 'Actinide', discovery: '1958' },
            { atomicNumber: 103, symbol: 'Lr', name: 'Lawrencium', atomicMass: 266, category: 'Actinide', discovery: '1961' },
            { atomicNumber: 104, symbol: 'Rf', name: 'Rutherfordium', atomicMass: 267, category: 'Transition Metal', discovery: '1964' },
            { atomicNumber: 105, symbol: 'Db', name: 'Dubnium', atomicMass: 268, category: 'Transition Metal', discovery: '1967' },
            { atomicNumber: 106, symbol: 'Sg', name: 'Seaborgium', atomicMass: 269, category: 'Transition Metal', discovery: '1974' },
            { atomicNumber: 107, symbol: 'Bh', name: 'Bohrium', atomicMass: 270, category: 'Transition Metal', discovery: '1981' },
            { atomicNumber: 108, symbol: 'Hs', name: 'Hassium', atomicMass: 277, category: 'Transition Metal', discovery: '1984' },
            { atomicNumber: 109, symbol: 'Mt', name: 'Meitnerium', atomicMass: 278, category: 'Unknown', discovery: '1982' },
            { atomicNumber: 110, symbol: 'Ds', name: 'Darmstadtium', atomicMass: 281, category: 'Unknown', discovery: '1994' },
            { atomicNumber: 111, symbol: 'Rg', name: 'Roentgenium', atomicMass: 282, category: 'Unknown', discovery: '1994' },
            { atomicNumber: 112, symbol: 'Cn', name: 'Copernicium', atomicMass: 285, category: 'Transition Metal', discovery: '1996' },
            { atomicNumber: 113, symbol: 'Nh', name: 'Nihonium', atomicMass: 286, category: 'Unknown', discovery: '2004' },
            { atomicNumber: 114, symbol: 'Fl', name: 'Flerovium', atomicMass: 289, category: 'Unknown', discovery: '1998' },
            { atomicNumber: 115, symbol: 'Mc', name: 'Moscovium', atomicMass: 290, category: 'Unknown', discovery: '2004' },
            { atomicNumber: 116, symbol: 'Lv', name: 'Livermorium', atomicMass: 293, category: 'Unknown', discovery: '2000' },
            { atomicNumber: 117, symbol: 'Ts', name: 'Tennessine', atomicMass: 294, category: 'Unknown', discovery: '2010' },
            { atomicNumber: 118, symbol: 'Og', name: 'Oganesson', atomicMass: 294, category: 'Unknown', discovery: '2006' }
        ];

        // Game state (will be initialized with saved data or defaults)
        let gameState = {
            currentRound: 1,
            currentMode: 'symbol-to-name', // 'symbol-to-name' or 'name-to-symbol'
            gameMode: 'practice', // 'practice' or 'challenge'
            score: 0,
            currentQuestion: null,
            questionsRemaining: [],
            timerInterval: null,
            startTime: null,
            roundStartTime: null,
            roundTimes: [], // Array to store time taken for each round
            roundLimits: [
                { start: 1, end: 20, name: 'Elements 1-20' },
                { start: 21, end: 36, name: 'Common Secondary School Elements' },
                { start: 37, end: 54, name: 'Elements 37-54' },
                { start: 55, end: 74, name: 'Elements 55-74' },
                { start: 75, end: 92, name: 'Elements 75-92 (Last Natural Elements)' },
                { start: 93, end: 118, name: 'Synthetic Elements (93-118)' }
            ],
            progressData: {
                // Structure will be:
                // round: { symbolToName: [atomicNumbers], nameToSymbol: [atomicNumbers] }
            }
        };
        
        // Local storage availability flag
        let localStorageAvailable = false;

        // Check if localStorage is available
        function checkLocalStorageAvailability() {
            try {
                const testKey = '__storage_test__';
                localStorage.setItem(testKey, testKey);
                localStorage.removeItem(testKey);
                localStorageAvailable = true;
                return true;
            } catch (e) {
                localStorageAvailable = false;
                console.warn('localStorage is not available. Progress will not be saved between sessions.');
                return false;
            }
        }
        
        // Local storage functions
        function saveGameState() {
            if (!localStorageAvailable) return;
            
            try {
                // Only save what's needed for persistence (not temp state like currentQuestion)
                const stateToSave = {
                    currentRound: gameState.currentRound,
                    currentMode: gameState.currentMode,
                    gameMode: gameState.gameMode,
                    score: gameState.score,
                    roundTimes: gameState.roundTimes,
                    progressData: gameState.progressData
                };
                
                localStorage.setItem('periodicTableGameState', JSON.stringify(stateToSave));
                console.log('Game progress saved');
            } catch (error) {
                console.warn('Error saving game state:', error);
                localStorageAvailable = false;
            }
        }
        
        function loadGameState() {
            if (!localStorageAvailable) return false;
            
            try {
                const savedState = localStorage.getItem('periodicTableGameState');
                
                if (savedState) {
                    const parsedState = JSON.parse(savedState);
                    
                    // Update gameState with saved values
                    gameState.currentRound = parsedState.currentRound || 1;
                    gameState.currentMode = parsedState.currentMode || 'symbol-to-name';
                    gameState.gameMode = parsedState.gameMode || 'practice';
                    gameState.score = parsedState.score || 0;
                    gameState.roundTimes = parsedState.roundTimes || [];
                    
                    // Load progress data if it exists
                    if (parsedState.progressData) {
                        gameState.progressData = parsedState.progressData;
                    } else {
                        // Initialize progress data
                        initializeProgressData();
                    }
                    
                    console.log('Game progress loaded');
                    return true;
                } else {
                    // No saved state, initialize progress data
                    initializeProgressData();
                    return false;
                }
            } catch (error) {
                console.warn('Error loading game state:', error);
                localStorageAvailable = false;
                initializeProgressData();
                return false;
            }
        }
        
        function resetGameProgress() {
            // Clear saved game state
            if (localStorageAvailable) {
                try {
                    localStorage.removeItem('periodicTableGameState');
                } catch (error) {
                    console.warn('Error removing saved game state:', error);
                    localStorageAvailable = false;
                }
            }
            
            // Reset game state
            gameState.currentRound = 1;
            gameState.currentMode = 'symbol-to-name';
            gameState.gameMode = 'practice';
            gameState.score = 0;
            gameState.startTime = null;
            gameState.roundTimes = [];
            
            // Clear progress data
            initializeProgressData();
            
            // Update UI
            updateScore();
            
            console.log('Game progress reset');
        }
        
        function initializeProgressData() {
            gameState.progressData = {};
            for (let i = 1; i <= gameState.roundLimits.length; i++) {
                gameState.progressData[i] = {
                    'symbol-to-name': [],
                    'name-to-symbol': []
                };
            }
        }

        // DOM Elements
        const startScreen = document.getElementById('start-screen');
        const practiceSelectionScreen = document.getElementById('practice-selection');
        const gameMain = document.getElementById('game-main');
        const questionElement = document.getElementById('question-element');
        const optionsGrid = document.getElementById('options-grid');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const feedbackMessage = document.getElementById('feedback-message');
        const questionPrompt = document.getElementById('question-prompt');
        const roundCompleteModal = document.getElementById('round-complete-modal');
        const gameCompleteModal = document.getElementById('game-complete-modal');
        const roundsProgressContainer = document.getElementById('rounds-progress');
        const elementDetails = document.getElementById('element-details');
        const miniPeriodicTable = document.getElementById('mini-periodic-table');
        const timerContainer = document.getElementById('timer-container');
        const timerDisplay = document.getElementById('timer');
        const gameModeBadge = document.getElementById('game-mode-badge');
        const switchModeBtn = document.getElementById('switch-mode-btn');

        // Initialize the game
        function initGame() {
            // Check if localStorage is available
            checkLocalStorageAvailability();
            
            // Try to load saved game state
            const hasSavedState = loadGameState();
            
            // Show storage status indicator and set up reset button
            setupStorageIndicator();
            
            // Setup event for reset progress button
            document.getElementById('reset-progress-btn').addEventListener('click', function() {
                if (confirm('Are you sure you want to reset all your progress? This cannot be undone.')) {
                    resetGameProgress();
                    // Reload the page to reflect reset
                    window.location.reload();
                }
            });
            
            // Setup start screen
            setupStartScreen();

            // Initialize with no element selected
            showElementDetails(null);
            
            // If there's saved progress, show a notification
            if (hasSavedState) {
                // Check if there's actual progress (not just a new game)
                let hasProgress = false;
                for (let round in gameState.progressData) {
                    if (gameState.progressData[round]['symbol-to-name'].length > 0 || 
                        gameState.progressData[round]['name-to-symbol'].length > 0) {
                        hasProgress = true;
                        break;
                    }
                }
                
                if (hasProgress) {
                    const notification = document.createElement('div');
                    notification.style.background = '#2ecc71';
                    notification.style.color = 'white';
                    notification.style.padding = '10px';
                    notification.style.textAlign = 'center';
                    notification.style.marginBottom = '15px';
                    notification.style.borderRadius = '5px';
                    notification.textContent = 'Your previous progress has been loaded!';
                    
                    // Insert after header
                    const header = document.querySelector('header');
                    header.parentNode.insertBefore(notification, header.nextSibling);
                    
                    // Remove after 5 seconds
                    setTimeout(function() {
                        notification.style.opacity = '0';
                        notification.style.transition = 'opacity 1s';
                        setTimeout(function() {
                            notification.remove();
                        }, 1000);
                    }, 5000);
                }
            }
        }
        
        function setupStorageIndicator() {
            const resetBtn = document.getElementById('reset-progress-btn');
            
            // Update the reset button appearance based on storage availability
            if (!localStorageAvailable) {
                resetBtn.textContent = 'Progress Not Saved';
                resetBtn.style.background = '#f0f0f0';
                resetBtn.style.color = '#95a5a6';
                resetBtn.style.border = '1px solid #95a5a6';
                resetBtn.style.cursor = 'default';
                
                // Show tooltip on hover
                resetBtn.title = 'LocalStorage is not available. Progress will not be saved between sessions. Try opening the game on a web server instead of a local file.';
                
                // Remove click handler
                resetBtn.onclick = null;
                
                // Add popup with more info when clicked
                resetBtn.addEventListener('click', function() {
                    alert('LocalStorage is not available in your browser when running from a local file. To enable progress saving:\n\n' +
                          '1. Upload this HTML file to a web server, or\n' +
                          '2. Use a local development server like http-server, or\n' +
                          '3. Open the game in a different browser.');
                });
            }
        }

        // Setup start screen
        function setupStartScreen() {
            document.getElementById('practice-mode-btn').addEventListener('click', function() {
                startScreen.style.display = 'none';
                practiceSelectionScreen.style.display = 'flex';
                setupPracticeScreen();
            });

            document.getElementById('challenge-mode-btn').addEventListener('click', function() {
                startScreen.style.display = 'none';
                gameState.gameMode = 'challenge';
                gameState.currentRound = 1;
                gameState.currentMode = 'symbol-to-name';
                resetGameProgress();
                startGame();
            });
        }

        // Setup practice mode selection screen
        function setupPracticeScreen() {
            const roundOptionsContainer = document.getElementById('practice-round-options');
            roundOptionsContainer.innerHTML = '';

            // Create round options
            for (let i = 1; i <= gameState.roundLimits.length; i++) {
                const roundOption = document.createElement('div');
                roundOption.className = 'round-option';
                roundOption.textContent = i;
                roundOption.dataset.round = i;

                // First round is always unlocked
                if (i === 1) {
                    roundOption.classList.add('selected');
                } else {
                    // Check if previous round is completed in both modes
                    const prevRound = i - 1;
                    const prevRoundSymbolComplete = gameState.progressData[prevRound]['symbol-to-name'].length === 
                        getRoundElementCount(prevRound);
                    const prevRoundNameComplete = gameState.progressData[prevRound]['name-to-symbol'].length === 
                        getRoundElementCount(prevRound);
                    
                    if (!prevRoundSymbolComplete || !prevRoundNameComplete) {
                        roundOption.classList.add('locked');
                    } else {
                        roundOption.addEventListener('click', function() {
                            document.querySelector('.round-option.selected')?.classList.remove('selected');
                            roundOption.classList.add('selected');
                        });
                    }
                }

                roundOptionsContainer.appendChild(roundOption);
            }

            // Setup event listeners
            document.getElementById('start-practice-btn').addEventListener('click', function() {
                const selectedRound = document.querySelector('.round-option.selected');
                if (selectedRound) {
                    gameState.currentRound = parseInt(selectedRound.dataset.round);
                    gameState.currentMode = document.querySelector('input[name="practice-mode"]:checked').value;
                    gameState.gameMode = 'practice';
                    practiceSelectionScreen.style.display = 'none';
                    startGame();
                }
            });

            document.getElementById('back-to-main-btn').addEventListener('click', function() {
                practiceSelectionScreen.style.display = 'none';
                startScreen.style.display = 'flex';
            });
        }

        // Start the game
        function startGame() {
            gameMain.style.display = 'block';
            
            // Update UI for the current game mode
            updateGameModeUI();
            
            // Create mini periodic table
            createMiniPeriodicTable();
            
            // Setup round indicators
            updateRoundProgressIndicators();
            
            // Initialize game
            updateRoundInfo();
            loadQuestionsForRound();
            displayNextQuestion();
            setupGameEventListeners();
            updateScore();
            
            // Start timer if in challenge mode
            if (gameState.gameMode === 'challenge') {
                startTimer();
            }
        }

        // Update UI based on game mode
        function updateGameModeUI() {
            if (gameState.gameMode === 'challenge') {
                gameModeBadge.textContent = 'Challenge Mode';
                gameModeBadge.style.backgroundColor = '#e74c3c';
                timerContainer.style.display = 'flex';
                switchModeBtn.textContent = 'Switch to Practice Mode';
            } else {
                gameModeBadge.textContent = 'Practice Mode';
                gameModeBadge.style.backgroundColor = '#3498db';
                timerContainer.style.display = 'none';
                switchModeBtn.textContent = 'Switch to Challenge Mode';
            }
        }

        // Setup game event listeners
        function setupGameEventListeners() {
            // Switch mode button
            switchModeBtn.addEventListener('click', function() {
                if (gameState.gameMode === 'challenge') {
                    // Switch to practice mode
                    gameState.gameMode = 'practice';
                    stopTimer();
                    updateGameModeUI();
                    
                    // Show practice selection screen
                    gameMain.style.display = 'none';
                    practiceSelectionScreen.style.display = 'flex';
                    setupPracticeScreen();
                } else {
                    // Switch to challenge mode
                    gameState.gameMode = 'challenge';
                    gameState.currentRound = 1;
                    gameState.currentMode = 'symbol-to-name';
                    resetGameProgress();
                    updateGameModeUI();
                    startTimer();
                    
                    // Update game display
                    updateRoundInfo();
                    loadQuestionsForRound();
                    displayNextQuestion();
                    updateRoundProgressIndicators();
                    createMiniPeriodicTable();
                }
            });

            // Continue button in round complete modal
            document.getElementById('continue-btn').addEventListener('click', continueAfterModeComplete);
            
            // Restart game button
            document.getElementById('restart-game-btn').addEventListener('click', function() {
                gameCompleteModal.style.display = 'none';
                startScreen.style.display = 'flex';
                gameMain.style.display = 'none';
                resetGameProgress();
            });
        }

        // Timer functions
        function startTimer() {
            // Clear any existing timer
            clearInterval(gameState.timerInterval);
            
            // Set start time
            if (!gameState.startTime) {
                gameState.startTime = new Date();
            }
            
            // Set round start time
            gameState.roundStartTime = new Date();
            
            // Update timer display
            gameState.timerInterval = setInterval(updateTimer, 1000);
            updateTimer(); // Update immediately
        }

        function updateTimer() {
            const currentTime = new Date();
            const elapsedMilliseconds = currentTime - gameState.startTime;
            const totalSeconds = Math.floor(elapsedMilliseconds / 1000);
            
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            
            timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function stopTimer() {
            clearInterval(gameState.timerInterval);
            
            // Record round time
            if (gameState.roundStartTime) {
                const endTime = new Date();
                const roundTimeInSeconds = Math.floor((endTime - gameState.roundStartTime) / 1000);
                gameState.roundTimes[gameState.currentRound - 1] = roundTimeInSeconds;
                
                // Save the timer data
                saveGameState();
            }
        }

        // Reset game progress
        function resetGameProgress() {
            gameState.score = 0;
            gameState.startTime = null;
            gameState.roundTimes = [];
            
            // Clear progress data
            for (let i = 1; i <= gameState.roundLimits.length; i++) {
                gameState.progressData[i] = {
                    'symbol-to-name': [],
                    'name-to-symbol': []
                };
            }
        }

        // Create mini periodic table
        function createMiniPeriodicTable() {
            miniPeriodicTable.innerHTML = '';
            
            // Standard periodic table layout
            const periodicTableLayout = [
                // Period 1
                [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
                // Period 2
                [3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5, 6, 7, 8, 9, 10],
                // Period 3
                [11, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 14, 15, 16, 17, 18],
                // Period 4
                [19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36],
                // Period 5
                [37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54],
                // Period 6
                [55, 56, 57, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86],
                // Period 7
                [87, 88, 89, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118],
                // Spacer
                [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                // Lanthanides
                [0, 0, 0, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 0],
                // Actinides
                [0, 0, 0, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 0]
            ];
            
            // Create the table
            periodicTableLayout.forEach(row => {
                row.forEach(atomicNumber => {
                    const cell = document.createElement('div');
                    cell.className = 'mini-element';
                    
                    if (atomicNumber === 0) {
                        cell.classList.add('empty');
                    } else {
                        const element = elements.find(el => el.atomicNumber === atomicNumber);
                        
                        // Check if this element is in the current round
                        const roundLimits = gameState.roundLimits[gameState.currentRound - 1];
                        if (atomicNumber >= roundLimits.start && atomicNumber <= roundLimits.end) {
                            cell.classList.add('current-round');
                        }
                        
                        // Check if this element has been completed in the current mode
                        const symbolToNameComplete = gameState.progressData[getElementRound(atomicNumber)]?.['symbol-to-name']?.includes(atomicNumber);
                        const nameToSymbolComplete = gameState.progressData[getElementRound(atomicNumber)]?.['name-to-symbol']?.includes(atomicNumber);
                        
                        if (symbolToNameComplete && nameToSymbolComplete) {
                            cell.classList.add('completed');
                        }
                        
                        cell.textContent = element.symbol;
                        cell.title = `${element.name} (${element.atomicNumber})`;
                    }
                    
                    miniPeriodicTable.appendChild(cell);
                });
            });
        }

        // Get which round an element belongs to
        function getElementRound(atomicNumber) {
            for (let i = 0; i < gameState.roundLimits.length; i++) {
                if (atomicNumber >= gameState.roundLimits[i].start && atomicNumber <= gameState.roundLimits[i].end) {
                    return i + 1;
                }
            }
            return null;
        }

        // Setup round progress indicators
        function updateRoundProgressIndicators() {
            roundsProgressContainer.innerHTML = '';
            
            for (let i = 1; i <= gameState.roundLimits.length; i++) {
                const roundDiv = document.createElement('div');
                roundDiv.className = 'round-progress-item';
                
                const indicator = document.createElement('div');
                indicator.className = 'round-indicator';
                
                // Check if this round is accessible
                let isLocked = false;
                if (i > 1 && gameState.gameMode === 'challenge') {
                    const prevRound = i - 1;
                    const prevRoundSymbolComplete = gameState.progressData[prevRound]['symbol-to-name'].length === 
                        getRoundElementCount(prevRound);
                    const prevRoundNameComplete = gameState.progressData[prevRound]['name-to-symbol'].length === 
                        getRoundElementCount(prevRound);
                    
                    if (!prevRoundSymbolComplete || !prevRoundNameComplete) {
                        isLocked = true;
                        indicator.classList.add('locked');
                    }
                }
                
                // Check completion status
                const symbolComplete = gameState.progressData[i]['symbol-to-name'].length === getRoundElementCount(i);
                const nameComplete = gameState.progressData[i]['name-to-symbol'].length === getRoundElementCount(i);
                
                if (symbolComplete) indicator.classList.add('symbol-complete');
                if (nameComplete) indicator.classList.add('name-complete');
                if (symbolComplete && nameComplete) indicator.classList.add('complete');
                if (i === gameState.currentRound) indicator.classList.add('current');
                
                indicator.innerHTML = `<span>${i}</span>`;
                
                // Add click handler if not locked and in practice mode
                if (!isLocked && gameState.gameMode === 'practice') {
                    indicator.addEventListener('click', function() {
                        if (i !== gameState.currentRound) {
                            gameState.currentRound = i;
                            updateRoundInfo();
                            loadQuestionsForRound();
                            displayNextQuestion();
                            createMiniPeriodicTable();
                            updateRoundProgressIndicators();
                        }
                    });
                }
                
                roundDiv.appendChild(indicator);
                roundDiv.appendChild(document.createTextNode(`Round ${i}`));
                
                roundsProgressContainer.appendChild(roundDiv);
            }
        }

        // Get count of elements in a round
        function getRoundElementCount(roundNumber) {
            const limits = gameState.roundLimits[roundNumber - 1];
            return limits.end - limits.start + 1;
        }

        // Update round information display
        function updateRoundInfo() {
            const roundInfo = document.querySelector('.round-info');
            const modeInfo = document.querySelector('.game-mode-info');
            const currentRoundData = gameState.roundLimits[gameState.currentRound - 1];
            
            roundInfo.textContent = `Round ${gameState.currentRound}: ${currentRoundData.name}`;
            modeInfo.textContent = `Mode: ${gameState.currentMode === 'symbol-to-name' ? 'Symbol â†’ Name' : 'Name â†’ Symbol'}`;
        }

        // Load questions for current round
        function loadQuestionsForRound() {
            // Get current round limits
            const currentRoundData = gameState.roundLimits[gameState.currentRound - 1];
            
            // Get elements for this round
            const roundElements = elements.filter(el => 
                el.atomicNumber >= currentRoundData.start && 
                el.atomicNumber <= currentRoundData.end
            );
            
            // Filter out already answered elements
            const answeredElements = gameState.progressData[gameState.currentRound][gameState.currentMode];
            
            gameState.questionsRemaining = roundElements.filter(el => 
                !answeredElements.includes(el.atomicNumber)
            );
            
            // If all elements have been answered, we're done with this mode
            if (gameState.questionsRemaining.length === 0) {
                showModeCompleteModal();
                return;
            }
            
            // Update progress
            updateProgress();
        }

        // Display next question
        function displayNextQuestion() {
            // Clear feedback
            feedbackMessage.textContent = '';
            feedbackMessage.className = 'feedback-message';
            
            // If there are no more questions, reload
            if (gameState.questionsRemaining.length === 0) {
                loadQuestionsForRound();
                return; // loadQuestionsForRound will call showModeCompleteModal if needed
            }
            
            // Pick a random question from remaining
            const randomIndex = Math.floor(Math.random() * gameState.questionsRemaining.length);
            gameState.currentQuestion = gameState.questionsRemaining[randomIndex];
            
            // Update question display
            if (gameState.currentMode === 'symbol-to-name') {
                questionPrompt.textContent = 'What is the name of this element?';
                questionElement.innerHTML = `
                    <div class="element-atomic-number" id="atomic-number">${gameState.currentQuestion.atomicNumber}</div>
                    ${gameState.currentQuestion.symbol}
                `;
                // Generate name options
                generateOptions('name');
            } else {
                questionPrompt.textContent = 'What is the symbol for this element?';
                questionElement.textContent = gameState.currentQuestion.name;
                // Generate symbol options
                generateOptions('symbol');
            }
            
            // Update progress
            updateProgress();
        }

        // Generate answer options
        function generateOptions(type) {
            optionsGrid.innerHTML = '';
            
            // Get current round limits
            const currentRoundData = gameState.roundLimits[gameState.currentRound - 1];
            
            // Get all elements for this round
            const roundElements = elements.filter(el => 
                el.atomicNumber >= currentRoundData.start && 
                el.atomicNumber <= currentRoundData.end
            );
            
            // Sort elements by atomic number to maintain a consistent order
            const sortedElements = [...roundElements].sort((a, b) => a.atomicNumber - b.atomicNumber);
            
            // Show all elements from the round as options
            sortedElements.forEach(element => {
                const optionCard = document.createElement('div');
                optionCard.className = 'option-card';
                
                // Check if this element has already been answered
                const answeredElements = gameState.progressData[gameState.currentRound][gameState.currentMode];
                const isAnswered = answeredElements.includes(element.atomicNumber);
                
                if (isAnswered) {
                    optionCard.classList.add('disabled');
                }
                
                if (type === 'name') {
                    // Display names as options
                    optionCard.textContent = element.name;
                } else {
                    // Display symbols as options
                    optionCard.innerHTML = `
                        <div class="element-number">${element.atomicNumber}</div>
                        ${element.symbol}
                    `;
                }
                
                // Add click handler (only if not already answered)
                if (!isAnswered) {
                    optionCard.addEventListener('click', function() {
                        handleOptionClick(optionCard, element);
                    });
                }
                
                optionsGrid.appendChild(optionCard);
            });
        }

        // Handle option click
        function handleOptionClick(optionCard, selectedElement) {
            // Check if answer is correct
            const isCorrect = selectedElement.atomicNumber === gameState.currentQuestion.atomicNumber;
            
            if (isCorrect) {
                // Mark as correct
                optionCard.classList.add('correct');
                feedbackMessage.textContent = 'Correct!';
                feedbackMessage.className = 'feedback-message feedback-correct';
                
                // Add to progress data if not already there
                const currentProgress = gameState.progressData[gameState.currentRound][gameState.currentMode];
                if (!currentProgress.includes(selectedElement.atomicNumber)) {
                    currentProgress.push(selectedElement.atomicNumber);
                    
                    // Save progress to local storage
                    saveGameState();
                }
                
                // Remove from questions remaining
                gameState.questionsRemaining = gameState.questionsRemaining.filter(element => 
                    element.atomicNumber !== selectedElement.atomicNumber
                );
                
                // Add points
                gameState.score += 10;
                updateScore();
                
                // Save updated score
                saveGameState();
                
                // Show element details
                showElementDetails(selectedElement);
                
                // Update mini periodic table
                createMiniPeriodicTable();
                
                // Move to next question after delay
                setTimeout(function() {
                    displayNextQuestion();
                    updateRoundProgressIndicators();
                }, 1500);
            } else {
                // Mark as incorrect
                optionCard.classList.add('incorrect');
                feedbackMessage.textContent = 'Incorrect! Try again.';
                feedbackMessage.className = 'feedback-message feedback-incorrect';
                
                // Deduct points
                gameState.score = Math.max(0, gameState.score - 2);
                updateScore();
                
                // Save updated score
                saveGameState();
                
                // Remove incorrect marking after a delay
                setTimeout(function() {
                    optionCard.classList.remove('incorrect');
                    feedbackMessage.textContent = '';
                }, 1500);
            }
        }

        // Update score display
        function updateScore() {
            document.getElementById('score').textContent = gameState.score;
        }

        // Update progress bar
        function updateProgress() {
            const currentProgress = gameState.progressData[gameState.currentRound][gameState.currentMode];
            const totalElements = getRoundElementCount(gameState.currentRound);
            
            const progressPercentage = (currentProgress.length / totalElements) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            progressText.textContent = `${currentProgress.length}/${totalElements}`;
        }

        // Show element details
        function showElementDetails(element) {
            if (!element) {
                elementDetails.innerHTML = `
                    <div class="no-element-selected">
                        Select an element to see details
                    </div>
                `;
                return;
            }
            
            elementDetails.innerHTML = `
                <h3>
                    <span class="element-details-symbol" id="detail-symbol">${element.symbol}</span>
                    <span id="detail-name">${element.name}</span>
                </h3>
                <div class="element-info-grid">
                    <div class="element-info-item">
                        <div class="element-info-label">Atomic Number</div>
                        <div id="detail-atomic-number">${element.atomicNumber}</div>
                    </div>
                    <div class="element-info-item">
                        <div class="element-info-label">Atomic Mass</div>
                        <div id="detail-atomic-mass">${element.atomicMass}</div>
                    </div>
                    <div class="element-info-item">
                        <div class="element-info-label">Category</div>
                        <div id="detail-category">${element.category}</div>
                    </div>
                    <div class="element-info-item">
                        <div class="element-info-label">Discovery</div>
                        <div id="detail-discovery">${element.discovery}</div>
                    </div>
                </div>
            `;
        }

        // Show mode complete modal
        function showModeCompleteModal() {
            document.getElementById('completed-mode-name').textContent = 
                gameState.currentMode === 'symbol-to-name' ? 'Symbol â†’ Name' : 'Name â†’ Symbol';
            document.getElementById('completed-round').textContent = gameState.currentRound;
            document.getElementById('round-score').textContent = gameState.score;
            
            roundCompleteModal.style.display = 'flex';
        }

        // Show game complete modal
        function showGameCompleteModal() {
            document.getElementById('final-score').textContent = gameState.score;
            gameCompleteModal.style.display = 'flex';
        }

        // Toggle game mode
        function toggleGameMode() {
            // Switch mode
            gameState.currentMode = gameState.currentMode === 'symbol-to-name' ? 'name-to-symbol' : 'symbol-to-name';
            
            // Update UI
            updateRoundInfo();
            showElementDetails(null);
            
            // Load new questions
            loadQuestionsForRound();
            displayNextQuestion();
        }

        // Check if round is completely finished (both modes)
        function isRoundComplete(roundNumber) {
            const roundElementCount = getRoundElementCount(roundNumber);
            const symbolProgress = gameState.progressData[roundNumber]['symbol-to-name'].length;
            const nameProgress = gameState.progressData[roundNumber]['name-to-symbol'].length;
            
            return symbolProgress === roundElementCount && nameProgress === roundElementCount;
        }

        // Check if game is completely finished
        function checkGameCompletion() {
            for (let i = 1; i <= gameState.roundLimits.length; i++) {
                if (!isRoundComplete(i)) {
                    return false;
                }
            }
            return true;
        }

        // Continue after completing a mode
        function continueAfterModeComplete() {
            roundCompleteModal.style.display = 'none';
            
            // If both modes are complete for this round
            if (isRoundComplete(gameState.currentRound)) {
                // If this was the last round, show game complete
                if (gameState.currentRound === gameState.roundLimits.length) {
                    if (checkGameCompletion()) {
                        showGameCompleteModal();
                        return;
                    }
                }
                
                // Automatically move to next round
                gameState.currentRound = Math.min(gameState.currentRound + 1, gameState.roundLimits.length);
                gameState.currentMode = 'symbol-to-name'; // Start with symbol mode
                
                // If in challenge mode, update the timer for the new round
                if (gameState.gameMode === 'challenge') {
                    // Record time for the completed round
                    stopTimer();
                    // Start timer for the new round
                    startTimer();
                }
            } else {
                // Just switch modes within the same round
                toggleGameMode();
            }
            
            // Save progress before updating UI
            saveGameState();
            
            updateRoundProgressIndicators();
            createMiniPeriodicTable();
            updateRoundInfo();
            loadQuestionsForRound();
            displayNextQuestion();
        }

        // Helper: Shuffle array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Initialize the game when page loads
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
