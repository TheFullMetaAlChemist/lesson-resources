<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Interactive Lesson: Elements</title>
  <style>
    /* Import a modern sans-serif font */
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #e6f7ff, #ffffff);
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: 40px auto;
      background-color: #fff;
      padding: 30px 40px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      position: relative;
    }
    h1 {
      text-align: center;
      color: #f57c00;
      margin-bottom: 20px;
    }
    h2 {
      text-align: center;
      color: #ff9800;
      margin-top: 30px;
      border-bottom: 2px solid #ffcc80;
      padding-bottom: 5px;
    }
    p, li {
      line-height: 1.6;
      font-size: 1.1em;
    }
    ul {
      margin-left: 20px;
    }
    .screen {
      display: none;
    }
    .active {
      display: block;
    }
    .question, .practice-question {
      margin: 15px 0;
      padding: 15px;
      border: 1px solid #ffcc80;
      border-radius: 8px;
      background-color: #fff8e1;
    }
    .hidden {
      display: none;
    }
    button {
      padding: 10px 16px;
      border: none;
      background-color: #f57c00;
      color: #fff;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
      font-size: 1em;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #e65100;
    }
    button:disabled {
      background-color: #ffcc80;
      color: #fff8e1;
      cursor: not-allowed;
    }
    .feedback {
      color: #d32f2f;
      margin-left: 10px;
      font-weight: 500;
    }
    select, input[type="text"], textarea {
      padding: 8px;
      margin-top: 5px;
      font-size: 1em;
      border: 1px solid #ffcc80;
      border-radius: 4px;
    }
    table {
      border-collapse: collapse;
      margin: 20px 0;
      width: 100%;
    }
    table, th, td {
      border: 1px solid #ffcc80;
    }
    th, td {
      padding: 12px;
      text-align: center;
    }
    th {
      background-color: #fff8e1;
    }
    .equation-help {
      background-color: #fff8e1;
      border: 1px solid #ffcc80;
      padding: 12px;
      margin-bottom: 15px;
      border-radius: 6px;
      font-style: italic;
    }
    .toggle-btn {
      background-color: #ff9800;
    }
    .nav-btn {
      background-color: #f57c00;
    }
    .particle-diagram {
      text-align: center;
      margin: 20px 0;
    }
    .particle-diagram svg {
      max-width: 100%;
      height: auto;
    }
    .element-card {
      border: 1px solid #ffcc80;
      border-radius: 8px;
      padding: 15px;
      margin: 10px;
      text-align: center;
      background-color: #fff8e1;
      display: inline-block;
      width: 120px;
    }
    .symbol {
      font-size: 2.5em;
      font-weight: bold;
      color: #f57c00;
    }
    .atomic-number {
      font-size: 0.9em;
      color: #555;
    }
    .element-name {
      font-size: 1.1em;
      margin-top: 5px;
    }
    .match-game {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-gap: 10px;
      margin: 20px 0;
      max-width: 600px;
      margin: 20px auto;
    }
    .match-card {
      width: 120px;
      height: 120px;
      background-color: #f57c00;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.5em;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease, border 0.3s ease;
      perspective: 1000px;
      text-align: center;
      padding: 5px;
      margin: 5px auto;
    }
    .match-card.flipped {
      background-color: #fff8e1;
      color: #f57c00;
      border: 2px solid #f57c00;
    }
    .game-controls {
      text-align: center;
      margin: 20px 0;
    }
    .round-info {
      font-size: 1.2em;
      font-weight: bold;
      margin-bottom: 10px;
      text-align: center;
      color: #f57c00;
    }
    /* Performance Descriptor screen */
    #descriptorMessage {
      font-size: 2em;
      font-weight: 700;
      text-align: center;
      color: #2e7d32;
      margin-top: 30px;
    }
    
    /* Particle diagram styling */
    /* Box to hold gas particles in random positions */
    .particle-box {
      width: 200px;      /* Adjust as desired */
      height: 120px;     /* Adjust as desired */
      position: relative;
      border: 1px dashed #ccc;
      margin: 0 auto;
    }
    /* Common atom styling (we'll place them absolutely inside the box) */
    .atom {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      position: absolute;  /* So we can manually place them */
    }
    /* Color classes for different atoms/ions */
    .helium { background-color: #ffeb3b; }   /* Yellowish for He */
    .oxygen { background-color: #2196f3; }   /* Blue for O2 or O in CO2 */
    .carbon { background-color: #795548; }   /* Brown for C in CO2 */
    .copper { background-color: #ffa726; }   /* Orange for solid copper */
    .sodium { background-color: #f48fb1; }   /* Pinkish for Na+ */
    .chlorine { background-color: #aed581; } /* Light green for Cl- */

    /* For diatomic or triatomic molecules, we nest multiple .atom inside a .molecule container */
    .molecule {
      position: absolute; /* We'll place the 'molecule' as a unit in the gas box */
    }
    /* Each 'atom' in a molecule is offset so they touch side by side (20px wide each) */
    .molecule .atom:nth-child(2) {
      left: 20px; 
      top: 0; 
    }
    /* If there's a third atom, it will appear 40px from the first to touch the second */
    .molecule .atom:nth-child(3) {
      left: 40px;
      top: 0;
    }

    /* For solids: close-packed grids with no gaps */
    .solid-grid {
      width: 80px;  /* 4 atoms across, each 20px wide = 80px total */
      height: 80px; /* 4 atoms tall = 80px total */
      display: grid;
      grid-template-columns: repeat(4, 20px);
      grid-template-rows: repeat(4, 20px);
      gap: 0;       /* No space between cells, so atoms touch */
      margin: 0 auto;
      border: 1px dashed #ccc;
      position: relative;
    }
    .solid-grid .atom {
      position: relative;
      margin: 0;  /* Fill the entire cell */
      /* By default, each cell is 20x20, so the circle touches neighbors. */
    }
    /* Center the circle in each grid cell (if needed) */
    .solid-grid .atom {
      display: block;
      margin: auto;
    }
    
    /* Diagram container styling */
    .diagram-section {
      background-color: #f1f8e9; 
      margin: 20px 0; 
      padding: 15px;
      border-radius: 8px;
    }
    .diagram-title {
      text-align: center; 
      font-weight: 600; 
      margin-bottom: 10px;
    }
    
    /* Bingo game styling */
    .bingo-container {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
      gap: 30px;
    }
    .bingo-card {
      width: 45%;
      border: 2px solid #f57c00;
      border-radius: 8px;
      padding: 10px;
      background-color: #fff8e1;
    }
    .bingo-title {
      text-align: center;
      font-weight: bold;
      font-size: 1.2em;
      margin-bottom: 10px;
      color: #f57c00;
    }
    .bingo-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 10px;
    }
    .bingo-cell {
      height: 80px;
      background-color: white;
      border: 1px solid #f57c00;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5em;
      font-weight: bold;
      color: #f57c00;
      cursor: pointer;
      position: relative;
      padding: 5px;
      word-break: break-word;
      text-align: center;
    }
    .bingo-cell.selected {
      background-color: #e0f7fa;
    }
    .bingo-cell.marked {
      background-color: #c8e6c9;
    }
    .bingo-cell.highlighted {
      background-color: #fff59d;
      animation: highlight-pulse 1s infinite;
    }
    @keyframes highlight-pulse {
      0% { box-shadow: 0 0 0 0 rgba(245, 124, 0, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(245, 124, 0, 0); }
      100% { box-shadow: 0 0 0 0 rgba(245, 124, 0, 0); }
    }
    .bingo-element-selector {
      margin: 20px 0;
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 5px;
    }
    .element-option {
      padding: 10px;
      border: 1px solid #f57c00;
      border-radius: 6px;
      text-align: center;
      cursor: pointer;
      background-color: white;
    }
    .element-option.selected {
      background-color: #e0f7fa;
      font-weight: bold;
    }
    .bingo-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
    }
    .bingo-result {
      display: flex;
      justify-content: space-between;
      margin: 20px 0;
    }
    .draw-result {
      font-size: 2em;
      font-weight: bold;
      text-align: center;
      color: #f57c00;
      background-color: #fff8e1;
      padding: 10px;
      border-radius: 8px;
      margin: 10px auto;
      width: 100px;
      height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #f57c00;
    }
    .score-display {
      text-align: center;
      font-size: 1.2em;
      font-weight: bold;
      margin: 10px 0;
    }
    .claim-form {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 20px 0;
      gap: 10px;
    }
    .claim-form input {
      padding: 10px;
      border: 1px solid #f57c00;
      border-radius: 6px;
      width: 200px;
      font-size: 1.1em;
    }
    .claim-form button {
      padding: 10px 20px;
    }
    .bingo-message {
      text-align: center;
      font-weight: bold;
      color: #2e7d32;
      margin: 10px 0;
      font-size: 1.2em;
    }
    .bingo-instructions {
      background-color: #e0f7fa;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .bingo-game-state {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 10px 0;
    }
    .completed-line {
      position: absolute;
      background-color: rgba(46, 125, 50, 0.5);
      z-index: 1;
    }
    .horizontal-line {
      width: 100%;
      height: 5px;
    }
    .vertical-line {
      width: 5px;
      height: 100%;
    }
    .diagonal-line-1 {
      width: 5px;
      height: 141%;
      transform: rotate(45deg);
    }
    .diagonal-line-2 {
      width: 5px;
      height: 141%;
      transform: rotate(-45deg);
    }
    .random-select {
      margin-bottom: 10px;
      text-align: center;
    }
    .random-btn {
      background-color: #4CAF50;
      font-size: 1em;
      padding: 8px 15px;
    }
    .random-btn:hover {
      background-color: #3e8e41;
    }
    /* Fix for game phase visibility */
    #game-phase.hidden {
      display: none;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Elements: The Building Blocks of Matter</h1>
  <!-- Persistent Navigation -->
  <div style="text-align:right;">
    <button class="nav-btn" onclick="showScreen(6)">Element Symbols Game</button>
    <button class="nav-btn" onclick="showScreen(12)">Element Bingo</button>
    <button class="nav-btn" onclick="showScreen(7)">10-Mark Quiz</button>
    <button class="nav-btn" onclick="showScreen(8)">Extended Question</button>
    <button class="nav-btn" onclick="showPerformanceDescriptor()">How did I do?</button>
  </div>
  
  <!-- Screen 1: Introduction to Elements -->
  <div id="screen1" class="screen active">
    <h2>1. What is an Element?</h2>
    <p><strong>Key Definition:</strong> An <em>element</em> is a substance that cannot be broken down into simpler substances by chemical means.</p>
    <p>Elements are the fundamental building blocks of all matter. Every pure substance in the universe is either an element or a compound made of elements.</p>
    <p>Real-world examples of elements include:</p>
    <ul>
      <li><strong>Gold (Au):</strong> Used in jewelry and electronics</li>
      <li><strong>Oxygen (O):</strong> Essential for breathing</li>
      <li><strong>Carbon (C):</strong> Found in all living organisms</li>
      <li><strong>Aluminum (Al):</strong> Used in cans, foil, and aircraft</li>
    </ul>
    <div class="question">
      <p>Which of the following best describes an element?</p>
      <select id="q1a">
        <option value="">--Select--</option>
        <option value="A substance that cannot be broken down into simpler substances by chemical means">A substance that cannot be broken down into simpler substances by chemical means</option>
        <option value="A mixture of different substances">A mixture of different substances</option>
        <option value="A substance made up of different elements">A substance made up of different elements</option>
        <option value="A solution of chemicals">A solution of chemicals</option>
      </select>
      <span id="feedback1a" class="feedback"></span>
    </div>
    <button onclick="checkScreen1()">Check Answer</button>
    <br><br>
    <button id="next1" disabled onclick="showScreen(2)">Next</button>
  </div>
  
  <!-- Screen 2: Element Symbols -->
  <div id="screen2" class="screen">
    <h2>2. Chemical Symbols for Elements</h2>
    <p><strong>Key Rules:</strong> Each element has its own chemical symbol:</p>
    <ul>
      <li>The first letter is <strong>always capital (uppercase)</strong></li>
      <li>If there is a second letter, it is <strong>always lowercase</strong></li>
      <li>Scientists worldwide use the same chemical symbols regardless of language</li>
    </ul>
    <p>For example, the symbol for magnesium is <strong>Mg</strong>, not mg, MG, or mG.</p>
    
    <div class="element-card">
      <div class="atomic-number">12</div>
      <div class="symbol">Mg</div>
      <div class="element-name">Magnesium</div>
    </div>
    
    <div class="question">
      <p>Which of the following is the correct chemical symbol for Oxygen?</p>
      <select id="q2a">
        <option value="">--Select--</option>
        <option value="O">O</option>
        <option value="o">o</option>
        <option value="OX">OX</option>
        <option value="Ox">Ox</option>
      </select>
      <span id="feedback2a" class="feedback"></span>
    </div>
    <div class="question">
      <p>Which of the following is the correct chemical symbol for Carbon?</p>
      <select id="q2b">
        <option value="">--Select--</option>
        <option value="c">c</option>
        <option value="C">C</option>
        <option value="CA">CA</option>
        <option value="CR">CR</option>
      </select>
      <span id="feedback2b" class="feedback"></span>
    </div>
    <div class="question">
      <p>Which of the following is the correct chemical symbol for Helium?</p>
      <select id="q2c">
        <option value="">--Select--</option>
        <option value="H">H</option>
        <option value="HE">HE</option>
        <option value="He">He</option>
        <option value="he">he</option>
      </select>
      <span id="feedback2c" class="feedback"></span>
    </div>
    <button onclick="checkScreen2()">Check Answers</button>
    <br><br>
    <button onclick="showScreen(1)">Back</button>
    <button id="next2" disabled onclick="showScreen(3)">Next</button>
  </div>
  
  <!-- Screen 3: Common Elements and Their Symbols -->
  <div id="screen3" class="screen">
    <h2>3. Common Elements and Their Symbols</h2>
    <p>Here are some of the most common elements and their symbols:</p>
    <table>
      <tr>
        <th>Element Name</th>
        <th>Symbol</th>
        <th>Element Name</th>
        <th>Symbol</th>
      </tr>
      <tr>
        <td>Hydrogen</td>
        <td>H</td>
        <td>Oxygen</td>
        <td>O</td>
      </tr>
      <tr>
        <td>Carbon</td>
        <td>C</td>
        <td>Nitrogen</td>
        <td>N</td>
      </tr>
      <tr>
        <td>Sodium</td>
        <td>Na</td>
        <td>Magnesium</td>
        <td>Mg</td>
      </tr>
      <tr>
        <td>Aluminum</td>
        <td>Al</td>
        <td>Silicon</td>
        <td>Si</td>
      </tr>
      <tr>
        <td>Phosphorus</td>
        <td>P</td>
        <td>Sulfur</td>
        <td>S</td>
      </tr>
      <tr>
        <td>Chlorine</td>
        <td>Cl</td>
        <td>Potassium</td>
        <td>K</td>
      </tr>
      <tr>
        <td>Calcium</td>
        <td>Ca</td>
        <td>Iron</td>
        <td>Fe</td>
      </tr>
      <tr>
        <td>Copper</td>
        <td>Cu</td>
        <td>Zinc</td>
        <td>Zn</td>
      </tr>
      <tr>
        <td>Silver</td>
        <td>Ag</td>
        <td>Gold</td>
        <td>Au</td>
      </tr>
      <tr>
        <td>Mercury</td>
        <td>Hg</td>
        <td>Lead</td>
        <td>Pb</td>
      </tr>
    </table>
    <p><strong>Did you notice:</strong> Some symbols don't match the English name! That's because many symbols come from the element's name in Latin or other languages:</p>
    <ul>
      <li><strong>Na (Sodium)</strong> - From Latin "natrium"</li>
      <li><strong>K (Potassium)</strong> - From Latin "kalium"</li>
      <li><strong>Fe (Iron)</strong> - From Latin "ferrum"</li>
      <li><strong>Cu (Copper)</strong> - From Latin "cuprum"</li>
      <li><strong>Au (Gold)</strong> - From Latin "aurum"</li>
      <li><strong>Pb (Lead)</strong> - From Latin "plumbum"</li>
      <li><strong>W (Tungsten)</strong> - From German "wolfram"</li>
    </ul>
    
    <div class="question">
      <p>Match the following elements with their correct symbols:</p>
      <p>1. Hydrogen: <input type="text" id="s3q1" maxlength="2" size="3"></p>
      <p>2. Carbon: <input type="text" id="s3q2" maxlength="2" size="3"></p>
      <p>3. Sodium: <input type="text" id="s3q3" maxlength="2" size="3"></p>
      <p>4. Gold: <input type="text" id="s3q4" maxlength="2" size="3"></p>
      <p>5. Iron: <input type="text" id="s3q5" maxlength="2" size="3"></p>
      <button onclick="checkS3Matching()">Check Answers</button>
      <p id="s3feedback" class="feedback"></p>
    </div>
    <button onclick="showScreen(2)">Back</button>
    <button id="next3" disabled onclick="showScreen(4)">Next</button>
  </div>
  
  <!-- Screen 4: Elements in Our World -->
  <div id="screen4" class="screen">
    <h2>4. Elements in Our World</h2>
    <p><strong>Remember:</strong> An element is a substance that cannot be broken down into simpler substances by chemical means.</p>
    <p>Elements are found everywhere in our daily lives:</p>
    <ul>
      <li><strong>Smartphones</strong> contain many elements:
        <ul>
          <li>Gold (Au) in circuit boards</li>
          <li>Aluminum (Al) in cases</li>
          <li>Lithium (Li) in batteries</li>
          <li>Silicon (Si) in microchips</li>
          <li>Indium (In), tin (Sn), and oxygen (O) in touchscreens</li>
        </ul>
      </li>
      <li><strong>Human body</strong> is made up of elements:
        <ul>
          <li>Oxygen (O) - 65%</li>
          <li>Carbon (C) - 18%</li>
          <li>Hydrogen (H) - 10%</li>
          <li>Nitrogen (N) - 3%</li>
          <li>Calcium (Ca) - 1.5%</li>
          <li>And trace amounts of many others</li>
        </ul>
      </li>
    </ul>
    <p>Most elements don't exist in their pure form in nature. They're usually found as:</p>
    <ul>
      <li><strong>Compounds:</strong> Two or more elements chemically joined together</li>
      <li><strong>Mixtures:</strong> Elements or compounds physically mixed but not chemically joined</li>
    </ul>
    <div class="question">
      <p>Which of the following statements is true?</p>
      <select id="q4a">
        <option value="">--Select--</option>
        <option value="Most elements exist in pure form in nature">Most elements exist in pure form in nature</option>
        <option value="Elements can be broken down into simpler substances">Elements can be broken down into simpler substances</option>
        <option value="Most elements in nature exist as compounds or mixtures">Most elements in nature exist as compounds or mixtures</option>
        <option value="Elements only exist in laboratories">Elements only exist in laboratories</option>
      </select>
      <span id="feedback4a" class="feedback"></span>
    </div>
    <button onclick="checkScreen4()">Check Answer</button>
    <br><br>
    <button onclick="showScreen(3)">Back</button>
    <button id="next4" disabled onclick="showScreen(5)">Next</button>
  </div>
  
  <!-- Screen 5: Recognizing Elements and Compounds from Particle Diagrams -->
  <div id="screen5" class="screen">
    <h2>5. Recognizing Elements and Compounds</h2>
    <p><strong>Remember:</strong> An <strong>element</strong> is a substance that cannot be broken down into simpler substances by chemical means.</p>
    <p>In particle diagrams:</p>
    <ul>
      <li><strong>Elements</strong> have only one type of atom in their particles</li>
      <li><strong>Compounds</strong> have two or more different types of atoms chemically bonded together</li>
      <li><strong>Mixtures</strong> contain different elements or compounds that are not chemically bonded</li>
    </ul>
    
    <!-- Particle Diagram Examples -->
    <div class="diagram-section">
      <div class="diagram-title">
        Examples of Particle Diagrams
      </div>

      <!-- Gaseous Single-Atom Element (Helium) -->
      <h3>Gaseous Single-Atom Element (Helium)</h3>
      <p>Atoms are far apart, randomly spread in a container.</p>
      <div class="particle-box">
        <!-- Randomly placed helium atoms -->
        <div class="atom helium" style="top:10px; left:10px;"></div>
        <div class="atom helium" style="top:50px; left:60px;"></div>
        <div class="atom helium" style="top:30px; left:120px;"></div>
        <div class="atom helium" style="top:80px; left:90px;"></div>
        <div class="atom helium" style="top:20px; left:160px;"></div>
      </div>

      <!-- Gaseous Diatomic Molecular Element (O2) -->
      <h3>Gaseous Diatomic Molecular Element (O₂)</h3>
      <p>Pairs of identical atoms, still randomly spread in a gas.</p>
      <div class="particle-box">
        <div class="molecule" style="top:10px; left:20px;">
          <div class="atom oxygen" style="top:0; left:0;"></div>
          <div class="atom oxygen"></div>
        </div>
        <div class="molecule" style="top:40px; left:80px;">
          <div class="atom oxygen"></div>
          <div class="atom oxygen"></div>
        </div>
        <div class="molecule" style="top:70px; left:140px;">
          <div class="atom oxygen"></div>
          <div class="atom oxygen"></div>
        </div>
        <div class="molecule" style="top:20px; left:110px;">
          <div class="atom oxygen"></div>
          <div class="atom oxygen"></div>
        </div>
      </div>

      <!-- Gaseous Compound (CO2) --> 
      <h3>Gaseous Compound (CO₂)</h3>
      <p>Each molecule has different atoms bonded: blue–brown–blue (O–C–O), spread out in gas.</p>
      <div class="particle-box">
        <div class="molecule" style="top:10px; left:20px;">
          <div class="atom oxygen" style="top:0; left:0;"></div>
          <div class="atom carbon"></div>
          <div class="atom oxygen"></div>
        </div>
        <div class="molecule" style="top:50px; left:60px;">
          <div class="atom oxygen" style="top:0; left:0;"></div>
          <div class="atom carbon"></div>
          <div class="atom oxygen"></div>
        </div>
      </div>
    </div>
    
    <div class="practice-question">
      <p><strong>Question 1:</strong> What does this diagram represent?</p>
      <p>[Helium gas diagram above]</p>
      <select id="s5q1">
        <option value="">--Select--</option>
        <option value="Element">Element</option>
        <option value="Compound">Compound</option>
        <option value="Mixture">Mixture</option>
      </select>
      <span id="s5q1-feedback" class="feedback"></span>
    </div>
    
    <div class="practice-question">
      <p><strong>Question 2:</strong> What does this diagram represent?</p>
      <p>[Oxygen gas (O₂) diagram above]</p>
      <select id="s5q2">
        <option value="">--Select--</option>
        <option value="Element">Element</option>
        <option value="Compound">Compound</option>
        <option value="Mixture">Mixture</option>
      </select>
      <span id="s5q2-feedback" class="feedback"></span>
    </div>
    
    <div class="practice-question">
      <p><strong>Question 3:</strong> What does this diagram represent?</p>
      <p>[Carbon dioxide (CO₂) diagram above]</p>
      <select id="s5q3">
        <option value="">--Select--</option>
        <option value="Element">Element</option>
        <option value="Compound">Compound</option>
        <option value="Mixture">Mixture</option>
      </select>
      <span id="s5q3-feedback" class="feedback"></span>
    </div>
    
    <div class="practice-question">
      <p><strong>Question 4:</strong> What would a solid piece of copper metal look like on a particle level?</p>
      <select id="s5q4">
        <option value="">--Select--</option>
        <option value="Element">Element</option>
        <option value="Compound">Compound</option>
        <option value="Mixture">Mixture</option>
      </select>
      <span id="s5q4-feedback" class="feedback"></span>
    </div>
    
    <div class="practice-question">
      <p><strong>Question 5:</strong> What would table salt (sodium chloride) look like on a particle level?</p>
      <select id="s5q5">
        <option value="">--Select--</option>
        <option value="Element">Element</option>
        <option value="Compound">Compound</option>
        <option value="Mixture">Mixture</option>
      </select>
      <span id="s5q5-feedback" class="feedback"></span>
    </div>
    
    <div class="practice-question">
      <p><strong>Question 6:</strong> Which type of substance is made ONLY of one type of atom?</p>
      <select id="s5q6">
        <option value="">--Select--</option>
        <option value="Element">Element</option>
        <option value="Compound">Compound</option>
        <option value="Mixture">Mixture</option>
        <option value="Molecule">Molecule</option>
      </select>
      <span id="s5q6-feedback" class="feedback"></span>
    </div>
    
    <button onclick="checkScreen5()">Check Answers</button>
    <br><br>
    <button onclick="showScreen(4)">Back</button>
    <button id="next5" disabled onclick="showScreen(6)">Next</button>
  </div>
  
  <!-- Screen 6: Element Symbol Memory Game -->
  <div id="screen6" class="screen">
    <h2>6. Element Symbol Memory Game</h2>
    <p><strong>How to play:</strong> Click on cards to flip them over. Find matching pairs of element names and their symbols. Remember, an <em>element</em> is a substance that cannot be broken down into simpler substances by chemical means.</p>
    
    <div class="round-info">
      <p>Round <span id="current-round">1</span>: <span id="round-description">Common Elements</span></p>
      <p>Matches found: <span id="matches-count">0</span>/8</p>
    </div>
    
    <div class="match-game" id="memory-game">
      <!-- Cards will be added dynamically via JavaScript -->
    </div>
    
    <div class="game-controls">
      <button onclick="resetMemoryGame()">Reset Round</button>
      <button id="next-round-btn" disabled onclick="nextRound()">Next Round</button>
    </div>
    <br><br>
    <button onclick="showScreen(5)">Back</button>
    <button onclick="showScreen(12)">Next: Element Bingo</button>
  </div>
  
  <!-- Screen 7: 10-Mark Quiz -->
  <div id="screen7" class="screen">
    <h2>7. Quick Quiz (10 marks)</h2>
    <p>Answer each question and then click "Check Quiz" at the bottom. Your score will be displayed, along with correct/incorrect answers.</p>
    <ol>
      <li class="question">
        <p>1) An element is:</p>
        <select id="quiz1">
          <option value="">--Select--</option>
          <option value="A">A) A substance that can be broken down into simpler substances</option>
          <option value="B">B) A substance that cannot be broken down into simpler substances by chemical means</option>
          <option value="C">C) A mixture of different chemicals</option>
          <option value="D">D) Only found in laboratories</option>
        </select>
        <span id="quiz1Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>2) The chemical symbol for Sodium is:</p>
        <select id="quiz2">
          <option value="">--Select--</option>
          <option value="A">A) So</option>
          <option value="B">B) S</option>
          <option value="C">C) Na</option>
          <option value="D">D) N</option>
        </select>
        <span id="quiz2Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>3) Which rule about chemical symbols is correct?</p>
        <select id="quiz3">
          <option value="">--Select--</option>
          <option value="A">A) First letter is lowercase, second is uppercase</option>
          <option value="B">B) Both letters are uppercase</option>
          <option value="C">C) First letter is uppercase, second is lowercase</option>
          <option value="D">D) Both letters are lowercase</option>
        </select>
        <span id="quiz3Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>4) The symbol Fe stands for:</p>
        <select id="quiz4">
          <option value="">--Select--</option>
          <option value="A">A) Fluorine</option>
          <option value="B">B) Iron</option>
          <option value="C">C) Ferrum</option>
          <option value="D">D) Fermium</option>
        </select>
        <span id="quiz4Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>5) The chemical symbol for Gold is:</p>
        <select id="quiz5">
          <option value="">--Select--</option>
          <option value="A">A) Go</option>
          <option value="B">B) G</option>
          <option value="C">C) Gd</option>
          <option value="D">D) Au</option>
        </select>
        <span id="quiz5Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>6) Why do some elements have symbols that don't match their English names?</p>
        <select id="quiz6">
          <option value="">--Select--</option>
          <option value="A">A) They are incorrect</option>
          <option value="B">B) They are named after their discoverers</option>
          <option value="C">C) Many are derived from Latin or other language names</option>
          <option value="D">D) The symbols are randomly assigned</option>
        </select>
        <span id="quiz6Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>7) In a particle diagram, an element would be represented by:</p>
        <select id="quiz7">
          <option value="">--Select--</option>
          <option value="A">A) Different types of atoms bonded together</option>
          <option value="B">B) Identical atoms</option>
          <option value="C">C) A mixture of different substances</option>
          <option value="D">D) None of the above</option>
        </select>
        <span id="quiz7Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>8) Which of these is NOT an element?</p>
        <select id="quiz8">
          <option value="">--Select--</option>
          <option value="A">A) Water (H₂O)</option>
          <option value="B">B) Gold (Au)</option>
          <option value="C">C) Oxygen (O)</option>
          <option value="D">D) Carbon (C)</option>
        </select>
        <span id="quiz8Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>9) How many elements are there in the periodic table?</p>
        <select id="quiz9">
          <option value="">--Select--</option>
          <option value="A">A) About 50</option>
          <option value="B">B) About 90</option>
          <option value="C">C) About 118</option>
          <option value="D">D) Over 200</option>
        </select>
        <span id="quiz9Feedback" class="feedback"></span>
      </li>
      <li class="question">
        <p>10) A mixture of sand and iron filings:</p>
        <select id="quiz10">
          <option value="">--Select--</option>
          <option value="A">A) Is a compound</option>
          <option value="B">B) Is a pure element</option>
          <option value="C">C) Contains elements that can be separated physically</option>
          <option value="D">D) Can only be separated by chemical means</option>
        </select>
        <span id="quiz10Feedback" class="feedback"></span>
      </li>
    </ol>
    <button onclick="checkQuiz()">Check Quiz</button>
    <p id="quizResult"></p>
    <br>
    <button onclick="showScreen(12)">Back to Bingo</button>
    <button onclick="showScreen(8)">Next</button>
  </div>
  
  <!-- Screen 8: Extended Question -->
  <div id="screen8" class="screen">
    <h2>8. Extended Question</h2>
    <p><strong>Question:</strong> Why is it important to have a standard system of chemical symbols for elements that are used worldwide? Explain how this helps communication in science.</p>
    <textarea id="extendedAnswer" rows="6" style="width:100%;" placeholder="Type your answer here..."></textarea>
    <br>
    <button onclick="showSentenceStarter()">Sentence Starter</button>
    <button onclick="revealAnswer()">Reveal Sample Answer</button>
    <br><br>
    <p id="sampleAnswer" class="hidden" style="background-color:#fff8e1; padding:10px; border-radius:6px;"></p>
    <br>
    <button onclick="showScreen(7)">Back</button>
  </div>
  
  <!-- Screen 9: Performance Descriptor -->
  <div id="screen9" class="screen">
    <h2>Performance Descriptor</h2>
    <p id="descriptorMessage"></p>
    <button onclick="showScreen(prevScreen)">Back to Lesson</button>
  </div>
  
  <!-- Screen 12: Element Bingo Game -->
  <div id="screen12" class="screen">
    <h2>Element Bingo</h2>
    
    <div class="bingo-instructions">
      <p><strong>How to play:</strong></p>
      <ol>
        <li>Choose a game mode: Solo vs Professor Mendeleev, 2-Player, or Reverse Mode.</li>
        <li>Select 6 elements for your bingo card (in 2-Player, each player selects 6).</li>
        <li>Click "Draw" to randomly select an element from the periodic table.</li>
        <li>If you have the drawn element on your card, it will be highlighted.</li>
        <li>In standard mode: Type the element's <strong>name</strong> to claim it.</li>
        <li>In reverse mode: Type the element's <strong>symbol</strong> to claim it.</li>
        <li>Complete lines (horizontal, vertical, or diagonal) to score points.</li>
        <li>Get all six elements marked or complete more lines to win!</li>
      </ol>
      <p><strong>Remember:</strong> An element is a substance that cannot be broken down into simpler substances by chemical means.</p>
    </div>
    
    <div id="mode-selection" class="mode-selection">
      <h3>Select Game Mode:</h3>
      <div class="mode-buttons">
        <button onclick="selectMode('solo')" class="mode-btn">Solo vs Prof. Mendeleev</button>
        <button onclick="selectMode('twoPlayer')" class="mode-btn">2-Player Mode</button>
        <button onclick="selectMode('reverseAI')" class="mode-btn">Reverse Mode (Solo)</button>
        <button onclick="selectMode('reverseTwoPlayer')" class="mode-btn">Reverse Mode (2-Player)</button>
      </div>
    </div>
    
    <div id="setup-phase" style="display: none;">
      <div id="player1-setup">
        <h3>Player 1: Select 6 elements for your bingo card:</h3>
        <div class="random-select">
          <button onclick="randomSelectElements(1)" class="random-btn">Random Selection</button>
        </div>
        <div id="element-selector" class="bingo-element-selector">
          <!-- Element options will be generated here -->
        </div>
      </div>
      
      <div id="player2-setup" style="display: none;">
        <h3>Player 2: Select 6 elements for your bingo card:</h3>
        <div class="random-select">
          <button onclick="randomSelectElements(2)" class="random-btn">Random Selection</button>
        </div>
        <div id="element-selector2" class="bingo-element-selector">
          <!-- Element options for player 2 will be generated here -->
        </div>
      </div>
      
      <div class="bingo-controls">
        <button onclick="startBingoGame()" id="start-bingo-btn" disabled>Start Game</button>
      </div>
    </div>
    
    <div id="game-phase" class="hidden">
      <div class="bingo-game-state">
        <div class="score-display">
          <p><span id="player1-label">Player 1</span> score: <span id="player1-score">0</span></p>
        </div>
        <div class="score-display">
          <p><span id="player2-label">Prof. Mendeleev</span> score: <span id="player2-score">0</span></p>
        </div>
      </div>
      
      <div class="bingo-container">
        <div class="bingo-card">
          <div class="bingo-title"><span id="card1-title">Player 1's Card</span></div>
          <div id="player1-card" class="bingo-grid">
            <!-- Player 1's bingo cells will be generated here -->
          </div>
        </div>
        
        <div class="bingo-card">
          <div class="bingo-title"><span id="card2-title">Prof. Mendeleev's Card</span></div>
          <div id="player2-card" class="bingo-grid">
            <!-- Player 2's or AI's bingo cells will be generated here -->
          </div>
        </div>
      </div>
      
      <div class="bingo-result">
        <div>
          <div class="draw-result" id="draw-result">?</div>
          <div class="bingo-controls">
            <button onclick="drawElement()" id="draw-btn">Draw Element</button>
          </div>
        </div>
        
        <div class="claim-form" id="claim-form" style="display: none;">
          <p id="claim-prompt">Name this element to claim it:</p>
          <input type="text" id="element-input" placeholder="Enter element name">
          <button onclick="claimElement()">Claim</button>
          <div id="claim-feedback" class="feedback"></div>
        </div>
      </div>
      
      <div id="bingo-message" class="bingo-message"></div>
      
      <div class="bingo-controls">
        <button onclick="resetBingoGame()">New Game</button>
      </div>
    </div>
    
    <br><br>
    <button onclick="showScreen(6)">Back to Memory Game</button>
    <button onclick="showScreen(7)">Next: Quiz</button>
  </div>
</div>

<script>
  // Track progress to determine performance descriptor
  var understandingElementsCompleted = false;
  var elementSymbolsCompleted = false;
  var commonElementsCompleted = false;
  var elementsInWorldCompleted = false;
  var recognizingElementsCompleted = false;
  var quizCompleted = false;

  var currentScreen = 1;
  var prevScreen = 1;  // For returning from descriptor screen

  // Navigation
  function showScreen(n) {
    if(n !== 9) {
      prevScreen = n;
    }
    currentScreen = n;
    for (let i = 1; i <= 12; i++) {
      const screenElem = document.getElementById("screen" + i);
      if(screenElem) {
        screenElem.classList.remove("active");
      }
    }
    document.getElementById("screen" + n).classList.add("active");
    
    // Initialize games if showing relevant screen
    if (n === 6) {
      initMemoryGame();
    } else if (n === 12) {
      setupBingoGame();
    }
  }

  /* --- Toggle Help --- */
  function toggleHelp(id) {
    const helpElem = document.getElementById(id);
    helpElem.classList.toggle('hidden');
  }

  /* --- Screen 1 Checks --- */
  function checkScreen1() {
    let q1a = document.getElementById("q1a").value;
    if(q1a === "A substance that cannot be broken down into simpler substances by chemical means") {
      document.getElementById("feedback1a").innerText = "Correct! That's the definition of an element.";
      document.getElementById("next1").disabled = false;
      understandingElementsCompleted = true;
    } else {
      document.getElementById("feedback1a").innerText = "Try again. Remember, an element is a fundamental substance that cannot be broken down further by chemical means.";
    }
  }

  /* --- Screen 2 Checks --- */
  function checkScreen2() {
    let correct = true;
    
    let q2a = document.getElementById("q2a").value;
    if(q2a === "O") {
      document.getElementById("feedback2a").innerText = "Correct!";
    } else {
      document.getElementById("feedback2a").innerText = "Incorrect. Oxygen is represented by 'O' (capital O).";
      correct = false;
    }
    
    let q2b = document.getElementById("q2b").value;
    if(q2b === "C") {
      document.getElementById("feedback2b").innerText = "Correct!";
    } else {
      document.getElementById("feedback2b").innerText = "Incorrect. Carbon is represented by 'C' (capital C).";
      correct = false;
    }
    
    let q2c = document.getElementById("q2c").value;
    if(q2c === "He") {
      document.getElementById("feedback2c").innerText = "Correct!";
    } else {
      document.getElementById("feedback2c").innerText = "Incorrect. Helium is represented by 'He' (capital H, lowercase e).";
      correct = false;
    }
    
    if(correct) {
      document.getElementById("next2").disabled = false;
      elementSymbolsCompleted = true;
    }
  }

  /* --- Screen 3: Element Matching --- */
  function checkS3Matching() {
    let correct = true;
    let feedback = "";
    
    if(document.getElementById("s3q1").value.toUpperCase() !== "H") {
      feedback += "Hydrogen is H. ";
      correct = false;
    }
    
    if(document.getElementById("s3q2").value.toUpperCase() !== "C") {
      feedback += "Carbon is C. ";
      correct = false;
    }
    
    if(document.getElementById("s3q3").value.toUpperCase() !== "NA") {
      feedback += "Sodium is Na. ";
      correct = false;
    }
    
    if(document.getElementById("s3q4").value.toUpperCase() !== "AU") {
      feedback += "Gold is Au. ";
      correct = false;
    }
    
    if(document.getElementById("s3q5").value.toUpperCase() !== "FE") {
      feedback += "Iron is Fe. ";
      correct = false;
    }
    
    if(correct) {
      document.getElementById("s3feedback").innerText = "All correct! Well done.";
      document.getElementById("next3").disabled = false;
      commonElementsCompleted = true;
    } else {
      document.getElementById("s3feedback").innerText = feedback + "Please try again.";
    }
  }

  /* --- Screen 4 Checks --- */
  function checkScreen4() {
    let q4a = document.getElementById("q4a").value;
    if(q4a === "Most elements in nature exist as compounds or mixtures") {
      document.getElementById("feedback4a").innerText = "Correct! Most elements in nature are found in compounds or mixtures, not in their pure form.";
      document.getElementById("next4").disabled = false;
      elementsInWorldCompleted = true;
    } else {
      document.getElementById("feedback4a").innerText = "Incorrect. Try again. Think about how elements typically exist in the natural world.";
    }
  }

  /* --- Screen 5: Particle Diagrams --- */
  function checkScreen5() {
    let correct = true;
    
    let s5q1 = document.getElementById("s5q1").value;
    if(s5q1 === "Element") {
      document.getElementById("s5q1-feedback").innerText = "Correct! These are identical atoms (helium), which represents an element.";
    } else {
      document.getElementById("s5q1-feedback").innerText = "Incorrect. These are identical atoms (helium), which represents an element.";
      correct = false;
    }
    
    let s5q2 = document.getElementById("s5q2").value;
    if(s5q2 === "Element") {
      document.getElementById("s5q2-feedback").innerText = "Correct! These are identical diatomic molecules (O₂), which still represents an element.";
    } else {
      document.getElementById("s5q2-feedback").innerText = "Incorrect. These are identical diatomic molecules (O₂), which still represents an element.";
      correct = false;
    }
    
    let s5q3 = document.getElementById("s5q3").value;
    if(s5q3 === "Compound") {
      document.getElementById("s5q3-feedback").innerText = "Correct! These molecules contain different atoms (carbon and oxygen) bonded together, representing a compound (CO₂).";
    } else {
      document.getElementById("s5q3-feedback").innerText = "Incorrect. These molecules contain different atoms (carbon and oxygen) bonded together, representing a compound (CO₂).";
      correct = false;
    }
    
    let s5q4 = document.getElementById("s5q4").value;
    if(s5q4 === "Element") {
      document.getElementById("s5q4-feedback").innerText = "Correct! This shows identical atoms arranged in a solid lattice, representing an element (copper).";
    } else {
      document.getElementById("s5q4-feedback").innerText = "Incorrect. This shows identical atoms arranged in a solid lattice, representing an element (copper).";
      correct = false;
    }
    
    let s5q5 = document.getElementById("s5q5").value;
    if(s5q5 === "Compound") {
      document.getElementById("s5q5-feedback").innerText = "Correct! This shows different atoms arranged in an alternating pattern, representing an ionic compound (sodium chloride).";
    } else {
      document.getElementById("s5q5-feedback").innerText = "Incorrect. This shows different atoms arranged in an alternating pattern, representing an ionic compound (sodium chloride).";
      correct = false;
    }
    
    let s5q6 = document.getElementById("s5q6").value;
    if(s5q6 === "Element") {
      document.getElementById("s5q6-feedback").innerText = "Correct! Elements are made of only one type of atom.";
    } else {
      document.getElementById("s5q6-feedback").innerText = "Incorrect. Elements are made of only one type of atom.";
      correct = false;
    }
    
    if(correct) {
      document.getElementById("next5").disabled = false;
      recognizingElementsCompleted = true;
    }
  }

  /* --- Memory Game --- */
  // Round 1: Common, easy elements
  let round1Cards = [
    {id: 1, content: "H", pair: 2, flipped: false},
    {id: 2, content: "Hydrogen", pair: 1, flipped: false},
    {id: 3, content: "O", pair: 4, flipped: false},
    {id: 4, content: "Oxygen", pair: 3, flipped: false},
    {id: 5, content: "C", pair: 6, flipped: false},
    {id: 6, content: "Carbon", pair: 5, flipped: false},
    {id: 7, content: "N", pair: 8, flipped: false},
    {id: 8, content: "Nitrogen", pair: 7, flipped: false},
    {id: 9, content: "S", pair: 10, flipped: false},
    {id: 10, content: "Sulfur", pair: 9, flipped: false},
    {id: 11, content: "He", pair: 12, flipped: false},
    {id: 12, content: "Helium", pair: 11, flipped: false},
    {id: 13, content: "Cl", pair: 14, flipped: false},
    {id: 14, content: "Chlorine", pair: 13, flipped: false},
    {id: 15, content: "Ca", pair: 16, flipped: false},
    {id: 16, content: "Calcium", pair: 15, flipped: false}
  ];

  // Round 2: More challenging elements
  let round2Cards = [
    {id: 1, content: "Mg", pair: 2, flipped: false},
    {id: 2, content: "Magnesium", pair: 1, flipped: false},
    {id: 3, content: "Al", pair: 4, flipped: false},
    {id: 4, content: "Aluminum", pair: 3, flipped: false},
    {id: 5, content: "Si", pair: 6, flipped: false},
    {id: 6, content: "Silicon", pair: 5, flipped: false},
    {id: 7, content: "P", pair: 8, flipped: false},
    {id: 8, content: "Phosphorus", pair: 7, flipped: false},
    {id: 9, content: "K", pair: 10, flipped: false},
    {id: 10, content: "Potassium", pair: 9, flipped: false},
    {id: 11, content: "Zn", pair: 12, flipped: false},
    {id: 12, content: "Zinc", pair: 11, flipped: false},
    {id: 13, content: "Br", pair: 14, flipped: false},
    {id: 14, content: "Bromine", pair: 13, flipped: false},
    {id: 15, content: "I", pair: 16, flipped: false},
    {id: 16, content: "Iodine", pair: 15, flipped: false}
  ];

  // Round 3: Elements with non-intuitive symbols (Latin names)
  let round3Cards = [
    {id: 1, content: "Na", pair: 2, flipped: false},
    {id: 2, content: "Sodium", pair: 1, flipped: false},
    {id: 3, content: "Fe", pair: 4, flipped: false},
    {id: 4, content: "Iron", pair: 3, flipped: false},
    {id: 5, content: "Cu", pair: 6, flipped: false},
    {id: 6, content: "Copper", pair: 5, flipped: false},
    {id: 7, content: "Ag", pair: 8, flipped: false},
    {id: 8, content: "Silver", pair: 7, flipped: false},
    {id: 9, content: "Au", pair: 10, flipped: false},
    {id: 10, content: "Gold", pair: 9, flipped: false},
    {id: 11, content: "Hg", pair: 12, flipped: false},
    {id: 12, content: "Mercury", pair: 11, flipped: false},
    {id: 13, content: "Pb", pair: 14, flipped: false},
    {id: 14, content: "Lead", pair: 13, flipped: false},
    {id: 15, content: "Sn", pair: 16, flipped: false},
    {id: 16, content: "Tin", pair: 15, flipped: false}
  ];

  let roundDescriptions = [
    "Common Elements",
    "More Challenging Elements",
    "Elements with Latin-Based Symbols"
  ];

  let memoryCards = round1Cards;
  let currentRound = 1;
  let firstCard = null;
  let secondCard = null;
  let canFlip = true;
  let matchesFound = 0;
  
  function initMemoryGame() {
    // Reset game state
    memoryCards = shuffleCards(currentRound === 1 ? round1Cards : (currentRound === 2 ? round2Cards : round3Cards));
    firstCard = null;
    secondCard = null;
    canFlip = true;
    matchesFound = 0;
    
    // Update UI
    document.getElementById("current-round").textContent = currentRound;
    document.getElementById("round-description").textContent = roundDescriptions[currentRound - 1];
    document.getElementById("matches-count").textContent = "0";
    document.getElementById("next-round-btn").disabled = true;
    
    // Create cards
    const gameContainer = document.getElementById("memory-game");
    gameContainer.innerHTML = "";
    
    memoryCards.forEach(card => {
      card.flipped = false;
      const cardElement = document.createElement("div");
      cardElement.className = "match-card";
      cardElement.dataset.id = card.id;
      cardElement.addEventListener("click", () => flipCard(cardElement, card));
      gameContainer.appendChild(cardElement);
    });
  }
  
  function shuffleCards(cards) {
    // Create a copy to avoid modifying the original
    const cardsCopy = JSON.parse(JSON.stringify(cards));
    
    // Fisher-Yates shuffle
    for (let i = cardsCopy.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [cardsCopy[i], cardsCopy[j]] = [cardsCopy[j], cardsCopy[i]];
    }
    
    return cardsCopy;
  }
  
  function flipCard(element, card) {
    // Return if can't flip or already flipped
    if (!canFlip || card.flipped) return;
    
    // Flip the card
    card.flipped = true;
    element.classList.add("flipped");
    element.textContent = card.content;
    
    // Handle first and second card flips
    if (!firstCard) {
      firstCard = { element, card };
    } else {
      secondCard = { element, card };
      checkForMatch();
    }
  }
  
  function checkForMatch() {
    canFlip = false;
    
    if (firstCard.card.pair === secondCard.card.id) {
      // It's a match
      matchesFound++;
      document.getElementById("matches-count").textContent = matchesFound + "/8";
      
      // Reset selected cards
      setTimeout(() => {
        firstCard = null;
        secondCard = null;
        canFlip = true;
        
        // Check if round is complete
        if (matchesFound === 8) {
          if (currentRound < 3) {
            document.getElementById("next-round-btn").disabled = false;
          }
        }
      }, 500);
    } else {
      // Not a match, flip back
      setTimeout(() => {
        firstCard.card.flipped = false;
        secondCard.card.flipped = false;
        firstCard.element.classList.remove("flipped");
        secondCard.element.classList.remove("flipped");
        firstCard.element.textContent = "";
        secondCard.element.textContent = "";
        
        // Reset selected cards
        firstCard = null;
        secondCard = null;
        canFlip = true;
      }, 1000);
    }
  }
  
  function resetMemoryGame() {
    initMemoryGame();
  }
  
  function nextRound() {
    if (currentRound < 3) {
      currentRound++;
      initMemoryGame();
    }
  }

  /* --- Quiz --- */
  function checkQuiz() {
    let score = 0;
    let feedback = "";
    
    // Check answers and provide feedback
    const answers = {
      "quiz1": "B",
      "quiz2": "C",
      "quiz3": "C",
      "quiz4": "B",
      "quiz5": "D",
      "quiz6": "C",
      "quiz7": "B",
      "quiz8": "A",
      "quiz9": "C",
      "quiz10": "C"
    };
    
    for (const question in answers) {
      const userAnswer = document.getElementById(question).value;
      const feedbackElement = document.getElementById(question + "Feedback");
      
      if (userAnswer === answers[question]) {
        feedbackElement.innerText = "✓ Correct!";
        feedbackElement.style.color = "#4CAF50";
        score++;
      } else {
        feedbackElement.innerText = "✕ Incorrect. The correct answer is " + answers[question] + ".";
        feedbackElement.style.color = "#d32f2f";
      }
    }
    
    // Display final score
    document.getElementById("quizResult").innerHTML = `Your score: ${score}/10<br>`;
    if (score === 10) {
      document.getElementById("quizResult").innerHTML += "Excellent! Perfect score!";
    } else if (score >= 8) {
      document.getElementById("quizResult").innerHTML += "Very good! You have a strong understanding of elements.";
    } else if (score >= 6) {
      document.getElementById("quizResult").innerHTML += "Good job! You understand the basics, but could review some concepts.";
    } else {
      document.getElementById("quizResult").innerHTML += "You might want to review the material and try again.";
    }
    
    quizCompleted = true;
  }

  /* --- Extended Question --- */
  function showSentenceStarter() {
    document.getElementById("extendedAnswer").value = "A standardized system of chemical symbols for elements is important because...";
    document.getElementById("extendedAnswer").focus();
  }
  
  function revealAnswer() {
    const sampleAnswer = `A standardized system of chemical symbols for elements is important because it enables clear and universal communication in science regardless of language barriers. Here's how it helps:

1. Universal language: Scientists from different countries who speak different languages can use the same symbols (like H for hydrogen) and understand each other's work without translation.

2. Clarity and precision: Chemical symbols provide a clear, concise way to represent elements in equations and formulas, avoiding ambiguity and misinterpretation.

3. Efficiency: Writing "Na" is much quicker than writing "sodium" every time, especially in complex chemical equations.

4. Consistency in education: Students worldwide learn the same symbols, creating consistency in how chemistry is taught and understood globally.

5. Scientific publications: Journals and research papers use these standardized symbols so findings can be shared and understood internationally.

Without this standardization, scientific progress would be significantly hindered by communication barriers, making collaboration difficult and potentially leading to dangerous misunderstandings in fields like medicine, industry, and research.`;
    
    document.getElementById("sampleAnswer").innerHTML = sampleAnswer;
    document.getElementById("sampleAnswer").classList.remove("hidden");
  }

  /* --- Performance Descriptor --- */
  function showPerformanceDescriptor() {
    let completedSections = 0;
    let descriptor = "";
    
    if (understandingElementsCompleted) completedSections++;
    if (elementSymbolsCompleted) completedSections++;
    if (commonElementsCompleted) completedSections++;
    if (elementsInWorldCompleted) completedSections++;
    if (recognizingElementsCompleted) completedSections++;
    if (quizCompleted) completedSections++;
    
    if (completedSections === 6) {
      descriptor = "Outstanding! You've mastered all the content about elements.";
    } else if (completedSections >= 4) {
      descriptor = "Good progress! You're building a solid understanding of elements.";
    } else if (completedSections >= 2) {
      descriptor = "Getting started! Continue exploring to improve your understanding.";
    } else {
      descriptor = "Just beginning. Keep working through the activities!";
    }
    
    document.getElementById("descriptorMessage").innerText = descriptor;
    showScreen(9);
  }
  
  /* --- Bingo Game --- */
  const bingoElements = [
    {symbol: "H", name: "Hydrogen"},
    {symbol: "He", name: "Helium"},
    {symbol: "Li", name: "Lithium"},
    {symbol: "C", name: "Carbon"},
    {symbol: "N", name: "Nitrogen"},
    {symbol: "O", name: "Oxygen"},
    {symbol: "F", name: "Fluorine"},
    {symbol: "Ne", name: "Neon"},
    {symbol: "Na", name: "Sodium"},
    {symbol: "Mg", name: "Magnesium"},
    {symbol: "Al", name: "Aluminum"},
    {symbol: "Si", name: "Silicon"},
    {symbol: "P", name: "Phosphorus"},
    {symbol: "S", name: "Sulfur"},
    {symbol: "Cl", name: "Chlorine"},
    {symbol: "K", name: "Potassium"},
    {symbol: "Ca", name: "Calcium"},
    {symbol: "Fe", name: "Iron"},
    {symbol: "Cu", name: "Copper"},
    {symbol: "Zn", name: "Zinc"},
    {symbol: "Br", name: "Bromine"},
    {symbol: "Ag", name: "Silver"},
    {symbol: "I", name: "Iodine"},
    {symbol: "Au", name: "Gold"},
    {symbol: "Hg", name: "Mercury"},
    {symbol: "Pb", name: "Lead"},
    {symbol: "Sn", name: "Tin"}
  ];
  
  // Game mode variables
  let gameMode = "solo"; // "solo", "twoPlayer", or "reverse"
  let currentPlayer = 1; // For 2-player mode
  
  // Game state variables
  let player1Elements = [];
  let player2Elements = [];
  let drawnElements = [];
  let currentDrawnElement = null;
  let player1Score = 0;
  let player2Score = 0;
  let player1SelectedCount = 0;
  let player2SelectedCount = 0;
  let player1MarkedCells = [];
  let player2MarkedCells = [];
  let player1CompletedLines = [];
  let player2CompletedLines = [];
  
  function selectMode(mode) {
    gameMode = mode;
    
    // Show the appropriate elements for the selected mode
    document.getElementById("mode-selection").style.display = "none";
    document.getElementById("setup-phase").style.display = "block";
    
    // Check if this is a two-player mode
    const isTwoPlayer = mode === "twoPlayer" || mode === "reverseTwoPlayer";
    
    // Check if this is a reverse mode
    const isReverse = mode === "reverseAI" || mode === "reverseTwoPlayer";
    
    if (isTwoPlayer) {
      document.getElementById("player1-setup").style.display = "block";
      document.getElementById("player2-setup").style.display = "none"; // Will show after player 1 finishes
    } else {
      document.getElementById("player1-setup").style.display = "block";
      document.getElementById("player2-setup").style.display = "none";
    }
    
    // Update element display based on mode
    const displayProperty = isReverse ? "name" : "symbol";
    
    // Setup element selectors for proper mode
    setupElementSelector("element-selector", displayProperty, 1);
    
    // For two-player mode, we'll set up player 2's selector after player 1 has chosen
    // This will be done in the selectElementPlayer1 function when player1 has selected 6 elements
  }
  
  function setupElementSelector(selectId, displayProperty, playerNum, excludedElements = []) {
    const elementSelector = document.getElementById(selectId);
    elementSelector.innerHTML = '';
    
    bingoElements.forEach((element, index) => {
      // Skip this element if it's in the excluded list (for player 2 in two-player mode)
      if (excludedElements.some(excluded => excluded.symbol === element.symbol)) {
        return;
      }
      
      const option = document.createElement("div");
      option.className = "element-option";
      option.dataset.index = index;
      
      if (displayProperty === "symbol") {
        option.innerHTML = `<strong>${element.symbol}</strong><br>${element.name}`;
      } else {
        option.innerHTML = `<strong>${element.name}</strong><br>${element.symbol}`;
      }
      
      option.addEventListener("click", () => {
        if (playerNum === 1) {
          selectElementPlayer1(option, index);
        } else {
          selectElementPlayer2(option, index);
        }
      });
      
      elementSelector.appendChild(option);
    });
  }
  
  function setupBingoGame() {
    // Reset game state
    player1Elements = [];
    player2Elements = [];
    drawnElements = [];
    currentDrawnElement = null;
    player1Score = 0;
    player2Score = 0;
    player1SelectedCount = 0;
    player2SelectedCount = 0;
    player1MarkedCells = [];
    player2MarkedCells = [];
    player1CompletedLines = [];
    player2CompletedLines = [];
    
    // Show mode selection first
    document.getElementById("mode-selection").style.display = "block";
    document.getElementById("setup-phase").style.display = "none";
    document.getElementById("game-phase").style.display = "none";
    document.getElementById("start-bingo-btn").disabled = true;
    
    // Reset any specific elements for different modes
    document.getElementById("player1-label").textContent = "Player 1";
    document.getElementById("player2-label").textContent = "Prof. Mendeleev";
    document.getElementById("card1-title").textContent = "Player 1's Card";
    document.getElementById("card2-title").textContent = "Prof. Mendeleev's Card";
    
    // Clear any existing selections
    const options = document.querySelectorAll(".element-option");
    options.forEach(option => option.classList.remove("selected"));
  }
  
  function selectElementPlayer1(option, index) {
    if (player1SelectedCount < 6 && !option.classList.contains("selected")) {
      // Select this element
      option.classList.add("selected");
      player1Elements.push(bingoElements[index]);
      player1SelectedCount++;
    } else if (option.classList.contains("selected")) {
      // Deselect this element
      option.classList.remove("selected");
      player1Elements = player1Elements.filter(el => el.symbol !== bingoElements[index].symbol);
      player1SelectedCount--;
    }
    
    // In two-player mode, move to player 2 selection when player 1 is done
    const isTwoPlayer = gameMode === "twoPlayer" || gameMode === "reverseTwoPlayer";
    const isReverse = gameMode === "reverseAI" || gameMode === "reverseTwoPlayer";
    
    if (isTwoPlayer && player1SelectedCount === 6) {
      document.getElementById("player1-setup").style.display = "none";
      document.getElementById("player2-setup").style.display = "block";
      document.getElementById("start-bingo-btn").disabled = true;
      
      // Set up player 2's selector with player 1's elements excluded
      const displayProperty = isReverse ? "name" : "symbol";
      setupElementSelector("element-selector2", displayProperty, 2, player1Elements);
    } else {
      // Enable/disable start button based on selection count
      document.getElementById("start-bingo-btn").disabled = player1SelectedCount !== 6;
    }
  }

  function selectElementPlayer2(option, index) {
    if (player2SelectedCount < 6 && !option.classList.contains("selected")) {
      // Select this element
      option.classList.add("selected");
      player2Elements.push(bingoElements[index]);
      player2SelectedCount++;
    } else if (option.classList.contains("selected")) {
      // Deselect this element
      option.classList.remove("selected");
      player2Elements = player2Elements.filter(el => el.symbol !== bingoElements[index].symbol);
      player2SelectedCount--;
    }
    
    // Enable/disable start button based on selection count
    document.getElementById("start-bingo-btn").disabled = player2SelectedCount !== 6;
  }
  
  function startBingoGame() {
    // Hide setup phase, show game phase
    document.getElementById("setup-phase").style.display = "none";
    document.getElementById("game-phase").style.display = "block";
    
    // Initialize scores
    document.getElementById("player1-score").textContent = player1Score;
    document.getElementById("player2-score").textContent = player2Score;
    
    // Clear message
    document.getElementById("bingo-message").textContent = "";
    
    // Check if this is a solo mode
    const isSolo = gameMode === "solo" || gameMode === "reverseAI";
    
    // Check if this is a reverse mode
    const isReverse = gameMode === "reverseAI" || gameMode === "reverseTwoPlayer";
    
    // In solo mode, generate AI opponent's elements
    if (isSolo) {
      // Create a list of elements that aren't selected by player 1
      const availableElements = bingoElements.filter(element => 
        !player1Elements.some(playerEl => playerEl.symbol === element.symbol)
      );
      
      // Randomly select 6 elements for the AI
      shuffleArray(availableElements);
      player2Elements = availableElements.slice(0, 6);
    }
    
    // Update player labels and claim prompt based on game mode
    if (gameMode === "twoPlayer" || gameMode === "reverseTwoPlayer") {
      document.getElementById("player1-label").textContent = "Player 1";
      document.getElementById("player2-label").textContent = "Player 2";
      document.getElementById("card1-title").textContent = "Player 1's Card";
      document.getElementById("card2-title").textContent = "Player 2's Card";
      
      // Update claim prompt and placeholder based on reverse mode or not
      if (isReverse) {
        document.getElementById("claim-prompt").textContent = "Enter the element's symbol to claim it:";
        document.getElementById("element-input").placeholder = "Enter element symbol";
      } else {
        document.getElementById("claim-prompt").textContent = "Name this element to claim it:";
        document.getElementById("element-input").placeholder = "Enter element name";
      }
    } else {
      document.getElementById("player1-label").textContent = "You";
      document.getElementById("player2-label").textContent = "Prof. Mendeleev";
      document.getElementById("card1-title").textContent = "Your Card";
      document.getElementById("card2-title").textContent = "Prof. Mendeleev's Card";
      
      if (isReverse) {
        document.getElementById("claim-prompt").textContent = "Enter the element's symbol to claim it:";
        document.getElementById("element-input").placeholder = "Enter element symbol";
      } else {
        document.getElementById("claim-prompt").textContent = "Name this element to claim it:";
        document.getElementById("element-input").placeholder = "Enter element name";
      }
    }
    
    // Generate player 1's bingo card
    generatePlayerCard("player1-card", player1Elements, isReverse ? "name" : "symbol");
    
    // Generate player 2's or AI's bingo card
    generatePlayerCard("player2-card", player2Elements, isReverse ? "name" : "symbol");
    
    // Reset draw result
    document.getElementById("draw-result").textContent = "?";
    
    // Hide claim form
    document.getElementById("claim-form").style.display = "none";
    
    // Reset drawn elements
    drawnElements = [];
    
    // Enable draw button
    document.getElementById("draw-btn").disabled = false;
  }
  
  function generatePlayerCard(cardId, elements, displayProperty) {
    const card = document.getElementById(cardId);
    card.innerHTML = '';
    
    // Adjust font size based on display property
    const fontSize = displayProperty === "name" ? "1.2em" : "1.5em";
    
    elements.forEach((element, index) => {
      const cell = document.createElement("div");
      cell.className = "bingo-cell";
      cell.dataset.index = index;
      cell.dataset.symbol = element.symbol;
      cell.dataset.name = element.name;
      cell.textContent = element[displayProperty];
      cell.style.fontSize = fontSize;
      card.appendChild(cell);
    });
  }
  
  function drawElement() {
    // Filter out already drawn elements
    const availableElements = bingoElements.filter(element => 
      !drawnElements.some(drawn => drawn.symbol === element.symbol)
    );
    
    // Check if there are elements left to draw
    if (availableElements.length === 0) {
      document.getElementById("bingo-message").textContent = "No more elements to draw!";
      document.getElementById("draw-btn").disabled = true;
      
      // Declare the winner based on scores
      declareWinner();
      return;
    }
    
    // Reset any previously highlighted cells
    const cells = document.querySelectorAll(".bingo-cell.highlighted");
    cells.forEach(cell => cell.classList.remove("highlighted"));
    
    // Hide claim form and clear feedback
    document.getElementById("claim-form").style.display = "none";
    document.getElementById("claim-feedback").textContent = "";
    document.getElementById("element-input").value = "";
    
    // Randomly select an element from all available elements
    const randomIndex = Math.floor(Math.random() * availableElements.length);
    currentDrawnElement = availableElements[randomIndex];
    
    // Add to drawn elements
    drawnElements.push(currentDrawnElement);
    
    // Check if this is a reverse mode
    const isReverse = gameMode === "reverseAI" || gameMode === "reverseTwoPlayer";
    
    // Display drawn element symbol or name based on mode
    document.getElementById("draw-result").textContent = isReverse ? 
      currentDrawnElement.name : currentDrawnElement.symbol;
    
    // Check if player 1 has this element on their card
    const player1HasElement = player1Elements.some(el => el.symbol === currentDrawnElement.symbol);
    
    // Check if player 2 has this element on their card
    const player2HasElement = player2Elements.some(el => el.symbol === currentDrawnElement.symbol);
    
    // Check if this is a two-player mode
    const isTwoPlayer = gameMode === "twoPlayer" || gameMode === "reverseTwoPlayer";
    
    // Update message
    let message = "";
    if (player1HasElement && player2HasElement) {
      message = "Both players have this element!";
    } else if (player1HasElement) {
      message = isTwoPlayer 
        ? "Player 1 has this element! " + (isReverse ? "Enter the symbol" : "Name it") + " to claim." 
        : "You have this element! " + (isReverse ? "Enter the symbol" : "Name it") + " to claim.";
    } else if (player2HasElement) {
      message = isTwoPlayer 
        ? "Player 2 has this element! " + (isReverse ? "Enter the symbol" : "Name it") + " to claim."
        : "Prof. Mendeleev has this element!";
    } else {
      message = "Neither player has this element.";
    }
    document.getElementById("bingo-message").textContent = message;
    
    // Highlight matching cells on player 1's card
    if (player1HasElement) {
      const playerCells = document.querySelectorAll("#player1-card .bingo-cell");
      playerCells.forEach(cell => {
        if (cell.dataset.symbol === currentDrawnElement.symbol) {
          cell.classList.add("highlighted");
          
          // Show claim form for human players
          if (!isTwoPlayer || currentPlayer === 1) {
            document.getElementById("claim-form").style.display = "block";
          }
        }
      });
      
      // Set current player for 2-player mode
      if (isTwoPlayer) {
        currentPlayer = 1;
      }
    }
    
    // Highlight matching cells on player 2's card
    if (player2HasElement) {
      const playerCells = document.querySelectorAll("#player2-card .bingo-cell");
      playerCells.forEach(cell => {
        if (cell.dataset.symbol === currentDrawnElement.symbol) {
          cell.classList.add("highlighted");
          
          // Show claim form for player 2 in 2-player mode
          if (isTwoPlayer) {
            if (!player1HasElement) { // Only if player 1 doesn't also have it
              currentPlayer = 2;
              document.getElementById("claim-form").style.display = "block";
            }
          } else {
            // Automatically mark AI's cell after a delay
            setTimeout(() => {
              markAICell(cell);
            }, 1500);
          }
        }
      });
    }
    
    // Always ensure the claim form is showing when the player needs to claim
    if ((player1HasElement && (!isTwoPlayer || currentPlayer === 1)) ||
        (player2HasElement && isTwoPlayer && currentPlayer === 2)) {
      document.getElementById("claim-form").style.display = "block";
    }
  }
  
  function claimElement() {
    const elementInput = document.getElementById("element-input");
    const enteredValue = elementInput.value.trim();
    let isCorrect = false;
    
    // Check if this is a reverse mode
    const isReverse = gameMode === "reverseAI" || gameMode === "reverseTwoPlayer";
    
    // Determine which value to check based on game mode
    if (isReverse) {
      // In reverse mode, check if symbol is correct (case insensitive but preserve capitalization)
      const correctSymbol = currentDrawnElement.symbol;
      // Create a copy that ignores case to check if the input is the symbol (regardless of case)
      const lowerEnteredValue = enteredValue.toLowerCase();
      const lowerSymbol = correctSymbol.toLowerCase();
      
      isCorrect = lowerEnteredValue === lowerSymbol;
      
      // Add more detailed feedback for reverse mode
      if (!isCorrect) {
        document.getElementById("claim-feedback").textContent = `Incorrect. Remember that element symbols follow specific capitalization rules. Try again.`;
      }
    } else {
      // In standard mode, check if name is correct (case insensitive)
      const lowerEnteredValue = enteredValue.toLowerCase();
      const correctName = currentDrawnElement.name.toLowerCase();
      
      // Special case for Aluminum/Aluminium (UK spelling)
      if (currentDrawnElement.symbol === "Al") {
        isCorrect = lowerEnteredValue === correctName || lowerEnteredValue === "aluminium";
      } else {
        isCorrect = lowerEnteredValue === correctName;
      }
      
      // Add more detailed feedback for standard mode
      if (!isCorrect) {
        document.getElementById("claim-feedback").textContent = `Incorrect. Try again. Hint: Element name starts with "${currentDrawnElement.name.charAt(0)}".`;
      }
    }
    
    // Check if this is a two-player mode
    const isTwoPlayer = gameMode === "twoPlayer" || gameMode === "reverseTwoPlayer";
    
    if (isCorrect) {
      if (isTwoPlayer && currentPlayer === 2) {
        // Mark player 2's cell in 2-player mode
        const highlightedCells = document.querySelectorAll("#player2-card .bingo-cell.highlighted");
        highlightedCells.forEach(cell => {
          cell.classList.remove("highlighted");
          cell.classList.add("marked");
          
          // Add to player 2 marked cells
          player2MarkedCells.push(parseInt(cell.dataset.index));
          
          // Check for completed lines
          checkPlayerLines(2);
        });
      } else {
        // Mark player 1's cell
        const highlightedCells = document.querySelectorAll("#player1-card .bingo-cell.highlighted");
        highlightedCells.forEach(cell => {
          cell.classList.remove("highlighted");
          cell.classList.add("marked");
          
          // Add to player 1 marked cells
          player1MarkedCells.push(parseInt(cell.dataset.index));
          
          // Check for completed lines
          checkPlayerLines(1);
        });
      }
      
      // Hide claim form
      document.getElementById("claim-form").style.display = "none";
      document.getElementById("claim-feedback").textContent = ""; // Clear feedback
      document.getElementById("bingo-message").textContent = "Correct! Element claimed.";
    }
  }
  
  function markAICell(cell) {
    cell.classList.remove("highlighted");
    cell.classList.add("marked");
    
    // Add to AI marked cells
    player2MarkedCells.push(parseInt(cell.dataset.index));
    
    // Check for completed lines
    checkPlayerLines(2);
  }
  
  function checkPlayerLines(playerNum) {
    // Define possible lines for 3x2 grid
    const possibleLines = [
      // Horizontal lines
      [0, 1],
      [2, 3],
      [4, 5],
      // Vertical lines
      [0, 2, 4],
      [1, 3, 5]
    ];
    
    const markedCells = playerNum === 1 ? player1MarkedCells : player2MarkedCells;
    const completedLines = playerNum === 1 ? player1CompletedLines : player2CompletedLines;
    
    // Check each possible line
    possibleLines.forEach((line, lineIndex) => {
      // Skip already completed lines
      if (completedLines.includes(lineIndex)) return;
      
      const isLineComplete = line.every(cellIndex => markedCells.includes(cellIndex));
      
      if (isLineComplete) {
        // Add to completed lines
        completedLines.push(lineIndex);
        
        // Increase score
        if (playerNum === 1) {
          player1Score++;
          document.getElementById("player1-score").textContent = player1Score;
          
          // Mark cells in the completed line
          line.forEach(cellIndex => {
            const cells = document.querySelectorAll("#player1-card .bingo-cell");
            cells[cellIndex].style.backgroundColor = "#4CAF50"; // Darker green to indicate line
          });
        } else {
          player2Score++;
          document.getElementById("player2-score").textContent = player2Score;
          
          // Mark cells in the completed line
          line.forEach(cellIndex => {
            const cells = document.querySelectorAll("#player2-card .bingo-cell");
            cells[cellIndex].style.backgroundColor = "#4CAF50"; // Darker green to indicate line
          });
        }
        
        // Check for win condition (all cells marked)
        if (markedCells.length === 6) {
          declareWinner(playerNum);
          document.getElementById("draw-btn").disabled = true;
        }
      }
    });
  }
  
  function declareWinner(winningPlayer = null) {
    // Check if this is a two-player mode
    const isTwoPlayer = gameMode === "twoPlayer" || gameMode === "reverseTwoPlayer";
    
    // If all elements are drawn, declare winner based on scores
    if (winningPlayer === null) {
      if (player1Score > player2Score) {
        document.getElementById("bingo-message").textContent = isTwoPlayer 
          ? "Game over! Player 1 wins with more completed lines!" 
          : "Game over! You win against Prof. Mendeleev with more completed lines!";
      } else if (player2Score > player1Score) {
        document.getElementById("bingo-message").textContent = isTwoPlayer 
          ? "Game over! Player 2 wins with more completed lines!" 
          : "Game over! Prof. Mendeleev wins with more completed lines!";
      } else {
        document.getElementById("bingo-message").textContent = "Game over! It's a tie!";
      }
    } 
    // If a player got BINGO (all cells marked)
    else if (winningPlayer === 1) {
      document.getElementById("bingo-message").textContent = isTwoPlayer 
        ? "BINGO! Player 1 wins by marking all elements first!" 
        : "BINGO! You win against Prof. Mendeleev by marking all elements first!";
    } 
    else if (winningPlayer === 2) {
      document.getElementById("bingo-message").textContent = isTwoPlayer 
        ? "BINGO! Player 2 wins by marking all elements first!"
        : "BINGO! Prof. Mendeleev wins by marking all elements first!";
    }
    
    // Disable draw button
    document.getElementById("draw-btn").disabled = true;
  }
  
  function resetBingoGame() {
    setupBingoGame();
  }
  
  function randomSelectElements(playerNum) {
    // Clear any existing selections
    if (playerNum === 1) {
      player1Elements = [];
      player1SelectedCount = 0;
      
      // Get all element options for player 1
      const options = document.querySelectorAll("#element-selector .element-option");
      options.forEach(option => option.classList.remove("selected"));
      
      // Create array of available elements
      const availableElements = Array.from(options);
      
      // Shuffle them
      const shuffledElements = shuffleArray([...availableElements]);
      
      // Select the first 6
      for (let i = 0; i < 6 && i < shuffledElements.length; i++) {
        const element = shuffledElements[i];
        const index = parseInt(element.dataset.index);
        element.classList.add("selected");
        player1Elements.push(bingoElements[index]);
        player1SelectedCount++;
      }
      
      // Enable the start button or move to player 2 selection
      if (gameMode === "twoPlayer" || gameMode === "reverseTwoPlayer") {
        document.getElementById("player1-setup").style.display = "none";
        document.getElementById("player2-setup").style.display = "block";
        document.getElementById("start-bingo-btn").disabled = true;
        
        // Set up player 2's selector with player 1's elements excluded
        const isReverse = gameMode === "reverseAI" || gameMode === "reverseTwoPlayer";
        const displayProperty = isReverse ? "name" : "symbol";
        setupElementSelector("element-selector2", displayProperty, 2, player1Elements);
      } else {
        document.getElementById("start-bingo-btn").disabled = false;
      }
    } else {
      player2Elements = [];
      player2SelectedCount = 0;
      
      // Get all element options for player 2
      const options = document.querySelectorAll("#element-selector2 .element-option");
      options.forEach(option => option.classList.remove("selected"));
      
      // Create array of available elements
      const availableElements = Array.from(options);
      
      // Shuffle them
      const shuffledElements = shuffleArray([...availableElements]);
      
      // Select the first 6
      for (let i = 0; i < 6 && i < shuffledElements.length; i++) {
        const element = shuffledElements[i];
        const index = parseInt(element.dataset.index);
        element.classList.add("selected");
        player2Elements.push(bingoElements[index]);
        player2SelectedCount++;
      }
      
      // Enable the start button
      document.getElementById("start-bingo-btn").disabled = false;
    }
  }
  
  function shuffleArray(array) {
    // Fisher-Yates shuffle algorithm
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }
</script>
</body>
</html>
