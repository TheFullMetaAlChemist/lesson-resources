<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Year 9 Chemistry - Reactions Revision Guide</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-bg: #ecf0f1;
            --dark-bg: #34495e;
            --text-color: #2c3e50;
            --light-text: #ecf0f1;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --sub-nav-bg: #34495e; /* Slightly different bg for sub-nav */
            --sub-nav-hover: #4e6d8c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--dark-bg));
            color: var(--light-text);
            padding: 1.5rem;
            text-align: center;
            position: relative;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.2rem;
            font-weight: 300;
        }

        /* Main Navigation */
        nav.main-nav {
            background-color: var(--primary-color);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 1rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .nav-list {
            display: flex;
            list-style: none;
            margin: 0;
            padding: 0;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }

        .nav-list::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        .nav-item {
            white-space: nowrap;
        }

        .nav-link {
            display: block;
            color: var(--light-text);
            text-decoration: none;
            padding: 1rem;
            font-weight: 500;
            font-size: 1rem;
            transition: background-color 0.3s, color 0.3s;
            border: none; /* Reset button styles if using button element */
            background: none; /* Reset button styles if using button element */
            cursor: pointer; /* Ensure cursor changes */
        }

        .nav-link:hover, .nav-link.active {
            background-color: var(--secondary-color);
        }

        /* Sub Navigation (within Revision Guide) */
        nav.sub-nav {
            background-color: var(--sub-nav-bg);
            border-radius: 8px 8px 0 0; /* Rounded top corners */
            margin-bottom: 0; /* Remove margin below sub-nav */
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.05);
        }

        nav.sub-nav .nav-container {
             justify-content: flex-start; /* Align sub-tabs left */
             padding: 0 0.5rem; /* Less padding for sub-nav */
        }

        nav.sub-nav .nav-link {
             padding: 0.75rem; /* Smaller padding */
             font-size: 0.9rem; /* Smaller font */
        }

        nav.sub-nav .nav-link:hover, nav.sub-nav .nav-link.active {
             background-color: var(--sub-nav-hover); /* Different hover color */
        }


        main {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* Main Tab Content */
        .tab-content {
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
            opacity: 1;
        }

        /* Sub Tab Content (Revision Sections) */
        .sub-tab-content {
             display: none; /* Hide all sub-sections by default */
             background-color: #fff;
             border-radius: 0 0 8px 8px; /* Rounded bottom corners */
             padding: 2rem;
             margin-bottom: 2rem;
             box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
             border: 1px solid var(--sub-nav-bg); /* Add border to match sub-nav */
             border-top: none; /* Remove top border as sub-nav covers it */
        }

        .sub-tab-content.active {
             display: block; /* Show only the active sub-section */
        }

        /* Style sections within Practice and Reference normally */
        #practice section, #reference section {
             background-color: #fff;
             border-radius: 8px;
             padding: 2rem;
             margin-bottom: 2rem;
             box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }


        h2 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--secondary-color);
            font-size: 1.8rem;
        }

        h3 {
            color: var(--secondary-color);
            margin: 1.5rem 0 1rem;
            font-size: 1.4rem;
        }

        p, ul, ol {
            margin-bottom: 1rem;
        }

        ul, ol {
            padding-left: 1.5rem;
        }

        .key-concept {
            background-color: var(--light-bg);
            padding: 1rem;
            border-left: 4px solid var(--secondary-color);
            margin-bottom: 1rem;
            border-radius: 0 4px 4px 0;
        }

        .example {
            background-color: rgba(52, 152, 219, 0.1);
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
            border: 1px solid var(--secondary-color);
        }

        .example h4 {
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
        }

        .practice {
            background-color: rgba(46, 204, 113, 0.1);
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
            border: 1px solid var(--success-color);
        }

        .practice h4 {
            color: var(--success-color);
            margin-bottom: 0.5rem;
        }

        .question-container {
            margin-bottom: 1.5rem; /* Increased spacing */
        }

        .answer-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
            margin-top: 0.5rem;
        }

        .answer-btn:hover {
            background-color: #2980b9;
        }

        /* Hidden answer divs (used only if toggleAnswer is needed, deprecated now) */
        .answer {
            display: none;
            background-color: #f8f9fa;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 0.5rem;
            border-left: 3px solid var(--success-color);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        table, th, td {
            border: 1px solid #ddd;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background-color: var(--primary-color);
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .molecule-diagram {
            display: flex;
            justify-content: center;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        /* Atom styles (unchanged) */
        .atom { width: 50px; height: 50px; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold; margin: 0 5px; position: relative; }
        .carbon { background-color: #333; }
        .oxygen { background-color: #cc0000; }
        .hydrogen { background-color: #0066cc; width: 30px; height: 30px; font-size: 0.8rem; }
        .bond { width: 20px; height: 2px; background-color: #333; margin: auto 0; }
        .molecule { position: relative; display: inline-block; margin: 10px; }
        .methane, .water { position: relative; width: 120px; height: 120px; }


        .progress-container {
            width: 100%;
            background-color: #f1f1f1;
            border-radius: 4px;
            margin: 1rem 0;
        }

        .progress-bar {
            height: 10px;
            background-color: var(--success-color);
            width: 0%; /* Start at 0% */
            border-radius: 4px;
            transition: width 0.3s ease-in-out;
        }

        .interactive-equation {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .equation-part {
            margin: 0 0.5rem;
            font-size: 1.2rem;
        }

        .equation-arrow {
            font-size: 1.5rem;
            color: var(--secondary-color);
            margin: 0 1rem;
        }

        .equation-input, textarea { /* Apply general style to textarea too */
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 0.5rem;
            margin: 0.2rem; /* Add margin for spacing */
            font-family: inherit; /* Ensure consistent font */
            font-size: 1rem; /* Ensure consistent font size */
            vertical-align: middle; /* Align inputs better with text */
        }

        .equation-input {
             width: 120px;
             text-align: center;
        }

        textarea {
             width: 100%; /* Make textareas take full width */
             max-width: 500px; /* Limit max width */
             vertical-align: top; /* Align top */
        }

        .check-equation-btn, .reset-progress-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s;
            margin-top: 1rem;
        }

        .check-equation-btn:hover, .reset-progress-btn:hover {
            background-color: var(--dark-bg);
        }

        .feedback {
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 4px;
            text-align: center;
            min-height: 1.5em; /* Prevent layout shifts */
        }

        .feedback.correct {
            background-color: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }

        .feedback.incorrect {
            background-color: rgba(231, 76, 60, 0.2);
            color: #c0392b;
        }

        footer {
            background-color: var(--dark-bg);
            color: var(--light-text);
            text-align: center;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        @media screen and (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }

            /* Adjust section padding for mobile */
            .sub-tab-content, #practice section, #reference section {
                 padding: 1.5rem;
            }

            .nav-container {
                justify-content: flex-start; /* Ensure main nav starts left */
            }

            .interactive-equation {
                justify-content: flex-start;
            }
            .equation-input {
                 width: 80px;
            }
        }

        /* Animation for tab transitions */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .tab-content.active, .sub-tab-content.active {
            animation: fadeIn 0.5s ease-in-out;
        }
    </style>
</head>
<body>
    <header>
        <h1>Year 9 Chemistry - Reactions Revision Guide</h1>
        <p>Everything you need to know for your assessment</p>
    </header>

    <!-- Main Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <ul class="nav-list">
                <li class="nav-item"><button class="nav-link active" data-tab="revision">Revision Guide</button></li>
                <li class="nav-item"><button class="nav-link" data-tab="practice">Practice Questions</button></li>
                <li class="nav-item"><button class="nav-link" data-tab="reference">Quick Reference</button></li>
            </ul>
        </div>
    </nav>

    <main>
        <!-- Revision Guide Main Tab Content -->
        <div id="revision" class="tab-content active">
            <!-- Sub Navigation for Revision Sections -->
            <nav class="sub-nav">
                <div class="nav-container">
                    <ul class="nav-list">
                        <li class="nav-item"><button class="nav-link active" data-sub-tab="rev-intro">Introduction</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-basic-reactions">1. Basics</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-conservation-mass">2. Mass</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-reaction-types">3. Types</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-balancing-equations">4. Balancing</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-atomic-structure">5. Atoms</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-calculating-mass-rev">6. Calc Mass</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-compounds-elements-rev">7. Elements</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-practical-applications-rev">8. Practical</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-word-symbol-equations-rev">9. Equations</button></li>
                        <li class="nav-item"><button class="nav-link" data-sub-tab="rev-thermal-decomposition-rev">10. Decomp</button></li>
                    </ul>
                </div>
            </nav>

            <!-- Sub Tab Content Sections -->
            <section id="rev-intro" class="sub-tab-content active">
                <h2>Introduction</h2>
                <p>Welcome to your Chemistry Revision Guide! This guide covers all the key topics you need to understand for your assessment. We'll look at chemical reactions, conservation of mass, types of reactions, atomic structure, and more.</p>
                <p>Use the tabs above this section to navigate through the different revision topics.</p>
                <p>Each section includes:</p>
                <ul>
                    <li>Key concepts you need to know</li>
                    <li>Worked examples to help you understand</li>
                    <li>Practice questions to test your knowledge (your answers are saved in your browser!)</li>
                </ul>
                <p>Let's get started!</p>
            </section>

            <section id="rev-basic-reactions" class="sub-tab-content">
                <h2>1. Chemical Reactions - Basics</h2>
                <div class="key-concept">
                    <h3>Key Concepts:</h3>
                    <ul>
                        <li><strong>Reactants:</strong> The starting substances in a chemical reaction</li>
                        <li><strong>Products:</strong> The substances formed in a chemical reaction</li>
                        <li><strong>Chemical equations:</strong> Show how reactants change into products</li>
                        <li><strong>Conservation of mass:</strong> The total mass of reactants equals the total mass of products in a chemical reaction</li>
                    </ul>
                </div>
                <div class="example">
                    <h4>Worked Example:</h4>
                    <p>For the reaction: methane + oxygen → carbon dioxide + water</p>
                    <ul>
                        <li><strong>Reactants:</strong> methane and oxygen</li>
                        <li><strong>Products:</strong> carbon dioxide and water</li>
                    </ul>
                </div>
                <div class="interactive-equation">
                    <div class="equation-part">CH<sub>4</sub></div>
                    <div class="equation-part">+</div>
                    <div class="equation-part">O<sub>2</sub></div>
                    <div class="equation-arrow">→</div>
                    <div class="equation-part">CO<sub>2</sub></div>
                    <div class="equation-part">+</div>
                    <div class="equation-part">H<sub>2</sub>O</div>
                </div>
                <div class="practice">
                    <h4>Practice:</h4>
                    <div class="question-container">
                        <p>1. For the reaction: sodium + chlorine → sodium chloride</p>
                        <ul>
                            <li>Identify the reactants: <input type="text" class="equation-input" id="q1-reactants"></li>
                            <li>Identify the products: <input type="text" class="equation-input" id="q1-products"></li>
                        </ul>
                        <button class="answer-btn" onclick="checkQ1()">Check Answer</button>
                        <div id="q1-feedback" class="feedback"></div>
                    </div>
                    <div class="question-container">
                        <p>2. Complete: magnesium + oxygen → <input type="text" class="equation-input" id="q2-answer"></p>
                        <button class="answer-btn" onclick="checkQ2()">Check Answer</button>
                        <div id="q2-feedback" class="feedback"></div>
                    </div>
                </div>
            </section>

            <section id="rev-conservation-mass" class="sub-tab-content">
                <h2>2. Conservation of Mass</h2>
                <div class="key-concept">
                    <h3>Key Concepts:</h3>
                    <ul>
                        <li>In a chemical reaction, atoms are neither created nor destroyed, only rearranged.</li>
                        <li>The total mass of reactants equals the total mass of products.</li>
                        <li>This is why chemical equations must be balanced.</li>
                    </ul>
                </div>
                <div class="example">
                    <h4>Worked Example:</h4>
                    <p>In the reaction: copper + oxygen → copper oxide</p>
                    <ul>
                        <li>If 0.36g of copper reacts, and 0.42g of copper oxide is formed</li>
                        <li>Mass of oxygen that reacted = Mass of product - Mass of copper</li>
                        <li>Mass of oxygen = 0.42g - 0.36g = 0.06g</li>
                    </ul>
                </div>
                <div class="practice">
                    <h4>Practice:</h4>
                    <div class="question-container">
                        <p>1. If 5.0g of calcium carbonate decomposes to form 2.8g of calcium oxide and some carbon dioxide, what is the mass of carbon dioxide produced?</p>
                        <input type="text" class="equation-input" id="q3-answer"> (include units)
                        <button class="answer-btn" onclick="checkQ3()">Check Answer</button>
                        <div id="q3-feedback" class="feedback"></div>
                    </div>
                    <div class="question-container">
                        <p>2. Complete this sentence: Conservation of mass means that the total <input type="text" style="width: 100px;" class="equation-input" id="q4-part1"> of the <input type="text" style="width: 100px;" class="equation-input" id="q4-part2"> is equal to the total <input type="text" style="width: 100px;" class="equation-input" id="q4-part3"> of the <input type="text" style="width: 100px;" class="equation-input" id="q4-part4">.</p>
                        <button class="answer-btn" onclick="checkQ4()">Check Answer</button>
                        <div id="q4-feedback" class="feedback"></div>
                    </div>
                </div>
            </section>

            <section id="rev-reaction-types" class="sub-tab-content">
                 <h2>3. Types of Reactions: Endothermic and Exothermic</h2>
                 <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li><strong>Exothermic reactions:</strong> Release energy to the surroundings (temperature increases)
                             <ul><li>Examples: combustion (burning), neutralization (acid + alkali), respiration</li></ul>
                         </li>
                         <li><strong>Endothermic reactions:</strong> Take in energy from the surroundings (temperature decreases)
                             <ul><li>Examples: photosynthesis, thermal decomposition, dissolving some salts like ammonium nitrate</li></ul>
                         </li>
                     </ul>
                 </div>
                 <div class="example">
                     <h4>Worked Example:</h4>
                     <p>Looking at temperature changes:</p>
                     <ul>
                         <li>Reaction A: Temperature changes from 12°C to 20°C.
                             <ul><li>Temperature increases by 8°C, so energy is released. This is an <strong>exothermic reaction</strong>.</li></ul>
                         </li>
                         <li>Reaction B: Temperature changes from -4°C to -18°C.
                              <ul><li>Temperature decreases by 14°C, so energy is absorbed. This is an <strong>endothermic reaction</strong>.</li></ul>
                         </li>
                     </ul>
                 </div>
                 <table>
                     <tr><th>Reaction Type</th><th>Temperature Change</th><th>Energy Flow</th></tr>
                     <tr><td>Exothermic</td><td>Increases</td><td>Released to surroundings</td></tr>
                     <tr><td>Endothermic</td><td>Decreases</td><td>Absorbed from surroundings</td></tr>
                 </table>
                 <div class="practice">
                     <h4>Practice:</h4>
                     <div class="question-container">
                         <p>1. A reaction causes the temperature to change from 25°C to 15°C. Is this reaction endothermic or exothermic? Explain why.</p>
                         <input type="text" class="equation-input" id="q5-answer" style="width: 150px;" placeholder="Endo/Exo?">
                         <textarea id="q5-explanation" rows="2" placeholder="Explain your choice..." style="width: 100%; max-width: 400px;"></textarea>
                         <button class="answer-btn" onclick="checkQ5()">Check Answer</button>
                         <div id="q5-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. How would you identify an exothermic reaction in the laboratory using simple observations or equipment?</p>
                         <textarea id="q6-answer" rows="3" placeholder="Describe how you would identify it..."></textarea>
                         <button class="answer-btn" onclick="checkQ6()">Check Answer</button>
                         <div id="q6-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-balancing-equations" class="sub-tab-content">
                 <h2>4. Balancing Chemical Equations</h2>
                 <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li>Chemical equations must be balanced because atoms are conserved (Law of Conservation of Mass).</li>
                         <li>Balancing involves adding coefficients (large numbers placed *before* chemical formulas).</li>
                         <li>You <strong>cannot</strong> change the small subscript numbers within a formula (e.g., you can't change H₂O to H₂O₂).</li>
                     </ul>
                 </div>
                 <div class="example">
                     <h4>Worked Example: Balancing Zn + O₂ → ZnO</h4>
                     <p><strong>Step 1: Write the unbalanced equation with correct formulas:</strong> Zn + O₂ → ZnO</p>
                     <p><strong>Step 2: Count atoms on each side:</strong></p>
                     <ul>
                         <li>Left side (Reactants): 1 Zn atom, 2 O atoms (from O₂)</li>
                         <li>Right side (Products): 1 Zn atom, 1 O atom</li>
                     </ul>
                     <p><i>Observation: Oxygen atoms are unbalanced (2 on left, 1 on right).</i></p>
                     <p><strong>Step 3: Add coefficients to balance.</strong> Start with Oxygen. Need 2 O on the right, so put a '2' in front of ZnO:</p>
                     <p>Zn + O₂ → <strong>2</strong>ZnO</p>
                     <p><strong>Step 4: Recount atoms:</strong></p>
                      <ul>
                         <li>Left side: 1 Zn atom, 2 O atoms</li>
                         <li>Right side: <strong>2</strong> Zn atoms (2 x 1), <strong>2</strong> O atoms (2 x 1)</li>
                     </ul>
                     <p><i>Observation: Oxygen is now balanced, but Zinc is unbalanced (1 on left, 2 on right).</i></p>
                     <p><strong>Step 5: Balance Zinc.</strong> Need 2 Zn on the left, so put a '2' in front of Zn:</p>
                      <p><strong>2</strong>Zn + O₂ → 2ZnO</p>
                     <p><strong>Step 6: Final Check:</strong></p>
                      <ul>
                         <li>Left side: 2 Zn atoms, 2 O atoms</li>
                         <li>Right side: 2 Zn atoms, 2 O atoms</li>
                     </ul>
                     <p><i>The equation is now balanced!</i></p>
                 </div>
                 <div class="interactive-equation">
                    <strong>Balance:</strong>&nbsp;
                     <input type="text" class="equation-input" id="bal-zn" placeholder="?" style="width: 30px;"> Zn +
                     <input type="text" class="equation-input" id="bal-o2" placeholder="?" style="width: 30px;"> O₂ →
                     <input type="text" class="equation-input" id="bal-zno" placeholder="?" style="width: 30px;"> ZnO
                 </div>
                 <button class="check-equation-btn" onclick="checkBalancedEquation()">Check Equation</button>
                 <div id="equation-feedback" class="feedback"></div>
                 <div class="practice">
                     <h4>Practice:</h4>
                     <div class="question-container">
                         <p>1. Balance this equation: H₂ + O₂ → H₂O</p>
                         <p>
                             <input type="text" class="equation-input" id="bal-h2" placeholder="?" style="width: 30px;"> H₂ +
                             <input type="text" class="equation-input" id="bal-o2-2" placeholder="?" style="width: 30px;"> O₂ →
                             <input type="text" class="equation-input" id="bal-h2o" placeholder="?" style="width: 30px;"> H₂O
                         </p>
                         <button class="answer-btn" onclick="checkBalancedEquation2()">Check Answer</button>
                         <div id="equation-feedback-2" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. Balance this equation for methane combustion: CH₄ + O₂ → CO₂ + H₂O</p>
                         <p>
                            <input type="text" class="equation-input" id="bal-ch4-q7" placeholder="?" style="width: 30px;"> CH₄ +
                            <input type="text" class="equation-input" id="bal-o2-q7" placeholder="?" style="width: 30px;"> O₂ →
                            <input type="text" class="equation-input" id="bal-co2-q7" placeholder="?" style="width: 30px;"> CO₂ +
                            <input type="text" class="equation-input" id="bal-h2o-q7" placeholder="?" style="width: 30px;"> H₂O
                         </p>
                         <button class="answer-btn" onclick="checkQ7()">Check Answer</button>
                         <div id="q7-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-atomic-structure" class="sub-tab-content">
                 <h2>5. Atomic Structure and Molecule Diagrams</h2>
                  <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li>Atoms are represented by chemical symbols (e.g., C for carbon, O for oxygen, H for hydrogen).</li>
                         <li>Chemical formulas show the number and type of atoms in one molecule or formula unit (e.g., H₂O means 2 hydrogen atoms and 1 oxygen atom).</li>
                         <li>In diagrams, different elements are often represented by different coloured circles or symbols (always check the key if provided).</li>
                     </ul>
                 </div>
                 <div class="example">
                     <h4>Worked Example: The methane molecule (CH₄)</h4>
                     <p>The formula CH₄ tells us it consists of:</p>
                     <ul>
                         <li>1 carbon atom (C)</li>
                         <li>4 hydrogen atoms (H)</li>
                     </ul>
                     <p>A diagram might look like this (using common conventions):</p>
                     <div class="molecule-diagram">
                         <div class="molecule methane">
                             <svg width="120" height="120" viewBox="0 0 120 120"><!-- SVG Code for Methane --><circle cx="60" cy="60" r="20" fill="#333333" /><text x="60" y="65" text-anchor="middle" fill="white" font-size="14">C</text><circle cx="60" cy="20" r="12" fill="#0066cc" /><text x="60" y="24" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="60" cy="100" r="12" fill="#0066cc" /><text x="60" y="104" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="20" cy="60" r="12" fill="#0066cc" /><text x="20" y="64" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="100" cy="60" r="12" fill="#0066cc" /><text x="100" y="64" text-anchor="middle" fill="white" font-size="12">H</text><line x1="60" y1="40" x2="60" y2="32" stroke="#333333" stroke-width="2" /><line x1="60" y1="80" x2="60" y2="88" stroke="#333333" stroke-width="2" /><line x1="40" y1="60" x2="32" y2="60" stroke="#333333" stroke-width="2" /><line x1="80" y1="60" x2="88" y2="60" stroke="#333333" stroke-width="2" /></svg>
                         </div>
                     </div>
                     <p>Total atoms in one molecule = 1 Carbon + 4 Hydrogen = 5 atoms.</p>
                 </div>
                 <div class="practice">
                     <h4>Practice:</h4>
                      <div class="question-container">
                         <p>1. Look at the diagram for the water molecule (H₂O):</p>
                         <div class="molecule-diagram">
                             <div class="molecule water">
                                <svg width="120" height="100" viewBox="0 0 120 100"><!-- SVG Code for Water --><circle cx="60" cy="50" r="20" fill="#cc0000" /><text x="60" y="55" text-anchor="middle" fill="white" font-size="14">O</text><circle cx="30" cy="30" r="12" fill="#0066cc" /><text x="30" y="34" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="90" cy="30" r="12" fill="#0066cc" /><text x="90" y="34" text-anchor="middle" fill="white" font-size="12">H</text><line x1="45" y1="40" x2="35" y2="35" stroke="#333333" stroke-width="2" /><line x1="75" y1="40" x2="85" y2="35" stroke="#333333" stroke-width="2" /></svg>
                             </div>
                         </div>
                         <p>How many atoms are there in total in one water molecule?</p>
                         <input type="text" class="equation-input" id="q7b-answer" style="width: 50px;">
                         <button class="answer-btn" onclick="checkQ7b()">Check Answer</button>
                         <div id="q7b-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. How many atoms are in one molecule of carbon dioxide (CO₂)?</p>
                         <input type="text" class="equation-input" id="q8-answer" style="width: 50px;">
                         <button class="answer-btn" onclick="checkQ8()">Check Answer</button>
                         <div id="q8-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-calculating-mass-rev" class="sub-tab-content">
                 <h2>6. Calculating Mass in Chemical Reactions</h2>
                  <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li>The Law of Conservation of Mass states that mass is conserved in chemical reactions.</li>
                         <li>This means: Total mass of reactants = Total mass of products.</li>
                         <li>We can use this principle to calculate unknown masses.</li>
                     </ul>
                 </div>
                 <div class="example">
                     <h4>Worked Example 1: Finding Product Mass</h4>
                     <p>Reaction: zinc + oxygen → zinc oxide</p>
                     <ul>
                         <li>If 0.2g of zinc reacts completely with 0.36g of oxygen:</li>
                         <li>Total mass of reactants = 0.2g + 0.36g = 0.56g</li>
                         <li>Therefore, by conservation of mass, the mass of zinc oxide produced must be 0.56g.</li>
                     </ul>
                      <h4>Worked Example 2: Finding Reactant Mass</h4>
                     <p>Reaction: magnesium + oxygen → magnesium oxide</p>
                     <ul>
                         <li>If 0.3g of magnesium reacts to produce 0.7g of magnesium oxide:</li>
                         <li>Mass of reactants = Mass of products</li>
                         <li>Mass(Mg) + Mass(O₂) = Mass(MgO)</li>
                         <li>0.3g + Mass(O₂) = 0.7g</li>
                         <li>Mass(O₂) = 0.7g - 0.3g = 0.4g</li>
                     </ul>
                 </div>
                 <div class="practice">
                     <h4>Practice:</h4>
                     <div class="question-container">
                         <p>1. In the reaction iron + oxygen → iron oxide, 5.6g of iron reacts completely with 2.4g of oxygen. What mass of iron oxide is produced?</p>
                         <input type="text" class="equation-input" id="q9-answer"> (include units)
                         <button class="answer-btn" onclick="checkQ9()">Check Answer</button>
                         <div id="q9-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. If 10.0g of calcium carbonate decomposes completely to produce 5.6g of calcium oxide, what mass of carbon dioxide gas is produced?</p>
                         <input type="text" class="equation-input" id="q10-answer"> (include units)
                         <button class="answer-btn" onclick="checkQ10()">Check Answer</button>
                         <div id="q10-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-compounds-elements-rev" class="sub-tab-content">
                 <h2>7. Compounds and Elements</h2>
                  <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li><strong>Elements:</strong> Pure substances made of only one type of atom (found on the periodic table, e.g., Iron (Fe), Oxygen (O)). Elements can exist as single atoms or molecules (e.g., O₂).</li>
                         <li><strong>Compounds:</strong> Substances made of two or more different elements chemically combined together in a fixed ratio (e.g., Water (H₂O), Carbon Dioxide (CO₂)). Compounds have properties different from their constituent elements.</li>
                         <li><strong>Molecules:</strong> A group of two or more atoms held together by chemical bonds. Molecules can represent elements (like O₂, N₂) or compounds (like H₂O, CH₄).</li>
                     </ul>
                 </div>
                 <div class="example">
                     <h4>Worked Example: Ammonium Nitrate (NH₄NO₃)</h4>
                     <ul>
                         <li><strong>Elements present:</strong> Look for different capital letters: N (Nitrogen), H (Hydrogen), O (Oxygen). There are <strong>3 different elements</strong>.</li>
                         <li><strong>Atoms per formula unit:</strong> Count all atoms, including subscripts: There are 2 N atoms (one in NH₄ and one in NO₃), 4 H atoms, and 3 O atoms. Total = 2 + 4 + 3 = <strong>9 atoms</strong>.</li>
                     </ul>
                 </div>
                 <div class="practice">
                     <h4>Practice:</h4>
                     <div class="question-container">
                         <p>1. How many different elements are present in magnesium oxide (MgO)?</p>
                         <input type="text" class="equation-input" id="q11-answer" style="width: 50px;">
                         <button class="answer-btn" onclick="checkQ11()">Check Answer</button>
                         <div id="q11-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. How many atoms are there in total in one molecule of sulfuric acid (H₂SO₄)?</p>
                         <input type="text" class="equation-input" id="q12-answer" style="width: 50px;">
                         <button class="answer-btn" onclick="checkQ12()">Check Answer</button>
                         <div id="q12-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-practical-applications-rev" class="sub-tab-content">
                <h2>8. Practical Applications of Chemical Reactions</h2>
                 <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li>Chemical reactions are used in everyday products like heat packs and cold packs.</li>
                         <li><strong>Heat packs:</strong> Use exothermic reactions to generate heat (release energy).</li>
                         <li><strong>Cold packs:</strong> Use endothermic reactions to absorb heat from surroundings (feel cold).</li>
                         <li>When evaluating products based on reactions, consider:
                             <ul>
                                 <li><strong>Effectiveness:</strong> How much does the temperature change? (Magnitude of change).</li>
                                 <li><strong>Cost:</strong> Is it good value for money? (Cost per pack or cost per degree change).</li>
                                 <li><strong>Safety:</strong> Are the chemicals safe? Is the temperature change safe?</li>
                                 <li><strong>Convenience:</strong> Is it easy to use and store?</li>
                             </ul>
                         </li>
                     </ul>
                 </div>
                 <div class="example">
                     <h4>Worked Example: Comparing Cool Packs</h4>
                     <p>Data for instant cold packs:</p>
                     <table>
                         <tr><th>Product</th><th>Temperature change (°C)</th><th>Cost (£)</th></tr>
                         <tr><td>MuscleCool</td><td>-15</td><td>20</td></tr>
                         <tr><td>CoolAid</td><td>-25</td><td>22</td></tr>
                     </table>
                     <p>To compare:</p>
                     <ul>
                         <li><strong>Effectiveness:</strong> CoolAid produces a larger temperature decrease (-25°C) than MuscleCool (-15°C), so it gets colder.</li>
                         <li><strong>Cost:</strong> CoolAid (£22) is slightly more expensive than MuscleCool (£20).</li>
                         <li><strong>Conclusion:</strong> CoolAid is more effective but costs more. The best choice depends on whether the extra cooling is worth the extra cost.</li>
                     </ul>
                 </div>
                 <div class="practice">
                     <h4>Practice:</h4>
                      <div class="question-container">
                         <p>1. Which would be more cost-effective as a heat pack: Pack A produces a 30°C temperature increase for £25, or Pack B produces a 22°C increase for £18? Explain your reasoning.</p>
                         <textarea id="q13rev-answer" rows="4" placeholder="Calculate cost per degree and explain..."></textarea>
                         <button class="answer-btn" onclick="checkQ13rev()">Check Answer</button>
                         <div id="q13rev-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. Why are some very exothermic reactions, like burning petrol, unsuitable for use in a hand warmer heat pack?</p>
                         <textarea id="q14rev-answer" rows="4" placeholder="Explain the reasons..."></textarea>
                         <button class="answer-btn" onclick="checkQ14rev()">Check Answer</button>
                         <div id="q14rev-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-word-symbol-equations-rev" class="sub-tab-content">
                 <h2>9. Word and Symbol Equations</h2>
                 <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li><strong>Word equations:</strong> Use the full names of reactants and products, separated by an arrow (→) meaning 'reacts to form'. Reactants are on the left, products on the right. Use '+' between multiple reactants or products.
                             <ul><li>Example: <code>reactant 1 + reactant 2 → product 1 + product 2</code></li></ul>
                         </li>
                         <li><strong>Symbol equations:</strong> Use chemical formulas for reactants and products. Must be balanced using coefficients to show conservation of atoms.
                             <ul><li>Example: <code>2H₂ + O₂ → 2H₂O</code></li></ul>
                         </li>
                     </ul>
                 </div>
                  <div class="example">
                     <h4>Worked Example: Sodium reacting with hydrochloric acid</h4>
                     <p><strong>Word equation:</strong> sodium + hydrochloric acid → sodium chloride + hydrogen</p>
                     <p><strong>Balanced Symbol equation:</strong> 2Na + 2HCl → 2NaCl + H₂</p>
                     <p>(Note: Hydrogen gas is H₂, sodium is Na, hydrochloric acid is HCl, sodium chloride is NaCl)</p>
                 </div>
                 <div class="practice">
                     <h4>Practice:</h4>
                     <div class="question-container">
                         <p>1. Write the word equation for the reaction represented by the symbol equation: 2Mg + O₂ → 2MgO</p>
                         <input type="text" class="equation-input" id="q15-answer" style="width: 90%; max-width: 500px;">
                         <button class="answer-btn" onclick="checkQ15()">Check Answer</button>
                         <div id="q15-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. Write the balanced symbol equation for the reaction: calcium + water → calcium hydroxide + hydrogen</p>
                          <input type="text" class="equation-input" id="q16-answer" style="width: 90%; max-width: 500px;">
                         <button class="answer-btn" onclick="checkQ16()">Check Answer</button>
                         <div id="q16-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

            <section id="rev-thermal-decomposition-rev" class="sub-tab-content">
                 <h2>10. Thermal Decomposition</h2>
                 <div class="key-concept">
                     <h3>Key Concepts:</h3>
                     <ul>
                         <li><strong>Thermal decomposition:</strong> The breakdown of a single compound into two or more simpler substances using heat.</li>
                         <li>Many metal carbonates decompose when heated strongly to form a metal oxide and carbon dioxide gas.
                             <ul><li>General equation: Metal Carbonate → Metal Oxide + Carbon Dioxide</li></ul>
                         </li>
                         <li>These reactions are usually <strong>endothermic</strong> (they require continuous heat energy input).</li>
                         <li>If the reaction is carried out in an open container (like a crucible), any gas produced will escape. This causes the measured mass of the solid remaining to decrease.</li>
                     </ul>
                 </div>
                  <div class="example">
                     <h4>Worked Example: Heating Calcium Carbonate</h4>
                     <p>Reaction: calcium carbonate → calcium oxide + carbon dioxide</p>
                     <p>Symbol Equation: CaCO₃(s) → CaO(s) + CO₂(g)</p>
                     <ul>
                         <li>If we start with 10g of solid CaCO₃ and heat it strongly in an open crucible, the solid calcium oxide (CaO) remains.</li>
                         <li>The carbon dioxide (CO₂) is a gas and escapes into the air.</li>
                         <li>Because the gas escapes, the mass of the solid remaining (CaO) will be less than the initial 10g. (Mass is still conserved overall, but some mass leaves the crucible).</li>
                     </ul>
                 </div>
                 <div class="practice">
                     <h4>Practice:</h4>
                     <div class="question-container">
                         <p>1. What are the two products formed when copper(II) carbonate (CuCO₃) is heated?</p>
                         <input type="text" class="equation-input" id="q17-answer" style="width: 90%; max-width: 500px;" placeholder="Product 1 + Product 2">
                         <button class="answer-btn" onclick="checkQ17()">Check Answer</button>
                         <div id="q17-feedback" class="feedback"></div>
                     </div>
                     <div class="question-container">
                         <p>2. Explain why the mass of solid appears to decrease when zinc carbonate is heated in an open container.</p>
                         <textarea id="q18-answer" rows="4" placeholder="Explain why the mass goes down..."></textarea>
                         <button class="answer-btn" onclick="checkQ18()">Check Answer</button>
                         <div id="q18-feedback" class="feedback"></div>
                     </div>
                 </div>
            </section>

        </div> <!-- End of #revision tab content -->

        <!-- Practice Questions Main Tab Content -->
        <div id="practice" class="tab-content">
             <!-- Practice questions sections (A-E) and Progress Tracker remain the same -->
             <!-- Textareas have rows="4" for longer answers -->
            <section id="practice-intro">
                <h2>Practice Questions</h2>
                <p>Test your understanding. Your progress is tracked below and saved locally.</p>
            </section>

            <section id="section-a">
                 <h2>Section A: Understanding Chemical Reactions</h2>
                 <div class="question-container">
                     <p><strong>PQ1. Look at this reaction: hydrogen + chlorine → hydrogen chloride</strong></p>
                     <p>Fill in the blanks:</p>
                     <p>a) The <input type="text" class="equation-input" id="pq1a-answer"> are hydrogen and chlorine.</p>
                     <p>b) The <input type="text" class="equation-input" id="pq1b-answer"> is hydrogen chloride.</p>
                     <button class="answer-btn" onclick="checkPQ1()">Check Answer</button>
                     <div id="pq1-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ2. State the law of conservation of mass in a chemical reaction.</strong></p>
                     <textarea rows="4" id="pq2-answer"></textarea>
                     <button class="answer-btn" onclick="checkPQ2()">Check Answer</button>
                     <div id="pq2-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ3. For the reaction: iron + oxygen → iron oxide</strong></p>
                     <p>a) If 2.8g of iron reacts completely with oxygen to produce 4.0g of iron oxide, calculate the mass of oxygen that reacted.</p>
                     <input type="text" class="equation-input" id="pq3a-answer"> (Include units)
                     <p>b) Explain your calculation using the principle of conservation of mass.</p>
                     <textarea rows="4" id="pq3b-answer"></textarea>
                     <button class="answer-btn" onclick="checkPQ3()">Check Answer</button>
                     <div id="pq3-feedback" class="feedback"></div>
                 </div>
            </section>

            <section id="section-b">
                 <h2>Section B: Endothermic and Exothermic Reactions</h2>
                 <div class="question-container">
                     <p><strong>PQ4. Complete these sentences:</strong></p>
                     <p>a) An <input type="text" class="equation-input" id="pq4a-answer"> reaction transfers energy from the reacting chemicals to the surroundings, causing the temperature of the surroundings to increase.</p>
                     <p>b) An <input type="text" class="equation-input" id="pq4b-answer"> reaction transfers energy from the surroundings to the reacting chemicals, causing the temperature of the surroundings to decrease.</p>
                     <button class="answer-btn" onclick="checkPQ4()">Check Answer</button>
                     <div id="pq4-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ5. For each reaction below, identify whether it is endothermic or exothermic based on the temperature change:</strong></p>
                     <table><!-- Table PQ5 -->
                         <tr><th>Reaction</th><th>Start T°C</th><th>End T°C</th><th>Endo/Exo?</th></tr>
                         <tr><td>A</td><td>25</td><td>35</td><td><input type="text" class="equation-input" id="pq5a-answer"></td></tr>
                         <tr><td>B</td><td>22</td><td>14</td><td><input type="text" class="equation-input" id="pq5b-answer"></td></tr>
                         <tr><td>C</td><td>-5</td><td>-15</td><td><input type="text" class="equation-input" id="pq5c-answer"></td></tr>
                     </table>
                     <button class="answer-btn" onclick="checkPQ5()">Check Answer</button>
                     <div id="pq5-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ6. Combustion is a reaction with oxygen in which energy is transferred to the surroundings as heat and light. It is therefore an <input type="text" class="equation-input" id="pq6-answer"> process.</strong></p>
                     <button class="answer-btn" onclick="checkPQ6()">Check Answer</button>
                     <div id="pq6-feedback" class="feedback"></div>
                 </div>
            </section>

            <section id="section-c">
                 <h2>Section C: Representing Chemical Reactions</h2>
                 <div class="question-container">
                     <p><strong>PQ7. For sulfuric acid (H₂SO₄):</strong></p>
                     <p>a) How many different elements are present? <input type="text" class="equation-input" id="pq7a-answer" style="width:50px;"></p>
                     <p>b) How many atoms are there in total in one molecule? <input type="text" class="equation-input" id="pq7b-answer" style="width:50px;"></p>
                     <button class="answer-btn" onclick="checkPQ7()">Check Answer</button>
                     <div id="pq7-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ8. Complete the word equations below:</strong></p>
                     <p>a) zinc + oxygen → <input type="text" class="equation-input" id="pq8a-answer"></p>
                     <p>b) magnesium + water → <input type="text" class="equation-input" id="pq8b-answer1"> + <input type="text" class="equation-input" id="pq8b-answer2"></p>
                     <button class="answer-btn" onclick="checkPQ8()">Check Answer</button>
                     <div id="pq8-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ9. For the reaction where calcium burns in oxygen:</strong></p>
                     <p>a) Write the word equation:</p>
                     <input type="text" class="equation-input" style="width: 90%; max-width: 500px;" id="pq9a-answer">
                     <p>b) Write the balanced symbol equation:</p>
                     <input type="text" class="equation-input" style="width: 90%; max-width: 500px;" id="pq9b-answer">
                     <button class="answer-btn" onclick="checkPQ9()">Check Answer</button>
                     <div id="pq9-feedback" class="feedback"></div>
                 </div>
            </section>

            <section id="section-d">
                 <h2>Section D: Calculations and Practical Applications</h2>
                 <div class="question-container">
                     <p><strong>PQ10. Kim reacted 0.45g of aluminum completely with oxygen. The aluminum oxide formed weighed 0.85g.</strong></p>
                     <p>Calculate the mass of oxygen that reacted with the aluminum.</p>
                     <input type="text" class="equation-input" id="pq10-answer"> (Include units)
                     <button class="answer-btn" onclick="checkPQ10()">Check Answer</button>
                     <div id="pq10-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ11. Look at the data for these chemical heat packs:</strong></p>
                     <table><!-- Table PQ11 -->
                         <tr><th>Product</th><th>Temp. change (°C)</th><th>Cost (£)</th></tr>
                         <tr><td>HeatMax</td><td>+18</td><td>15</td></tr>
                         <tr><td>WarmPlus</td><td>+25</td><td>22</td></tr>
                         <tr><td>ThermoFix</td><td>+15</td><td>13</td></tr>
                     </table>
                     <p>a) Which product would be most suitable as a heat pack? Explain your answer considering both effectiveness (temperature change) and cost.</p>
                     <textarea rows="4" id="pq11a-answer"></textarea>
                     <p>b) Would any of these reactions be endothermic or exothermic? Explain how you know from the data.</p>
                     <textarea rows="4" id="pq11b-answer"></textarea>
                     <button class="answer-btn" onclick="checkPQ11()">Check Answer</button>
                     <div id="pq11-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ12. Copper(II) carbonate breaks down when heated:</strong><br>
                     CuCO₃(s) → CuO(s) + CO₂(g)</p>
                     <p>a) If you start with 5.0g of copper(II) carbonate and heat it strongly in an open crucible until the reaction is complete, will the mass of the solid remaining be more than, less than, or equal to 5.0g? Explain your answer.</p>
                     <textarea rows="4" id="pq12a-answer"></textarea>
                     <p>b) Is this reaction likely endothermic or exothermic? (Hint: Does thermal decomposition require heating?)</p>
                     <input type="text" class="equation-input" id="pq12b-answer">
                     <button class="answer-btn" onclick="checkPQ12()">Check Answer</button>
                     <div id="pq12-feedback" class="feedback"></div>
                 </div>
            </section>

            <section id="section-e">
                 <h2>Section E: Balancing Equations</h2>
                 <div class="question-container">
                     <p><strong>PQ13. Balance these symbol equations by writing the correct numbers in the boxes:</strong></p>
                     <p>a) <input type="text" class="equation-input" style="width: 30px;" id="pq13a-na"> Na + <input type="text" class="equation-input" style="width: 30px;" id="pq13a-h2o"> H₂O → <input type="text" class="equation-input" style="width: 30px;" id="pq13a-naoh"> NaOH + <input type="text" class="equation-input" style="width: 30px;" id="pq13a-h2"> H₂</p>
                     <p>b) <input type="text" class="equation-input" style="width: 30px;" id="pq13b-ch4"> CH₄ + <input type="text" class="equation-input" style="width: 30px;" id="pq13b-o2"> O₂ → <input type="text" class="equation-input" style="width: 30px;" id="pq13b-co2"> CO₂ + <input type="text" class="equation-input" style="width: 30px;" id="pq13b-h2o"> H₂O</p>
                     <p>c) <input type="text" class="equation-input" style="width: 30px;" id="pq13c-fe"> Fe + <input type="text" class="equation-input" style="width: 30px;" id="pq13c-o2"> O₂ → <input type="text" class="equation-input" style="width: 30px;" id="pq13c-fe2o3"> Fe₂O₃</p>
                     <button class="answer-btn" onclick="checkPQ13()">Check Answer</button>
                     <div id="pq13-feedback" class="feedback"></div>
                 </div>
                 <div class="question-container">
                     <p><strong>PQ14. Hydrogen gas (H₂) reacts with oxygen gas (O₂) to form water (H₂O).</strong></p>
                     <p>a) Write the balanced symbol equation for this reaction:</p>
                     <input type="text" class="equation-input" style="width: 90%; max-width: 300px;" id="pq14a-answer">
                     <p>b) According to your balanced equation, how many molecules of hydrogen (H₂) are needed to react completely with 3 molecules of oxygen (O₂)?</p>
                     <input type="text" class="equation-input" id="pq14b-answer" style="width: 50px;"> molecules
                     <button class="answer-btn" onclick="checkPQ14()">Check Answer</button>
                     <div id="pq14-feedback" class="feedback"></div>
                 </div>
            </section>

            <section id="progress-tracker">
                <h2>Your Progress</h2>
                <p>Track your progress on the practice questions (Section A-E):</p>
                <div class="progress-container">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
                <p id="progress-text">Completed: 0 out of 14 practice questions</p>
                <button class="reset-progress-btn" onclick="resetProgress()">Reset Progress & Saved Answers</button>
            </section>
        </div> <!-- End of #practice tab content -->

        <!-- Quick Reference Main Tab Content -->
        <div id="reference" class="tab-content">
             <!-- Reference sections remain unchanged -->
             <section id="key-terms">
                 <h2>Key Terms</h2>
                 <table><!-- Table from original -->
                     <tr><th>Term</th><th>Definition</th></tr>
                     <tr><td><strong>Reactants</strong></td><td>The starting substances in a chemical reaction</td></tr>
                     <tr><td><strong>Products</strong></td><td>The substances formed in a chemical reaction</td></tr>
                     <tr><td><strong>Element</strong></td><td>A substance made of only one type of atom (cannot be broken down chemically)</td></tr>
                     <tr><td><strong>Compound</strong></td><td>A substance made of two or more different elements chemically combined in a fixed ratio</td></tr>
                     <tr><td><strong>Exothermic reaction</strong></td><td>A reaction that transfers energy to the surroundings, usually increasing the temperature</td></tr>
                     <tr><td><strong>Endothermic reaction</strong></td><td>A reaction that takes in energy from the surroundings, usually decreasing the temperature</td></tr>
                     <tr><td><strong>Conservation of mass</strong></td><td>The principle that mass is neither created nor destroyed in a chemical reaction; total mass of reactants equals total mass of products</td></tr>
                     <tr><td><strong>Thermal decomposition</strong></td><td>Breaking down a compound into simpler substances using heat</td></tr>
                     <tr><td><strong>Molecule</strong></td><td>A group of two or more atoms held together by chemical bonds (can be an element like O₂ or a compound like H₂O)</td></tr>
                     <tr><td><strong>Coefficient</strong></td><td>A number placed in front of a chemical formula in a balanced equation to indicate the relative number of molecules or formula units</td></tr>
                 </table>
             </section>
             <section id="common-reactions-ref">
                 <h2>Common Chemical Reactions Summary</h2>
                 <table><!-- Table from original -->
                     <tr><th>Reaction Type</th><th>Example Word Equation</th><th>Example Balanced Symbol Equation</th><th>Notes</th></tr>
                     <tr><td>Combustion (Complete)</td><td>methane + oxygen → carbon dioxide + water</td><td>CH₄ + 2O₂ → CO₂ + 2H₂O</td><td>Exothermic; requires oxygen</td></tr>
                     <tr><td>Metal + Oxygen</td><td>magnesium + oxygen → magnesium oxide</td><td>2Mg + O₂ → 2MgO</td><td>Forms metal oxide; exothermic</td></tr>
                     <tr><td>Metal + Water</td><td>sodium + water → sodium hydroxide + hydrogen</td><td>2Na + 2H₂O → 2NaOH + H₂</td><td>Forms metal hydroxide + hydrogen gas (reactive metals)</td></tr>
                     <tr><td>Thermal Decomposition (Carbonate)</td><td>calcium carbonate → calcium oxide + carbon dioxide</td><td>CaCO₃ → CaO + CO₂</td><td>Endothermic; requires heat</td></tr>
                     <tr><td>Synthesis (Elements)</td><td>hydrogen + oxygen → water</td><td>2H₂ + O₂ → 2H₂O</td><td>Forms a compound from elements</td></tr>
                     <tr><td>Neutralisation</td><td>hydrochloric acid + sodium hydroxide → sodium chloride + water</td><td>HCl + NaOH → NaCl + H₂O</td><td>Acid + Base → Salt + Water; exothermic</td></tr>
                 </table>
             </section>
             <section id="calculating-mass-ref">
                 <h2>Calculating Mass Using Conservation of Mass</h2>
                 <div class="key-concept">
                     <p><strong>Principle:</strong> Total Mass of Reactants = Total Mass of Products</p>
                     <ol>
                         <li><strong>If a product mass is unknown:</strong>
                             <ul><li>Add up the masses of ALL reactants. This sum equals the total mass of ALL products. Subtract masses of known products to find the unknown product mass.</li></ul>
                         </li>
                         <li><strong>If a reactant mass is unknown:</strong>
                             <ul><li>Add up the masses of ALL products. This sum equals the total mass of ALL reactants. Subtract masses of known reactants to find the unknown reactant mass.</li></ul>
                         </li>
                         <li><strong>Reactions involving gases escaping:</strong>
                             <ul><li>If a gas is produced and escapes (e.g., heating a carbonate in an open crucible), the measured mass of the remaining solid will decrease. Mass of gas escaped = Initial mass of reactant(s) - Final mass of solid product(s).</li></ul>
                         </li>
                     </ol>
                 </div>
             </section>
             <section id="identifying-reactions-ref">
                 <h2>Identifying Reaction Types from Observations</h2>
                 <table><!-- Table from original -->
                     <tr><th>Observation</th><th>Likely Reaction Type</th><th>Explanation</th></tr>
                     <tr><td>Temperature increases / Container feels warm</td><td><strong>Exothermic</strong></td><td>Energy is released to the surroundings as heat</td></tr>
                     <tr><td>Temperature decreases / Container feels cold</td><td><strong>Endothermic</strong></td><td>Energy is absorbed from the surroundings as heat</td></tr>
                     <tr><td>Requires continuous heating to proceed</td><td><strong>Endothermic</strong> (often Thermal Decomposition)</td><td>Energy must be constantly supplied</td></tr>
                     <tr><td>Burning / Flame produced</td><td><strong>Exothermic</strong> (Combustion)</td><td>Combustion releases heat and light</td></tr>
                     <tr><td>Gas bubbles produced (effervescence)</td><td>Various (e.g., Acid + Carbonate, Acid + Metal, Metal + Water)</td><td>Indicates a gas product is forming</td></tr>
                     <tr><td>Solid forms from solution (precipitate)</td><td>Precipitation Reaction</td><td>An insoluble solid product is formed</td></tr>
                 </table>
             </section>
              <section id="diagram-symbols-ref">
                 <h2>Common Molecule Diagrams (Example Key)</h2>
                 <table><!-- Table from original -->
                      <tr><th>Element</th><th>Symbol</th><th>Typical Diagram Representation</th></tr>
                      <tr><td>Carbon</td><td>C</td><td><svg width="20" height="20"><circle cx="10" cy="10" r="8" fill="#333333"/></svg> (Black/Dark)</td></tr>
                      <tr><td>Oxygen</td><td>O</td><td><svg width="20" height="20"><circle cx="10" cy="10" r="8" fill="#cc0000"/></svg> (Red)</td></tr>
                      <tr><td>Hydrogen</td><td>H</td><td><svg width="20" height="20"><circle cx="10" cy="10" r="6" fill="#0066cc"/></svg> (Blue/White - smaller)</td></tr>
                      <tr><td>Nitrogen</td><td>N</td><td><svg width="20" height="20"><circle cx="10" cy="10" r="8" fill="#8888ff"/></svg> (Blue/Light Blue)</td></tr>
                      <tr><td>Chlorine</td><td>Cl</td><td><svg width="20" height="20"><circle cx="10" cy="10" r="9" fill="#00cc00"/></svg> (Green)</td></tr>
                 </table>
                 <p><em>Note: Colours can vary, but relative sizes often matter (e.g., H is smaller). Check the key if provided in a question.</em></p>
                 <div class="molecule-diagram"><!-- Diagrams from original -->
                      <div style="text-align: center; margin: 10px;"><p><strong>Methane (CH₄)</strong></p><svg width="120" height="120" viewBox="0 0 120 120"><circle cx="60" cy="60" r="20" fill="#333333" /><text x="60" y="65" text-anchor="middle" fill="white" font-size="14">C</text><circle cx="60" cy="20" r="12" fill="#0066cc" /><text x="60" y="24" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="60" cy="100" r="12" fill="#0066cc" /><text x="60" y="104" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="20" cy="60" r="12" fill="#0066cc" /><text x="20" y="64" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="100" cy="60" r="12" fill="#0066cc" /><text x="100" y="64" text-anchor="middle" fill="white" font-size="12">H</text><line x1="60" y1="40" x2="60" y2="32" stroke="#333333" stroke-width="2" /><line x1="60" y1="80" x2="60" y2="88" stroke="#333333" stroke-width="2" /><line x1="40" y1="60" x2="32" y2="60" stroke="#333333" stroke-width="2" /><line x1="80" y1="60" x2="88" y2="60" stroke="#333333" stroke-width="2" /></svg></div>
                      <div style="text-align: center; margin: 10px;"><p><strong>Water (H₂O)</strong></p><svg width="120" height="100" viewBox="0 0 120 100"><circle cx="60" cy="50" r="20" fill="#cc0000" /><text x="60" y="55" text-anchor="middle" fill="white" font-size="14">O</text><circle cx="30" cy="30" r="12" fill="#0066cc" /><text x="30" y="34" text-anchor="middle" fill="white" font-size="12">H</text><circle cx="90" cy="30" r="12" fill="#0066cc" /><text x="90" y="34" text-anchor="middle" fill="white" font-size="12">H</text><line x1="45" y1="40" x2="35" y2="35" stroke="#333333" stroke-width="2" /><line x1="75" y1="40" x2="85" y2="35" stroke="#333333" stroke-width="2" /></svg></div>
                      <div style="text-align: center; margin: 10px;"><p><strong>CO₂</strong></p><svg width="160" height="100" viewBox="0 0 160 100"><circle cx="80" cy="50" r="20" fill="#333333" /><text x="80" y="55" text-anchor="middle" fill="white" font-size="14">C</text><circle cx="30" cy="50" r="20" fill="#cc0000" /><text x="30" y="55" text-anchor="middle" fill="white" font-size="14">O</text><circle cx="130" cy="50" r="20" fill="#cc0000" /><text x="130" y="55" text-anchor="middle" fill="white" font-size="14">O</text><line x1="50" y1="47" x2="60" y2="47" stroke="#333333" stroke-width="2" /><line x1="50" y1="53" x2="60" y2="53" stroke="#333333" stroke-width="2" /><line x1="100" y1="47" x2="110" y2="47" stroke="#333333" stroke-width="2" /><line x1="100" y1="53" x2="110" y2="53" stroke="#333333" stroke-width="2" /></svg></div>
                 </div>
             </section>
             <section id="balancing-steps-ref">
                 <h2>Steps to Balance Equations</h2>
                 <div class="key-concept">
                     <ol><li>Write unbalanced eq with correct formulas.</li><li>Count atoms each side.</li><li>Balance one element using coefficients (numbers in front).</li><li>Update counts.</li><li>Repeat 3 & 4 for other elements.</li><li>Final check.</li><li>Simplify coefficients if needed.</li></ol>
                 </div>
                 <div class="example"><h4>Example: H₂ + O₂ → H₂O</h4><p>Final: <strong>2</strong>H₂ + O₂ → <strong>2</strong>H₂O</p></div>
             </section>
             <section id="common-mistakes-ref">
                 <h2>Common Mistakes to Avoid</h2>
                 <ol><li>Changing subscripts (small numbers).</li><li>Incorrect formulas.</li><li>Miscounting atoms.</li><li>Not simplifying coefficients.</li><li>Confusing Reactants/Products.</li><li>Mass calculation errors.</li><li>Mixing up endo/exothermic.</li><li>Ignoring State Symbols (sometimes important).</li></ol>
             </section>
             <section id="quick-tips-ref">
                 <h2>Quick Tips for the Assessment</h2>
                 <div class="key-concept">
                     <ul><li>Read each question carefully and identify what it's asking.</li><li>Show your working for calculation questions.</li><li>Draw diagrams where helpful.</li><li>Check that your answers make scientific sense.</li><li>Remember the difference between exothermic (temp increases) and endothermic (temp decreases).</li><li>For balancing equations, always count the atoms of each element on both sides.</li><li>Use the conservation of mass principle for calculation questions.</li><li>Use precise scientific vocabulary.</li></ul>
                 </div>
             </section>
        </div> <!-- End of #reference tab content -->
    </main>

    <footer>
        <p>Year 9 Chemistry Revision Guide © 2025</p>
    </footer>

    <script>
        // --- Constants ---
        const LS_PREFIX = 'chemRev_yr9_v2_'; // Updated prefix for isolation
        const totalQuestions = 14; // Total practice questions for progress

        // --- State Variables ---
        let completedQuestions = 0;
        let inputElements = []; // To store references to all input/textarea elements

        // --- Local Storage Functions ---
        function saveState(elementId, value) {
            if (!elementId) return; // Don't save if no ID
            try {
                localStorage.setItem(LS_PREFIX + elementId, value);
            } catch (e) {
                console.error("Error saving to local storage:", e);
            }
        }

        function loadState(elementId) {
            if (!elementId) return null;
            try {
                return localStorage.getItem(LS_PREFIX + elementId);
            } catch (e) {
                console.error("Error loading from local storage:", e);
                return null;
            }
        }

        function clearState(elementId) {
             if (!elementId) return;
             try {
                localStorage.removeItem(LS_PREFIX + elementId);
            } catch (e) {
                console.error("Error removing from local storage:", e);
            }
        }

        function saveProgress() {
            saveState('completedQuestions', completedQuestions.toString());
        }

        function loadProgress() {
            const savedProgress = loadState('completedQuestions');
            completedQuestions = savedProgress ? parseInt(savedProgress, 10) : 0;
             if (isNaN(completedQuestions) || completedQuestions < 0 || completedQuestions > totalQuestions) {
                completedQuestions = 0; // Reset if invalid
            }
        }

        // --- Initialization and Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            // Store references to all input elements for easy access
            inputElements = Array.from(document.querySelectorAll('input[type="text"], textarea'));

            // Load saved progress and input values
            loadProgress();
            inputElements.forEach(el => {
                if (el.id) {
                    const savedValue = loadState(el.id);
                    if (savedValue !== null) {
                        el.value = savedValue;
                    }
                }
                // Add listener to save input automatically
                el.addEventListener('input', () => {
                     if (el.id) {
                        saveState(el.id, el.value);
                    }
                });
            });

            // Update progress bar display based on loaded progress
            updateProgress();

            // --- Main Tab Switching ---
            document.querySelectorAll('.main-nav .nav-link').forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetTabId = this.getAttribute('data-tab');
                    if (!targetTabId) return;

                    // Deactivate other main tabs and content
                    document.querySelectorAll('.main-nav .nav-link').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                    // Activate clicked main tab and its content
                    this.classList.add('active');
                    const targetContent = document.getElementById(targetTabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    }
                });
            });

             // --- Sub Tab Switching (within Revision Guide) ---
             document.querySelectorAll('#revision .sub-nav .nav-link').forEach(subTab => {
                subTab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetSubTabId = this.getAttribute('data-sub-tab');
                    if (!targetSubTabId) return;

                    // Deactivate other sub-tabs and sub-content *within #revision*
                    document.querySelectorAll('#revision .sub-nav .nav-link').forEach(st => st.classList.remove('active'));
                    document.querySelectorAll('#revision .sub-tab-content').forEach(sc => sc.classList.remove('active'));

                    // Activate clicked sub-tab and its content
                    this.classList.add('active');
                    const targetSubContent = document.getElementById(targetSubTabId);
                    if (targetSubContent) {
                        targetSubContent.classList.add('active');
                    }
                });
            });
        });


        // --- Toggle Answer Visibility (Deprecated but kept just in case) ---
        function toggleAnswer(id) {
            const answer = document.getElementById(id);
            if (answer) {
                answer.style.display = (answer.style.display === 'block') ? 'none' : 'block';
            }
        }

        // --- Progress Tracking ---
        function updateProgress() {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            if (progressBar && progressText) {
                const percentage = totalQuestions > 0 ? (completedQuestions / totalQuestions) * 100 : 0;
                progressBar.style.width = percentage + '%';
                progressText.textContent = `Completed: ${completedQuestions} out of ${totalQuestions} practice questions`;
            }
        }

        function incrementProgress(feedbackElement) {
            // Only increment if the question wasn't already marked correct
            if (feedbackElement && !feedbackElement.classList.contains('correct')) {
                 if (completedQuestions < totalQuestions) {
                     completedQuestions++;
                     updateProgress();
                     saveProgress(); // Save progress to Local Storage
                 }
             }
        }

        function resetProgress() {
            if (confirm("Are you sure you want to reset your progress and clear all saved answers for the Practice Questions?")) {
                completedQuestions = 0;
                updateProgress();
                saveProgress(); // Save the reset progress

                // Clear practice question feedbacks
                document.querySelectorAll('#practice .feedback').forEach(feedback => {
                    feedback.textContent = '';
                    feedback.classList.remove('correct', 'incorrect');
                });

                // Clear practice question inputs and associated local storage
                 inputElements.forEach(el => {
                     // Clear inputs only within the practice section
                     const practiceSection = el.closest('#practice');
                     if (practiceSection && el.id) {
                         el.value = '';
                         clearState(el.id); // Remove from Local Storage
                     }
                 });
             }
        }

        // --- Helper function to set feedback ---
        function setFeedback(elementId, message, isCorrect) {
            const feedback = document.getElementById(elementId);
            if (!feedback) return;
            feedback.textContent = message;
            feedback.className = isCorrect ? 'feedback correct' : 'feedback incorrect';
        }

        // --- Revision Guide Question Check Functions (Q1-Q18, no progress update) ---
        // --- Using original detailed feedback messages ---

        function checkQ1() {
            const reactants = document.getElementById('q1-reactants')?.value.toLowerCase().trim();
            const products = document.getElementById('q1-products')?.value.toLowerCase().trim();
            const feedbackId = 'q1-feedback';

            if (reactants?.includes('sodium') && reactants?.includes('chlorine') && products?.includes('sodium chloride')) {
                setFeedback(feedbackId, 'Correct! The reactants are sodium and chlorine, and the product is sodium chloride.', true);
            } else {
                setFeedback(feedbackId, 'Try again. Make sure you\'ve identified the reactants (sodium, chlorine) and products (sodium chloride) correctly.', false);
            }
        }

        function checkQ2() {
            const answer = document.getElementById('q2-answer')?.value.toLowerCase().trim();
            const feedbackId = 'q2-feedback';

            if (answer?.includes('magnesium oxide')) {
                setFeedback(feedbackId, 'Correct! Magnesium + oxygen → magnesium oxide', true);
            } else {
                setFeedback(feedbackId, 'Try again. What is formed when magnesium reacts with oxygen?', false);
            }
        }

        function checkQ3() {
            const answer = document.getElementById('q3-answer')?.value.replace(/\s/g, ''); // Remove spaces
            const feedbackId = 'q3-feedback';

            if (answer === '2.2' || answer === '2.2g' || answer === '2.2grams') {
                setFeedback(feedbackId, 'Correct! 5.0g - 2.8g = 2.2g of carbon dioxide', true);
            } else {
                setFeedback(feedbackId, 'Try again. Remember: mass of reactants = mass of products. 5.0g = 2.8g + ?', false);
            }
        }

        function checkQ4() {
            // Combined inputs for Q4
            const part1 = document.getElementById('q4-part1')?.value.toLowerCase().trim();
            const part2 = document.getElementById('q4-part2')?.value.toLowerCase().trim();
            const part3 = document.getElementById('q4-part3')?.value.toLowerCase().trim();
            const part4 = document.getElementById('q4-part4')?.value.toLowerCase().trim();
            const feedbackId = 'q4-feedback';

            if ((part1 === 'mass' || part1 === 'total mass') && part2 === 'reactants' &&
                (part3 === 'mass' || part3 === 'total mass') && part4 === 'products') {
                setFeedback(feedbackId, 'Correct! Conservation of mass means that the total mass of reactants equals the total mass of products.', true);
            } else {
                setFeedback(feedbackId, 'Try again. Think about what happens to the mass during a chemical reaction (total mass of reactants = total mass of products).', false);
            }
        }

        function checkQ5() {
            const answer = document.getElementById('q5-answer')?.value.toLowerCase().trim();
            const explanation = document.getElementById('q5-explanation')?.value.toLowerCase().trim();
            const feedbackId = 'q5-feedback';

            const isEndothermic = answer?.includes('endothermic');
            const hasReason = explanation?.includes('decrease') || explanation?.includes('absorb') || explanation?.includes('taken in') || explanation?.includes('lower') || explanation?.includes('cold');

            if (isEndothermic && hasReason) {
                setFeedback(feedbackId, 'Correct! It is endothermic because the temperature decreases, meaning energy is absorbed from the surroundings.', true);
            } else if (isEndothermic && !hasReason) {
                 setFeedback(feedbackId, 'You correctly identified it as endothermic, but explain *why* based on the temperature change.', false);
            } else {
                setFeedback(feedbackId, 'Try again. Remember: if temperature decreases, energy is being absorbed from the surroundings (endothermic).', false);
            }
        }

        function checkQ6() {
            const answer = document.getElementById('q6-answer')?.value.toLowerCase().trim();
            const feedbackId = 'q6-feedback';

            if ( (answer?.includes('temperature') && (answer?.includes('increase') || answer?.includes('rise'))) ||
                 answer?.includes('thermometer') ||
                 (answer?.includes('feel') && (answer?.includes('hot') || answer?.includes('warm'))) )
            {
                setFeedback(feedbackId, 'Correct! You could measure a temperature increase with a thermometer, or observe that the reaction container feels warm.', true);
            } else {
                setFeedback(feedbackId, 'Try again. How could you tell if heat is being given out? Think about temperature.', false);
            }
        }

        function checkQ7() { // Balance CH4 + O2 -> CO2 + H2O
            const ch4 = document.getElementById('bal-ch4-q7')?.value.trim();
            const o2 = document.getElementById('bal-o2-q7')?.value.trim();
            const co2 = document.getElementById('bal-co2-q7')?.value.trim();
            const h2o = document.getElementById('bal-h2o-q7')?.value.trim();
            const feedbackId = 'q7-feedback';

            if ((ch4 === '1' || ch4 === '') && o2 === '2' && (co2 === '1' || co2 === '') && h2o === '2') {
                 setFeedback(feedbackId, 'Correct! The balanced equation is: CH₄ + 2O₂ → CO₂ + 2H₂O', true);
            } else {
                 setFeedback(feedbackId, 'Try again. Count C, H, and O atoms on both sides. (Hint: Balance C first, then H, then O).', false);
            }
        }

         function checkQ7b() { // Water atoms
            const answer = document.getElementById('q7b-answer')?.value.trim();
            const feedbackId = 'q7b-feedback';

            if (answer === '3') {
                setFeedback(feedbackId, 'Correct! H₂O has 2 hydrogen atoms and 1 oxygen atom, making 3 atoms in total.', true);
            } else {
                setFeedback(feedbackId, 'Try again. Count the atoms in the formula H₂O.', false);
            }
        }

        function checkQ8() { // CO2 atoms
            const answer = document.getElementById('q8-answer')?.value.trim();
            const feedbackId = 'q8-feedback';

            if (answer === '3') {
                setFeedback(feedbackId, 'Correct! CO₂ has 3 atoms: 1 carbon atom and 2 oxygen atoms.', true);
            } else {
                setFeedback(feedbackId, 'Try again. Count the number of atoms in the formula CO₂.', false);
            }
        }

        function checkQ9() {
            const answer = document.getElementById('q9-answer')?.value.replace(/\s/g, ''); // Remove spaces
            const feedbackId = 'q9-feedback';

             if (answer === '8' || answer === '8g' || answer === '8.0' || answer === '8.0g') {
                setFeedback(feedbackId, 'Correct! 5.6g + 2.4g = 8.0g of iron oxide (using conservation of mass).', true);
            } else {
                setFeedback(feedbackId, 'Try again. Remember the principle of conservation of mass! Mass product = Mass reactants.', false);
            }
        }

         function checkQ10() {
            const answer = document.getElementById('q10-answer')?.value.replace(/\s/g, ''); // Remove spaces
            const feedbackId = 'q10-feedback';

             if (answer === '4.4' || answer === '4.4g') {
                setFeedback(feedbackId, 'Correct! Mass of carbon dioxide = 10.0g - 5.6g = 4.4g', true);
            } else {
                setFeedback(feedbackId, 'Try again. Mass(CaCO₃) = Mass(CaO) + Mass(CO₂). So, Mass(CO₂) = ?', false);
            }
        }

        function checkQ11() { // Elements in MgO
            const answer = document.getElementById('q11-answer')?.value.trim();
            const feedbackId = 'q11-feedback';

            if (answer === '2') {
                setFeedback(feedbackId, 'Correct! MgO contains 2 elements: magnesium (Mg) and oxygen (O).', true);
            } else {
                setFeedback(feedbackId, 'Try again. Count the different element symbols in MgO.', false);
            }
        }

        function checkQ12() { // Atoms in H2SO4
            const answer = document.getElementById('q12-answer')?.value.trim();
            const feedbackId = 'q12-feedback';

            if (answer === '7') {
                setFeedback(feedbackId, 'Correct! H₂SO₄ has 7 atoms: 2 hydrogen atoms, 1 sulfur atom, and 4 oxygen atoms.', true);
            } else {
                setFeedback(feedbackId, 'Try again. Count each atom in the formula H₂SO₄ (2 + 1 + 4).', false);
            }
        }

        function checkQ13rev() { // Heat pack cost effectiveness
            const answer = document.getElementById('q13rev-answer')?.value.toLowerCase().trim();
            const feedbackId = 'q13rev-feedback';

            // Check for key elements: mention of both packs, calculation/comparison of cost per degree, conclusion favouring pack B
            const mentionsA = answer?.includes('pack a') || answer?.includes('£25') || answer?.includes('30');
            const mentionsB = answer?.includes('pack b') || answer?.includes('£18') || answer?.includes('22');
            const comparesCostPerDegree = answer?.includes('cost per degree') || answer?.includes('£/°c') || (answer?.includes('0.82') && answer?.includes('0.83'));
            const concludesB = answer?.includes('pack b') && (answer?.includes('better') || answer?.includes('cheaper per degree') || answer?.includes('cost-effective'));

            if (mentionsA && mentionsB && comparesCostPerDegree && concludesB) {
                 setFeedback(feedbackId, 'Correct! Pack A is £25/30°C ≈ £0.83/°C. Pack B is £18/22°C ≈ £0.82/°C. Pack B is slightly more cost-effective.', true);
            } else if (comparesCostPerDegree && concludesB) {
                 setFeedback(feedbackId, 'Good reasoning about cost per degree and conclusion, ensure you mention both packs clearly.', true); // Still count as correct
            } else {
                 setFeedback(feedbackId, 'Try again. Calculate the cost per degree Celsius increase for each pack (£ divided by °C) and compare them.', false);
            }
        }

        function checkQ14rev() { // Heat pack safety
             const answer = document.getElementById('q14rev-answer')?.value.toLowerCase().trim();
             const feedbackId = 'q14rev-feedback';
             // Check for reasons like safety, control, temperature, containment, products
             const mentionsSafety = answer?.includes('safety') || answer?.includes('dangerous') || answer?.includes('flame') || answer?.includes('burn');
             const mentionsControl = answer?.includes('control') || answer?.includes('too fast') || answer?.includes('rate');
             const mentionsTemp = answer?.includes('too hot') || answer?.includes('temperature');
             const mentionsContain = answer?.includes('contain') || answer?.includes('fumes') || answer?.includes('spill');
             const mentionsProducts = answer?.includes('product') || answer?.includes('harmful');

             if (mentionsSafety || mentionsControl || mentionsTemp || mentionsContain || mentionsProducts) {
                setFeedback(feedbackId, 'Correct! Reasons include lack of control, dangerously high temperatures, difficulty containing reactants/products safely, harmful fumes, and practicality compared to controlled chemical reactions.', true);
             } else {
                 setFeedback(feedbackId, 'Try again. Think about why burning fuel is unsuitable for putting in your pocket (safety, control, temperature, containment).', false);
             }
        }

        function checkQ15() { // Word eq for Mg + O2 -> MgO
            const answer = document.getElementById('q15-answer')?.value.toLowerCase().trim();
            const feedbackId = 'q15-feedback';

            if (answer?.includes('magnesium') && answer?.includes('oxygen') && answer?.includes('magnesium oxide') && (answer?.includes('+') && answer?.includes('→'))) {
                setFeedback(feedbackId, 'Correct! The word equation is: magnesium + oxygen → magnesium oxide', true);
            } else {
                setFeedback(feedbackId, 'Try again. Convert the chemical symbols (Mg, O₂, MgO) to words and write in the format: reactant + reactant → product.', false);
            }
        }

        function checkQ16() { // Symbol eq for Ca + H2O -> Ca(OH)2 + H2
            const answer = document.getElementById('q16-answer')?.value.replace(/\s/g, ''); // Remove spaces
            const feedbackId = 'q16-feedback';
            // Allow for different arrow types if needed, but -> is standard. Check for balancing.
            const expected = 'ca+2h2o→ca(oh)2+h2';
            const expectedAltSub = 'ca+2h₂o→ca(oh)₂+h₂'; // With proper subscripts

            if (answer?.toLowerCase() === expected || answer?.toLowerCase() === expectedAltSub) {
                setFeedback(feedbackId, 'Correct! The balanced symbol equation is: Ca + 2H₂O → Ca(OH)₂ + H₂', true);
            } else {
                setFeedback(feedbackId, 'Try again. Write the correct formulas (Ca, H₂O, Ca(OH)₂, H₂) and then balance the atoms on each side.', false);
            }
        }

        function checkQ17() { // Products of heating CuCO3
            const answer = document.getElementById('q17-answer')?.value.toLowerCase().trim();
            const feedbackId = 'q17-feedback';

             if (answer?.includes('copper oxide') && answer?.includes('carbon dioxide')) {
                setFeedback(feedbackId, 'Correct! Copper carbonate decomposes to form copper oxide and carbon dioxide.', true);
            } else {
                setFeedback(feedbackId, 'Try again. Metal carbonates usually decompose to form a metal oxide and carbon dioxide.', false);
            }
        }

         function checkQ18() { // Mass decrease explanation
            const answer = document.getElementById('q18-answer')?.value.toLowerCase().trim();
            const feedbackId = 'q18-feedback';

            const mentionsGas = answer?.includes('gas') || answer?.includes('carbon dioxide') || answer?.includes('co2');
            const mentionsEscape = answer?.includes('escape') || answer?.includes('lost') || answer?.includes('released') || answer?.includes('leaves');
            const mentionsMass = answer?.includes('mass') || answer?.includes('weighs');

             if (mentionsGas && mentionsEscape && mentionsMass) {
                setFeedback(feedbackId, 'Correct! The mass decreases because a gas (carbon dioxide) is produced and escapes from the open container, carrying mass away.', true);
            } else {
                 setFeedback(feedbackId, 'Try again. Think about the state symbol for carbon dioxide (g). What happens to gases in an open container, and how does this affect the measured mass?', false);
             }
        }


        // --- Practice Question Check Functions (PQ1-PQ14, update progress) ---
        // --- Using original detailed feedback messages ---

        function checkPQ1() {
            const a = document.getElementById('pq1a-answer')?.value.toLowerCase().trim();
            const b = document.getElementById('pq1b-answer')?.value.toLowerCase().trim();
            const feedback = document.getElementById('pq1-feedback');
            if (!feedback) return;

            if (a === 'reactants' && (b === 'product' || b === 'products')) {
                 incrementProgress(feedback);
                 setFeedback('pq1-feedback', 'Correct! Well done!', true);
            } else {
                 setFeedback('pq1-feedback', 'Try again. Remember: reactants are the starting substances, products are formed in the reaction.', false);
            }
        }

        function checkPQ2() {
            const answer = document.getElementById('pq2-answer')?.value.toLowerCase().trim();
            const feedback = document.getElementById('pq2-feedback');
            if (!feedback) return;

            if ((answer?.includes('mass') || answer?.includes('atoms')) &&
                (answer?.includes('same') || answer?.includes('equal') || answer?.includes('conserved')) &&
                (answer?.includes('reactant') && answer?.includes('product'))) {
                 incrementProgress(feedback);
                 setFeedback('pq2-feedback', 'Correct! Conservation of mass means that the total mass of reactants equals the total mass of products (or atoms are conserved).', true);
            } else {
                setFeedback('pq2-feedback', 'Try again. Think about what happens to the total mass (or atoms) during a chemical reaction.', false);
            }
        }

        function checkPQ3() {
             const a = document.getElementById('pq3a-answer')?.value.replace(/\s/g, '');
             const b = document.getElementById('pq3b-answer')?.value.toLowerCase().trim();
             const feedback = document.getElementById('pq3-feedback');
             if (!feedback) return;

             const massCorrect = (a === '1.2' || a === '1.2g');
             const explanationCorrect = (b?.includes('conservation of mass') || b?.includes('conserved')) &&
                                       (b?.includes('reactant') && b?.includes('product')) &&
                                       (b?.includes('equal') || b?.includes('same'));

             if (massCorrect && explanationCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq3-feedback', 'Correct! The mass of oxygen is 4.0g - 2.8g = 1.2g. According to conservation of mass, the mass of reactants (iron + oxygen) equals the mass of products (iron oxide).', true);
             } else if (massCorrect) {
                 setFeedback('pq3-feedback', 'Your calculation (1.2g) is correct, but improve your explanation using the conservation of mass principle.', false);
             } else if (explanationCorrect) {
                  setFeedback('pq3-feedback', 'Your explanation is good, but check your calculation. Mass of oxygen = Mass of product - Mass of iron.', false);
             }
              else {
                 setFeedback('pq3-feedback', 'Try again. Use the principle of conservation of mass to find the oxygen mass and explain it.', false);
             }
        }


        function checkPQ4() {
            const a = document.getElementById('pq4a-answer')?.value.toLowerCase().trim();
            const b = document.getElementById('pq4b-answer')?.value.toLowerCase().trim();
            const feedback = document.getElementById('pq4-feedback');
             if (!feedback) return;

            if (a === 'exothermic' && b === 'endothermic') {
                 incrementProgress(feedback);
                 setFeedback('pq4-feedback', 'Correct! Exothermic reactions release energy, while endothermic reactions absorb energy.', true);
            } else {
                 setFeedback('pq4-feedback', 'Try again. Remember which type of reaction gives out energy (Exo) and which takes energy in (Endo).', false);
            }
        }

        function checkPQ5() {
            const a = document.getElementById('pq5a-answer')?.value.toLowerCase().trim();
            const b = document.getElementById('pq5b-answer')?.value.toLowerCase().trim();
            const c = document.getElementById('pq5c-answer')?.value.toLowerCase().trim();
            const feedback = document.getElementById('pq5-feedback');
             if (!feedback) return;

            if (a === 'exothermic' && b === 'endothermic' && c === 'endothermic') {
                 incrementProgress(feedback);
                 setFeedback('pq5-feedback', 'Correct! A is exothermic (temperature increases), B and C are endothermic (temperature decreases).', true);
            } else {
                 setFeedback('pq5-feedback', 'Try again. Remember: when temperature increases, the reaction is exothermic; when temperature decreases, the reaction is endothermic.', false);
            }
        }

        function checkPQ6() {
             const answer = document.getElementById('pq6-answer')?.value.toLowerCase().trim();
             const feedback = document.getElementById('pq6-feedback');
              if (!feedback) return;

             if (answer === 'exothermic') { // Changed target answer based on restored text
                 incrementProgress(feedback);
                 setFeedback('pq6-feedback', 'Correct! Combustion is a reaction with oxygen in which energy is transferred to the surroundings as heat and light, making it exothermic.', true);
             } else {
                 setFeedback('pq6-feedback', 'Try again. Does combustion release heat or take it in?', false);
             }
         }


        function checkPQ7() {
             const a = document.getElementById('pq7a-answer')?.value.trim();
             const b = document.getElementById('pq7b-answer')?.value.trim();
             const feedback = document.getElementById('pq7-feedback');
              if (!feedback) return;

             if (a === '3' && b === '7') {
                 incrementProgress(feedback);
                 setFeedback('pq7-feedback', 'Correct! H₂SO₄ contains 3 elements (H, S, O) and 7 atoms total (2H + 1S + 4O).', true);
             } else if (a === '3' && b !== '7') {
                 setFeedback('pq7-feedback', 'You identified the 3 elements correctly, but count the atoms again (2 + 1 + 4).', false);
             } else if (a !== '3' && b === '7') {
                  setFeedback('pq7-feedback', 'You counted the 7 atoms correctly, but count the different elements (H, S, O).', false);
             }
             else {
                 setFeedback('pq7-feedback', 'Try again. Look closely at the formula H₂SO₄ and count the different elements and the total number of atoms.', false);
             }
        }

        function checkPQ8() {
            const a = document.getElementById('pq8a-answer')?.value.toLowerCase().trim();
            const b1 = document.getElementById('pq8b-answer1')?.value.toLowerCase().trim();
            const b2 = document.getElementById('pq8b-answer2')?.value.toLowerCase().trim();
            const feedback = document.getElementById('pq8-feedback');
             if (!feedback) return;

            const aCorrect = a === 'zinc oxide';
            const bCorrect = (b1 === 'magnesium hydroxide' && b2 === 'hydrogen') ||
                             (b2 === 'magnesium hydroxide' && b1 === 'hydrogen');

            if (aCorrect && bCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq8-feedback', 'Correct! Zinc + oxygen → zinc oxide and magnesium + water → magnesium hydroxide + hydrogen', true);
             } else if (aCorrect) {
                 setFeedback('pq8-feedback', 'First equation correct (zinc oxide). Try again on the second one. When magnesium reacts with water, it produces magnesium hydroxide and hydrogen.', false);
             } else if (bCorrect) {
                 setFeedback('pq8-feedback', 'Second equation correct (magnesium hydroxide + hydrogen). Try again on the first one. When zinc reacts with oxygen, what is formed?', false);
             } else {
                 setFeedback('pq8-feedback', 'Try again on both equations. Think about what products form in these reactions.', false);
             }
        }

        function checkPQ9() {
            const a = document.getElementById('pq9a-answer')?.value.toLowerCase().trim();
            const b = document.getElementById('pq9b-answer')?.value.replace(/\s/g, '').toLowerCase();
            const feedback = document.getElementById('pq9-feedback');
             if (!feedback) return;

            const aCorrect = a?.includes('calcium') && a?.includes('oxygen') && a?.includes('calcium oxide') && (a?.includes('+') && a?.includes('→'));
            const bCorrect = (b === '2ca+o2→2cao' || b === '2ca+o₂→2cao');

             if (aCorrect && bCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq9-feedback', 'Correct! Word equation: calcium + oxygen → calcium oxide. Symbol equation: 2Ca + O₂ → 2CaO', true);
             } else if (aCorrect) {
                 setFeedback('pq9-feedback', 'Word equation correct. Check your symbol equation - make sure it\'s balanced! (2Ca + O₂ → 2CaO)', false);
             } else if (bCorrect) {
                 setFeedback('pq9-feedback', 'Symbol equation correct. Check your word equation format (reactant + reactant → product).', false);
             } else {
                 setFeedback('pq9-feedback', 'Try again on both equations. Remember to balance the symbol equation.', false);
             }
        }

        function checkPQ10() {
            const answer = document.getElementById('pq10-answer')?.value.replace(/\s/g, '');
            const feedback = document.getElementById('pq10-feedback');
             if (!feedback) return;

             if (answer === '0.4' || answer === '0.4g' || answer === '0.40' || answer === '0.40g') {
                 incrementProgress(feedback);
                 setFeedback('pq10-feedback', 'Correct! The mass of oxygen = 0.85g - 0.45g = 0.40g', true);
             } else {
                 setFeedback('pq10-feedback', 'Try again. Use the conservation of mass principle: Mass(Al) + Mass(O₂) = Mass(Al₂O₃). Find the mass of oxygen.', false);
             }
        }

        function checkPQ11() {
             const a = document.getElementById('pq11a-answer')?.value.toLowerCase().trim();
             const b = document.getElementById('pq11b-answer')?.value.toLowerCase().trim();
             const feedback = document.getElementById('pq11-feedback');
             if (!feedback) return;

             const aHasWarmPlus = a?.includes('warmplus');
             const aHasEffectiveness = a?.includes('effective') || a?.includes('temperature') || a?.includes('25') || a?.includes('highest') || a?.includes('greatest');
             const aHasCost = a?.includes('cost') || a?.includes('expensive') || a?.includes('£22') || a?.includes('price');
             const aCorrect = aHasWarmPlus && aHasEffectiveness; // Cost is secondary justification

             const bHasExothermic = b?.includes('exothermic');
             const bHasReason = b?.includes('temperature increase') || b?.includes('releases heat') ||
                               b?.includes('gives out heat') || b?.includes('positive');
             const bCorrect = bHasExothermic && bHasReason;

             if (aCorrect && bCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq11-feedback', 'Correct! WarmPlus would be most suitable because it produces the highest temperature change (+25°C), though it costs more. All these reactions are exothermic because they release heat (positive temperature change).', true);
             } else if (aCorrect) {
                 setFeedback('pq11-feedback', 'Your product choice (WarmPlus) is good, but improve your explanation for part b. Why are these exothermic reactions? Link to the data.', false);
             } else if (bCorrect) {
                 setFeedback('pq11-feedback', 'Your explanation of reaction type (exothermic) is correct, but reconsider your product choice in part a. Which gives the greatest temperature increase?', false);
             } else {
                 setFeedback('pq11-feedback', 'Try again on both parts. Consider which product gives the greatest temperature increase, and why these are exothermic reactions (link to data).', false);
             }
        }


        function checkPQ12() {
             const a = document.getElementById('pq12a-answer')?.value.toLowerCase().trim();
             const b = document.getElementById('pq12b-answer')?.value.toLowerCase().trim();
             const feedback = document.getElementById('pq12-feedback');
             if (!feedback) return;

             const aHasLess = a?.includes('less');
             const aHasGas = a?.includes('gas') || a?.includes('carbon dioxide') || a?.includes('co2') ||
                           a?.includes('escapes') || a?.includes('released') || a?.includes('lost');
            const aCorrect = aHasLess && aHasGas;

            const bCorrect = (b === 'endothermic');

             if (aCorrect && bCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq12-feedback', 'Correct! a) The mass will be less than 5.0g because carbon dioxide gas escapes. b) This reaction requires heat input (thermal decomposition), so it\'s endothermic.', true);
             } else if (aCorrect) {
                 setFeedback('pq12-feedback', 'Your explanation for mass change is correct, but check the reaction type. Thermal decomposition requires heat input, so it\'s...?', false);
             } else if (bCorrect) {
                 setFeedback('pq12-feedback', 'You\'ve correctly identified the reaction as endothermic, but improve your explanation about mass change. What happens to the carbon dioxide?', false);
             } else {
                 setFeedback('pq12-feedback', 'Try again on both parts. Think about what happens to the carbon dioxide gas, and whether heat is required for the reaction.', false);
             }
        }

        function checkPQ13() {
            const na = document.getElementById('pq13a-na')?.value.trim();
            const h2o = document.getElementById('pq13a-h2o')?.value.trim();
            const naoh = document.getElementById('pq13a-naoh')?.value.trim();
            const h2 = document.getElementById('pq13a-h2')?.value.trim();
            const ch4 = document.getElementById('pq13b-ch4')?.value.trim();
            const o2 = document.getElementById('pq13b-o2')?.value.trim();
            const co2 = document.getElementById('pq13b-co2')?.value.trim();
            const h2o2 = document.getElementById('pq13b-h2o')?.value.trim();
            const fe = document.getElementById('pq13c-fe')?.value.trim();
            const o22 = document.getElementById('pq13c-o2')?.value.trim();
            const fe2o3 = document.getElementById('pq13c-fe2o3')?.value.trim();
            const feedback = document.getElementById('pq13-feedback');
            if (!feedback) return;

            const aCorrect = na === '2' && h2o === '2' && naoh === '2' && (h2 === '1' || h2 === '');
            const bCorrect = (ch4 === '1' || ch4 === '') && o2 === '2' && (co2 === '1' || co2 === '') && h2o2 === '2';
            const cCorrect = fe === '4' && o22 === '3' && fe2o3 === '2';

            if (aCorrect && bCorrect && cCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq13-feedback', 'Excellent! All equations are correctly balanced.', true);
             } else {
                 let message = 'Try again. Make sure you count all atoms on both sides of each equation. Check: ';
                 if (!aCorrect) message += 'a) 2Na+2H₂O→2NaOH+H₂ ';
                 if (!bCorrect) message += 'b) CH₄+2O₂→CO₂+2H₂O ';
                 if (!cCorrect) message += 'c) 4Fe+3O₂→2Fe₂O₃ ';
                 setFeedback('pq13-feedback', message, false);
             }
        }

        function checkPQ14() {
            const a = document.getElementById('pq14a-answer')?.value.replace(/\s/g, '').toLowerCase();
            const b = document.getElementById('pq14b-answer')?.value.trim();
            const feedback = document.getElementById('pq14-feedback');
            if (!feedback) return;

            const aCorrect = (a === '2h2+o2→2h2o' || a === '2h₂+o₂→2h₂o');
            const bCorrect = (b === '6');

            if (aCorrect && bCorrect) {
                 incrementProgress(feedback);
                 setFeedback('pq14-feedback', 'Correct! The balanced equation is 2H₂ + O₂ → 2H₂O, and you need 6 hydrogen molecules for 3 oxygen molecules (2:1 ratio).', true);
             } else if (aCorrect) {
                 setFeedback('pq14-feedback', 'Your equation (2H₂ + O₂ → 2H₂O) is correct, but check your calculation for part b. For each 1 O₂, you need 2 H₂.', false);
             } else if (bCorrect) {
                 setFeedback('pq14-feedback', 'Your calculation (6) is correct, but check your balanced equation (should be 2H₂ + O₂ → 2H₂O).', false);
             } else {
                 setFeedback('pq14-feedback', 'Try again on both parts. First balance the equation, then use the ratio from the coefficients to find how many H₂ molecules are needed.', false);
             }
        }

    </script>

</body>
</html>
