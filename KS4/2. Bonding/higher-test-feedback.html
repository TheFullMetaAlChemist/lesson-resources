<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Higher Tier: Structure & Bonding - Score Tracker</title>
    <style>
        :root {
            --primary: #4f46e5;
            --success: #16a34a;
            --danger: #dc2626;
            --warning: #ca8a04;
            --bg: #f8fafc;
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background-color: var(--bg);
            color: #1e293b;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }

        .container { max-width: 900px; margin: 0 auto; }

        header {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            text-align: center;
            border-top: 6px solid var(--primary);
            position: relative;
        }

        h1 { margin: 0; color: var(--primary); }
        .subtitle { color: #64748b; margin-top: 10px; }

        .btn-reset {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #f1f5f9;
            border: none;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            cursor: pointer;
            color: #64748b;
        }
        .btn-reset:hover { background: #e2e8f0; color: var(--danger); }

        .question-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 5px solid #cbd5e1;
            transition: all 0.3s ease;
        }

        .question-card.full-marks { border-left-color: var(--success); background-color: #f0fdf4; }
        .question-card.partial-marks { border-left-color: var(--warning); background-color: #fffbeb; }
        .question-card.zero-marks { border-left-color: var(--danger); background-color: #fef2f2; }

        .q-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 20px;
        }

        .q-title { font-weight: bold; font-size: 1.1rem; color: #1e293b; }
        .q-topic { 
            display: inline-block; 
            background: #e2e8f0; 
            color: #475569; 
            font-size: 0.7rem; 
            padding: 2px 8px; 
            border-radius: 4px; 
            margin-bottom: 8px;
            text-transform: uppercase;
            font-weight: 700;
        }

        .score-selector { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 10px; }
        .score-btn {
            padding: 6px 14px; border-radius: 20px; cursor: pointer; font-size: 0.85rem;
            border: 1px solid #cbd5e1; background: white; transition: all 0.2s;
            font-weight: 600; color: #64748b;
        }

        input[type="radio"] { display: none; }
        input:checked + .score-btn { background: var(--primary); color: white; border-color: var(--primary); }

        .box { padding: 14px 18px; border-radius: 8px; margin-top: 12px; font-size: 0.95rem; line-height: 1.5; }
        .model-ans { background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; }
        .explanation { background: #eff6ff; border: 1px solid #bfdbfe; color: #1e40af; }
        .misconception { background: #fff1f2; border: 1px solid #fecaca; color: #991b1b; }

        .label { font-weight: bold; display: block; margin-bottom: 6px; text-transform: uppercase; font-size: 0.7rem; letter-spacing: 0.05em; }

        .btn-finish {
            display: block; width: 100%; background: var(--primary); color: white;
            padding: 20px; border: none; border-radius: 12px; font-size: 1.25rem;
            font-weight: bold; cursor: pointer; margin: 40px 0;
            box-shadow: 0 10px 15px -3px rgba(79, 70, 229, 0.3);
        }

        #results-section {
            display: none; background: #1e293b; color: white; padding: 35px; border-radius: 16px; margin-top: 40px;
        }

        .summary-box {
            background: rgba(255,255,255,0.05);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .summary-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            font-size: 0.9rem;
        }

        .follow-up-card { background: white; color: #1e293b; padding: 25px; border-radius: 12px; margin-top: 20px; }
        
        .follow-up-task {
            border-left: 4px solid #f87171; padding: 15px; margin-bottom: 20px; background: #f8fafc; border-radius: 0 8px 8px 0;
        }

        .reveal-btn {
            background: #e2e8f0; border: none; padding: 8px 14px; border-radius: 4px;
            font-size: 0.8rem; font-weight: bold; cursor: pointer; margin-top: 12px; color: #475569;
        }

        .follow-up-ans {
            display: none; background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534;
            padding: 12px; margin-top: 12px; border-radius: 6px; font-size: 0.95rem;
        }

        .score-badge {
            font-size: 0.75rem; padding: 2px 6px; border-radius: 4px; background: #fee2e2; color: #991b1b; margin-left: 8px;
        }

        @media (max-width: 600px) {
            .q-header { flex-direction: column; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <button class="btn-reset" onclick="clearProgress()">Reset All Progress</button>
        <h1>Higher Tier Revision</h1>
        <p class="subtitle">Review the model answers, then record your marks to generate a targeted plan.</p>
    </header>

    <div id="quiz-container"></div>

    <button class="btn-finish" onclick="generateAnalysis()">Generate Targeted Revision Summary</button>

    <div id="results-section">
        <h2>Your Performance Analysis</h2>
        <div id="summary-container" class="summary-box"></div>
        <p>Specific follow-up practice for topics where you dropped marks:</p>
        <div class="follow-up-card" id="follow-up-list"></div>
    </div>
</div>

<script>
    const STORAGE_KEY = 'higher_tier_marks';

    const questionData = [
        { id: "1", topic: "Giant Covalent", max: 2, q: "Give two physical properties of diamond.", ans: "‚Ä¢ Very hard<br>‚Ä¢ Very high melting point", exp: "Giant covalent lattice with 4 strong bonds per carbon.", mis: "Saying 'shiny' or 'conducts electricity'." },
        { id: "2", topic: "State Symbols", max: 1, q: "State symbol for ammonium nitrate solution.", ans: "(aq)", exp: "Dissolved in water = aqueous.", mis: "Writing (l)." },
        { id: "3", topic: "Scientific Models", max: 1, q: "Limitation of ball-and-stick model.", ans: "Not to scale / No electrons shown.", exp: "Models simplify real-world complexity.", mis: "Saying 'it's too small'." },
        { id: "4", topic: "Ionic Bonding", max: 4, q: "Describe sodium reacting with chlorine.", ans: "Na loses 1e‚Åª; Cl gains 1e‚Åª; Transfer occurs; Ions Na‚Å∫ and Cl‚Åª form.", exp: "Electrostatic attraction between oppositely charged ions.", mis: "Saying electrons are shared." },
        { id: "5", topic: "Structure Comparison", max: 6, q: "Compare CO‚ÇÇ, MgO and SiO‚ÇÇ.", ans: "Particles (atoms vs ions); Structure (simple vs giant); Bonding (covalent vs ionic).", exp: "A 6-mark answer must bridge all three substance types.", mis: "Not making direct comparisons." },
        { id: "6", topic: "Scientific Models", max: 2, q: "Limitations of particle model for H‚ÇÇ gas.", ans: "Doesn't show diatomic molecules / No movement / No forces.", exp: "Particles are actually molecules in motion with intermolecular forces.", mis: "Generalizing 'it's not real'." },
        { id: "7", topic: "Ionic Bonding", max: 4, q: "Explain caesium reacting with oxygen.", ans: "Cs loses 1e‚Åª; O gains 2e‚Åª; 2:1 ratio; Ions Cs‚Å∫ and O¬≤‚Åª form.", exp: "Group 1 atoms always lose 1 electron to be stable.", mis: "Incorrect ratios (e.g. CsO)." },
        { id: "8", topic: "Simple Molecular", max: 3, q: "Why ammonia has a low boiling point.", ans: "Small molecules; Weak intermolecular forces; Little energy to separate.", exp: "Boiling involves molecules separating, not bonds breaking.", mis: "Saying covalent bonds are weak." },
        { id: "9", topic: "Giant Covalent", max: 3, q: "Why graphite conducts electricity.", ans: "3 bonds per C; 1 delocalised electron; Move through structure.", exp: "The free electron carries electrical charge.", mis: "Comparing it to a metal lattice." },
        { id: "10", topic: "State Symbols", max: 2, q: "Complete the equation: ZnO + 2HCl...", ans: "ZnO(s), HCl(aq), ZnCl‚ÇÇ(aq), H‚ÇÇO(l)", exp: "Metal oxides are solids; water is liquid.", mis: "Incorrectly labeling water as (aq)." },
        { id: "11", topic: "Solutions & Precipitates", max: 2, q: "Explain why solution becomes cloudy.", ans: "Sulfur formed; It is an insoluble precipitate.", exp: "Solids scatter light in a solution.", mis: "Saying a gas is produced." },
        { id: "12", topic: "Ionic Properties", max: 3, q: "Conditions for NaCl to conduct electricity.", ans: "Molten or dissolved; Ions free to move; Carry charge.", exp: "Ions are locked in solid state but mobile in liquid/solution.", mis: "Saying solid NaCl conducts." },
        { id: "13", topic: "Structure Comparison", max: 6, q: "Compare NaCl and HCl.", ans: "Bonding (Ionic vs Covalent); Structure (Giant vs Simple); Particles (Ions vs Molecules).", exp: "Contrasting types of forces is essential here.", mis: "Confusing intermolecular forces with covalent bonds." }
    ];

    const followUpData = {
        "1": { q: "<strong>Diamond & Graphite:</strong> Explain why diamond is very hard but graphite is soft, linking to bonding.", a: "Diamond has a rigid 3D lattice with 4 bonds per atom. Graphite has layers with weak forces between them." },
        "2": { q: "<strong>State Symbols:</strong> What is the difference between (aq) and (l) using an example of an acid?", a: "(l) is pure liquid; (aq) is dissolved in water." },
        "3": { q: "<strong>Models:</strong> Why is it vital to know model limitations?", a: "To avoid false assumptions about particle behavior or scale." },
        "4": { q: "<strong>Ionic:</strong> Describe magnesium reacting with oxygen. (Charges & Electrons).", a: "Mg loses 2e‚Åª to form Mg¬≤‚Å∫. O gains 2e‚Åª to form O¬≤‚Åª." },
        "5": { q: "<strong>Structure & Bonding:</strong> State the type of bonding and structure for Carbon Dioxide (CO‚ÇÇ), Magnesium Oxide (MgO), and Silicon Dioxide (SiO‚ÇÇ).", a: "‚Ä¢ <strong>CO‚ÇÇ:</strong> Covalent bonding, Simple molecular structure.<br>‚Ä¢ <strong>MgO:</strong> Ionic bonding, Giant ionic lattice.<br>‚Ä¢ <strong>SiO‚ÇÇ:</strong> Covalent bonding, Giant covalent structure." },
        "6": { q: "<strong>Gas Models:</strong> What 2 features of real gases are missing from particle models?", a: "Intermolecular forces and actual particle shape/size." },
        "7": { q: "<strong>Group 1:</strong> Why do Group 1 metals always form +1 ions?", a: "They have 1 outer electron; losing it results in a stable full shell." },
        "8": { q: "<strong>Ammonia:</strong> Why is breaking intermolecular forces easier than breaking bonds?", a: "Intermolecular forces are weak attractions; bonds are strong electrostatic forces." },
        "9": { q: "<strong>Graphite:</strong> What is a delocalised electron and why is it essential?", a: "An electron free to move through the structure to carry charge." },
        "10": { q: "<strong>Equations:</strong> Why are metal oxides usually written as (s) in acid reactions?", a: "They are insoluble bases in solid form." },
        "11": { q: "<strong>Precipitates:</strong> Define precipitate and how you recognise one.", a: "A solid formed from solutions; recognised by cloudiness." },
        "12": { q: "<strong>NaCl Conductivity:</strong> Why does molten NaCl conduct but solid doesn't?", a: "Ions are mobile in molten state but fixed in a lattice in solid state." },
        "13": { q: "<strong>NaCl vs HCl:</strong> Explain why 'Both have strong bonds' is only partly correct.", a: "Both have strong primary bonds, but HCl has weak intermolecular forces." }
    };

    function renderQuestions() {
        const container = document.getElementById('quiz-container');
        const savedData = getSavedData();
        
        questionData.forEach(q => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `card-${q.id}`;
            
            let scoreOptions = '';
            for(let i=0; i <= q.max; i++) {
                const isChecked = savedData[q.id] == i ? 'checked' : '';
                scoreOptions += `
                    <label>
                        <input type="radio" name="score-${q.id}" value="${i}" ${isChecked} onchange="saveMark('${q.id}', ${i}, ${q.max})">
                        <span class="score-btn">${i} / ${q.max}</span>
                    </label>
                `;
            }

            card.innerHTML = `
                <div class="q-header">
                    <div style="flex-grow:1">
                        <span class="q-topic">${q.topic}</span>
                        <div class="q-title">Q${q.id}: ${q.q}</div>
                        <div class="score-selector">${scoreOptions}</div>
                    </div>
                </div>
                <div class="box model-ans"><span class="label">‚úÖ Model Answer</span>${q.ans}</div>
                <div class="box explanation"><span class="label">üß† Detailed Explanation</span>${q.exp}</div>
                <div class="box misconception"><span class="label">‚ö†Ô∏è Common Misconceptions</span>${q.mis}</div>
            `;
            container.appendChild(card);
            
            // Restore visual state if previously saved
            if (savedData[q.id] !== undefined) {
                updateStyle(q.id, parseInt(savedData[q.id]), q.max);
            }
        });
    }

    function saveMark(id, score, max) {
        const data = getSavedData();
        data[id] = score;
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        updateStyle(id, score, max);
    }

    function getSavedData() {
        const saved = localStorage.getItem(STORAGE_KEY);
        return saved ? JSON.parse(saved) : {};
    }

    function clearProgress() {
        if(confirm("Are you sure you want to clear all your marks and reset the form?")) {
            localStorage.removeItem(STORAGE_KEY);
            location.reload();
        }
    }

    function updateStyle(id, score, max) {
        const el = document.getElementById(`card-${id}`);
        if (!el) return;
        el.classList.remove('full-marks', 'partial-marks', 'zero-marks');
        if (score === max) el.classList.add('full-marks');
        else if (score === 0) el.classList.add('zero-marks');
        else el.classList.add('partial-marks');
    }

    function toggle(id) {
        const d = document.getElementById('ans-'+id);
        d.style.display = d.style.display === 'block' ? 'none' : 'block';
    }

    function generateAnalysis() {
        const list = document.getElementById('follow-up-list');
        const summaryCont = document.getElementById('summary-container');
        list.innerHTML = '';
        summaryCont.innerHTML = `
            <div class="summary-item" style="font-weight:bold; border-bottom: 2px solid rgba(255,255,255,0.2)">
                <span>Sub-Topic</span><span>Marks</span><span>Success %</span>
            </div>
        `;

        const topics = {};
        const followUps = [];

        questionData.forEach(q => {
            if (!topics[q.topic]) topics[q.topic] = { totalPossible: 0, achieved: 0 };
            
            const selected = document.querySelector(`input[name="score-${q.id}"]:checked`);
            const scoreAchieved = selected ? parseInt(selected.value) : 0;
            
            topics[q.topic].totalPossible += q.max;
            topics[q.topic].achieved += scoreAchieved;

            if (scoreAchieved < q.max) {
                followUps.push({ id: q.id, lost: q.max - scoreAchieved });
            }
        });

        Object.keys(topics).forEach(t => {
            const stat = topics[t];
            const perc = Math.round((stat.achieved / stat.totalPossible) * 100);
            const div = document.createElement('div');
            div.className = 'summary-item';
            const color = perc === 100 ? '#4ade80' : (perc < 50 ? '#f87171' : '#fbbf24');
            div.innerHTML = `<span>${t}</span><span>${stat.achieved}/${stat.totalPossible}</span><span style="color:${color}; font-weight:bold">${perc}%</span>`;
            summaryCont.appendChild(div);
        });
        
        if (followUps.length === 0) {
            list.innerHTML = '<div style="text-align:center; padding:20px;">üéâ <strong>Excellent Score!</strong> You scored 100% in all categories.</div>';
        } else {
            followUps.forEach(item => {
                const f = followUpData[item.id];
                const div = document.createElement('div');
                div.className = 'follow-up-task';
                div.innerHTML = `
                    <span style="font-weight:bold; color:var(--danger)">REVISION TASK FOR Q${item.id} <span class="score-badge">Lost ${item.lost} mark(s)</span></span>
                    <div style="margin-top:10px; border-top:1px solid #e2e8f0; padding-top:10px;">${f.q}</div>
                    <button class="reveal-btn" onclick="toggle('${item.id}')">üëÅÔ∏è Reveal Model Answer</button>
                    <div class="follow-up-ans" id="ans-${item.id}">
                        <span class="label">Expert Check</span>
                        ${f.a}
                    </div>
                `;
                list.appendChild(div);
            });
        }
        document.getElementById('results-section').style.display = 'block';
        window.scrollTo({ top: document.getElementById('results-section').offsetTop - 20, behavior: 'smooth' });
    }

    window.onload = renderQuestions;
</script>

</body>
</html>
