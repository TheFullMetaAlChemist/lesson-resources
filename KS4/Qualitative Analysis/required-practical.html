<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemical Tests for Ions - GCSE Chemistry</title>
    <style>
        :root {
            --primary: #1e88e5;
            --primary-dark: #1565c0;
            --secondary: #ff8f00;
            --success: #43a047;
            --danger: #e53935;
            --light: #f5f5f5;
            --dark: #212121;
            --white: #ffffff;
            
            /* Variables for improved visibility */
            --colorless-solution: #f1f5f9;
            --solution-border: #d0d7de;
            --white-precipitate: #ffffff;
            --precipitate-shadow: rgba(0, 0, 0, 0.1);
            --test-tube-glass: rgba(240, 240, 240, 0.5);
            --test-tube-border: #adb5bd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f0f0;
            color: var(--dark);
            line-height: 1.6;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        h2 {
            font-size: 1.8rem;
            margin: 20px 0 15px;
            color: var(--primary-dark);
        }
        
        h3 {
            font-size: 1.5rem;
            margin: 15px 0 10px;
            color: var(--primary);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        .nav-btn:hover {
            background-color: var(--primary-dark);
        }
        
        .nav-btn.active {
            background-color: var(--secondary);
        }
        
        .section {
            background-color: var(--white);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .card {
            background-color: var(--light);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .tab-container {
            margin: 20px 0;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background-color: var(--light);
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .tab-btn:hover {
            background-color: #e0e0e0;
        }
        
        .tab-btn.active {
            background-color: var(--white);
            border-bottom: 3px solid var(--primary);
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            background-color: var(--white);
            border-radius: 0 0 8px 8px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .info-box {
            background-color: #e3f2fd;
            border-left: 4px solid var(--primary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .warning-box {
            background-color: #fff3e0;
            border-left: 4px solid var(--secondary);
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .equation {
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 4px;
            margin: 15px 0;
            text-align: center;
            font-family: 'Courier New', Courier, monospace;
        }
        
        .reaction {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .reaction-element {
            margin: 0 10px;
            text-align: center;
        }
        
        .plus, .arrow {
            font-size: 24px;
            margin: 0 10px;
        }
        
        .quiz-container {
            margin: 20px 0;
        }
        
        .question {
            margin-bottom: 20px;
        }
        
        .options {
            margin-top: 10px;
        }
        
        .option {
            display: block;
            padding: 10px;
            margin: 8px 0;
            background-color: var(--light);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .option:hover {
            background-color: #e0e0e0;
        }
        
        .option.selected {
            background-color: #bbdefb;
            border-left: 4px solid var(--primary);
        }
        
        .option.correct {
            background-color: #c8e6c9;
            border-left: 4px solid var(--success);
        }
        
        .option.incorrect {
            background-color: #ffcdd2;
            border-left: 4px solid var(--danger);
        }
        
        .button {
            padding: 10px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
            margin-top: 10px;
            margin-right: 5px;
        }
        
        .button:hover {
            background-color: var(--primary-dark);
        }
        
        .button.secondary {
            background-color: var(--secondary);
        }
        
        .button.secondary:hover {
            background-color: #f57c00;
        }
        
        .button.reset {
            background-color: #757575;
        }
        
        .button.reset:hover {
            background-color: #616161;
        }
        
        .result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        
        .result.success {
            display: block;
            background-color: #c8e6c9;
            border-left: 4px solid var(--success);
        }
        
        .result.error {
            display: block;
            background-color: #ffcdd2;
            border-left: 4px solid var(--danger);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            overflow-x: auto;
            display: block;
        }
        
        @media (min-width: 768px) {
            table {
                display: table;
            }
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--primary);
            color: white;
        }
        
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .practical-container {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .chemical-display {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 10px auto;
            border: 2px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        /* Enhanced test tube styles */
        .test-tube {
            width: 40px;
            height: 120px;
            background-color: var(--test-tube-glass);
            border: 2px solid var(--test-tube-border);
            border-radius: 0 0 20px 20px;
            position: relative;
            margin: 10px auto;
            display: flex;
            flex-direction: column-reverse;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.5), 
                        2px 2px 5px rgba(0, 0, 0, 0.1);
            /* Glass reflection effect */
            overflow: hidden;
        }

        .test-tube::after {
            content: '';
            position: absolute;
            top: 0;
            left: 5px;
            width: 10px;
            height: 100%;
            background: linear-gradient(90deg, 
                                      rgba(255,255,255,0.5) 0%, 
                                      rgba(255,255,255,0) 100%);
            border-radius: 0 0 10px 10px;
            pointer-events: none;
        }
        
        .test-tube-content {
            width: 100%;
            height: 70%;
            border-radius: 0 0 18px 18px;
            position: relative;
            border-top: 1px solid var(--solution-border);
        }

        /* Clear solution style */
        .solution-clear {
            background-color: var(--colorless-solution);
            background-image: 
                radial-gradient(circle, rgba(255,255,255,0.7) 1px, transparent 1px),
                radial-gradient(circle, rgba(255,255,255,0.7) 1px, transparent 1px);
            background-size: 10px 10px;
            background-position: 0 0, 5px 5px;
        }

        /* White precipitate style */
        .precipitate-white {
            background-color: var(--white-precipitate);
            box-shadow: inset 0 0 10px var(--precipitate-shadow);
            background-image: 
                radial-gradient(circle, rgba(0,0,0,0.05) 1px, transparent 1px),
                radial-gradient(circle, rgba(0,0,0,0.05) 1px, transparent 1px);
            background-size: 8px 8px;
            background-position: 0 0, 4px 4px;
        }
        
        .flame {
            width: 30px;
            height: 60px;
            margin: 10px auto;
            position: relative;
            transform-origin: center bottom;
        }
        
        .flame-inner {
            position: absolute;
            bottom: 0;
            left: 5px;
            width: 20px;
            height: 50px;
            border-radius: 50% 50% 20% 20% / 40% 40% 60% 60%;
        }
        
        /* Hide sections initially */
        #tutorialMode, #practiceMode, #requiredPractical {
            display: none;
        }
        
        .drag-container {
            margin: 20px 0;
            border: 2px dashed #ccc;
            padding: 20px;
            min-height: 200px;
            border-radius: 8px;
        }
        
        .drag-item {
            padding: 10px;
            margin: 5px;
            background-color: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 4px;
            cursor: grab;
            display: inline-block;
        }
        
        .drop-area {
            border: 2px solid #ccc;
            padding: 10px;
            min-height: 50px;
            margin: 10px 0;
            border-radius: 4px;
        }
        
        .hidden {
            display: none;
        }
        
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 0%;
            height: 10px;
            background-color: var(--primary);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        
        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }
        
        #practicalSimulator {
            border: 2px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        /* Bubbling animation styles */
        @keyframes bubbleRise {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-40px); opacity: 0; }
        }

        .bubble {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            box-shadow: 0 0 2px rgba(0, 0, 0, 0.2);
            animation: bubbleRise 2s infinite;
        }

        /* Cloud formation in limewater */
        @keyframes cloudyFormation {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .cloudy-effect {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.7);
            animation: cloudyFormation 2s ease-in;
            border-radius: 0 0 18px 18px;
            background-image: 
                radial-gradient(circle, rgba(255,255,255,0.8) 2px, transparent 2px),
                radial-gradient(circle, rgba(255,255,255,0.8) 1px, transparent 1px);
            background-size: 8px 8px;
            background-position: 0 0, 4px 4px;
        }

        /* Precipitation animation */
        @keyframes precipitateForm {
            0% { height: 0%; opacity: 0; }
            100% { height: 100%; opacity: 1; }
        }

        .precipitate-forming {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 0%;
            border-radius: 0 0 18px 18px;
            animation: precipitateForm 2s forwards;
        }

        /* Flame flicker animation */
        @keyframes flicker {
            0% { opacity: 0.8; height: 60px; }
            50% { opacity: 1; height: 55px; }
            100% { opacity: 0.9; height: 65px; }
        }

        .flame-animation {
            animation: flicker 0.5s ease-in-out infinite alternate;
        }

        /* Enhanced container for animations */
        .animation-container {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
        }

        /* Animation controls */
        .animation-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .reaction {
                flex-direction: column;
                align-items: center;
            }
            
            .plus, .arrow {
                margin: 5px 0;
            }
            
            .tab-buttons {
                flex-direction: column;
                align-items: stretch;
            }
            
            .tab-btn {
                border-bottom: 1px solid #ddd;
            }
            
            .tab-btn.active {
                border-bottom: 3px solid var(--primary);
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Chemical Tests for Ions - GCSE Chemistry</h1>
        <p>Learn how to identify negative and positive ions through chemical tests</p>
    </header>
    
    <div class="container">
        <div class="navigation">
            <button class="nav-btn active" data-target="tutorialMode">Tutorial Mode</button>
            <button class="nav-btn" data-target="practiceMode">Practice Mode</button>
            <button class="nav-btn" data-target="requiredPractical">Required Practical</button>
        </div>
        
        <div id="tutorialMode" class="mode-section">
            <div class="section">
                <h2>Introduction to Testing for Ions</h2>
                <p>Chemical tests are an important way to identify the presence of specific ions in compounds. In this tutorial, we'll learn about tests for:</p>
                <ul>
                    <li>Negative ions (anions): carbonates, halides, and sulfates</li>
                    <li>Positive ions (cations): using flame tests and sodium hydroxide</li>
                </ul>
                
                <div class="info-box">
                    <p><strong>Safety Note:</strong> Always wear eye protection when performing chemical tests. Some reactions produce gases or involve corrosive substances.</p>
                </div>
                
                <div class="navigation" style="margin-top: 20px;">
                    <button class="button tutorial-nav active" data-section="anionTests">Anion Tests</button>
                    <button class="button tutorial-nav" data-section="cationTests">Cation Tests</button>
                    <button class="button tutorial-nav" data-section="testSummary">Summary</button>
                </div>
            </div>
            
            <!-- ANION TESTS SECTION -->
            <div id="anionTests" class="tutorial-section">
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="carbonates">Carbonates</button>
                        <button class="tab-btn" data-tab="halides">Halides</button>
                        <button class="tab-btn" data-tab="sulfates">Sulfates</button>
                    </div>
                    
                    <div id="carbonates" class="tab-content active">
                        <h3>Testing for Carbonates</h3>
                        <p>Carbonates react with dilute acids to form carbon dioxide gas, which can be identified using limewater.</p>
                        
                        <div class="card">
                            <h4>The Test:</h4>
                            <ol>
                                <li>Add dilute acid (e.g., hydrochloric acid) to the suspected carbonate</li>
                                <li>If carbon dioxide is produced, the solution will fizz/effervesce</li>
                                <li>The gas can be collected and bubbled through limewater</li>
                                <li>If the limewater turns cloudy/milky white, carbon dioxide is confirmed</li>
                            </ol>
                        </div>
                        
                        <div class="equation">
                            Carbonate + Acid → Salt + Water + Carbon Dioxide<br>
                            CO<sub>3</sub><sup>2-</sup>(aq) + 2H<sup>+</sup>(aq) → CO<sub>2</sub>(g) + H<sub>2</sub>O(l)
                        </div>
                        
                        <div class="reaction">
                            <div class="reaction-element">
                                <div class="test-tube">
                                    <div class="test-tube-content solution-clear" style="background-color: #f2f2f2;"></div>
                                </div>
                                <p>Carbonate</p>
                            </div>
                            <div class="plus">+</div>
                            <div class="reaction-element">
                                <div class="test-tube">
                                    <div class="test-tube-content" style="background-color: #ffecb3;"></div>
                                </div>
                                <p>Dilute Acid</p>
                            </div>
                            <div class="arrow">→</div>
                            <div class="reaction-element">
                                <div class="test-tube">
                                    <div class="test-tube-content" style="background-color: #ffecb3; position: relative;">
                                        <div class="bubble" style="width: 8px; height: 8px; left: 25%; top: 70%;"></div>
                                        <div class="bubble" style="width: 6px; height: 6px; left: 40%; top: 50%; animation-delay: 0.3s;"></div>
                                        <div class="bubble" style="width: 10px; height: 10px; left: 15%; top: 30%; animation-delay: 0.7s;"></div>
                                    </div>
                                </div>
                                <p>Gas Bubbles</p>
                            </div>
                        </div>
                        
                        <div class="info-box">
                            <p><strong>Example:</strong> If the carbonate is magnesium carbonate, the reaction with hydrochloric acid would be:</p>
                            <p>MgCO<sub>3</sub>(s) + 2HCl(aq) → MgCl<sub>2</sub>(aq) + H<sub>2</sub>O(l) + CO<sub>2</sub>(g)</p>
                        </div>
                        
                        <div class="animation-controls">
                            <button class="button show-animation" data-animation="carbonateTest">Show Animation</button>
                            <button class="button reset reset-animation" data-animation="carbonateTest" style="display: none;">Reset Animation</button>
                        </div>
                        
                        <div id="carbonateAnimation" class="animation-container" style="display: none;">
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div class="test-tube" style="position: relative;">
                                        <div id="carbTestTube" class="test-tube-content solution-clear" style="height: 70%;"></div>
                                        <div id="carbBubbles" style="display: none; position: absolute; top: 30%; width: 100%;">
                                            <div class="bubble" style="width: 8px; height: 8px; left: 25%; top: 70%;"></div>
                                            <div class="bubble" style="width: 6px; height: 6px; left: 40%; top: 50%; animation-delay: 0.3s;"></div>
                                            <div class="bubble" style="width: 10px; height: 10px; left: 15%; top: 30%; animation-delay: 0.7s;"></div>
                                        </div>
                                    </div>
                                    <p>1. Carbonate + Acid</p>
                                </div>
                                
                                <div class="arrow">→</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube" style="position: relative;">
                                        <div id="limeWaterTube" class="test-tube-content solution-clear" style="height: 70%;"></div>
                                    </div>
                                    <p>2. Limewater</p>
                                </div>
                            </div>
                            <div id="animationExplanation" style="margin-top: 15px; font-weight: bold; text-align: center;">
                                Step 1: Adding acid to carbonate
                            </div>
                        </div>
                    </div>
                    
                    <div id="halides" class="tab-content">
                        <h3>Testing for Halide Ions</h3>
                        <p>Halide ions (chloride, bromide, and iodide) in solution produce precipitates with silver nitrate solution in the presence of dilute nitric acid.</p>
                        
                        <div class="card">
                            <h4>The Test:</h4>
                            <ol>
                                <li>Add dilute nitric acid to the solution (to remove any carbonate ions)</li>
                                <li>Add silver nitrate solution</li>
                                <li>Observe the color of the precipitate formed</li>
                            </ol>
                        </div>
                        
                        <table>
                            <tr>
                                <th>Halide Ion</th>
                                <th>Appearance of Precipitate</th>
                                <th>Chemical Equation</th>
                            </tr>
                            <tr>
                                <td>Chloride (Cl<sup>-</sup>)</td>
                                <td>White precipitate</td>
                                <td>Ag<sup>+</sup>(aq) + Cl<sup>-</sup>(aq) → AgCl(s)</td>
                            </tr>
                            <tr>
                                <td>Bromide (Br<sup>-</sup>)</td>
                                <td>Cream precipitate</td>
                                <td>Ag<sup>+</sup>(aq) + Br<sup>-</sup>(aq) → AgBr(s)</td>
                            </tr>
                            <tr>
                                <td>Iodide (I<sup>-</sup>)</td>
                                <td>Yellow precipitate</td>
                                <td>Ag<sup>+</sup>(aq) + I<sup>-</sup>(aq) → AgI(s)</td>
                            </tr>
                        </table>
                        
                        <div class="warning-box">
                            <p><strong>Important:</strong> The nitric acid is added first to prevent interferences from carbonate ions, which would also form a precipitate with silver nitrate.</p>
                        </div>
                        
                        <div class="animation-controls">
                            <button class="button" onclick="showHalideAnimation('chloride')">Show Chloride Test</button>
                            <button class="button" onclick="showHalideAnimation('bromide')">Show Bromide Test</button>
                            <button class="button" onclick="showHalideAnimation('iodide')">Show Iodide Test</button>
                            <button class="button reset" onclick="resetHalideAnimation()" style="display: none;" id="resetHalideBtn">Reset Animation</button>
                        </div>
                        
                        <div id="halideAnimation" class="animation-container" style="display: none;">
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div id="halideStartTube" class="test-tube-content solution-clear" style="height: 70%;"></div>
                                    </div>
                                    <p>Halide Solution</p>
                                </div>
                                
                                <div class="plus">+</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content solution-clear" style="height: 70%;">
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #666; font-size: 12px; font-weight: bold;">HNO<sub>3</sub></div>
                                        </div>
                                    </div>
                                    <p>Nitric Acid</p>
                                </div>
                                
                                <div class="plus">+</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content solution-clear" style="height: 70%;">
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #666; font-size: 12px; font-weight: bold;">AgNO<sub>3</sub></div>
                                        </div>
                                    </div>
                                    <p>Silver Nitrate</p>
                                </div>
                                
                                <div class="arrow">→</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div id="halidePrecipitate" class="test-tube-content solution-clear" style="height: 70%; transition: background-color 1.5s ease; position: relative;"></div>
                                    </div>
                                    <p id="precipitateLabel">Precipitate Forms</p>
                                </div>
                            </div>
                            <div id="halideAnimationExplanation" style="margin-top: 15px; text-align: center; font-weight: bold;">
                            </div>
                        </div>
                    </div>
                    
                    <div id="sulfates" class="tab-content">
                        <h3>Testing for Sulfate Ions</h3>
                        <p>Sulfate ions in solution produce a white precipitate with barium chloride solution in the presence of dilute hydrochloric acid.</p>
                        
                        <div class="card">
                            <h4>The Test:</h4>
                            <ol>
                                <li>Add dilute hydrochloric acid to the solution (to remove carbonate ions)</li>
                                <li>Add barium chloride solution</li>
                                <li>A white precipitate of barium sulfate indicates the presence of sulfate ions</li>
                            </ol>
                        </div>
                        
                        <div class="equation">
                            Ba<sup>2+</sup>(aq) + SO<sub>4</sub><sup>2-</sup>(aq) → BaSO<sub>4</sub>(s)
                        </div>
                        
                        <div class="info-box">
                            <p><strong>Example:</strong> If the unknown compound was potassium sulfate, the equation for the precipitation reaction would be:</p>
                            <p>K<sub>2</sub>SO<sub>4</sub>(aq) + BaCl<sub>2</sub>(aq) → 2KCl(aq) + BaSO<sub>4</sub>(s)</p>
                        </div>
                        
                        <div class="warning-box">
                            <p><strong>Important:</strong> Do not add sulfuric acid when testing for sulfate ions as it contains sulfate ions!</p>
                        </div>
                        
                        <div class="animation-controls">
                            <button class="button show-animation" data-animation="sulfateTest">Show Animation</button>
                            <button class="button reset reset-animation" data-animation="sulfateTest" style="display: none;">Reset Animation</button>
                        </div>
                        
                        <div id="sulfateAnimation" class="animation-container" style="display: none;">
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content solution-clear" style="height: 70%; background-color: #e3f2fd;">
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #1565c0; font-size: 12px; font-weight: bold;">SO<sub>4</sub><sup>2-</sup></div>
                                        </div>
                                    </div>
                                    <p>Sulfate Solution</p>
                                </div>
                                
                                <div class="plus">+</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content solution-clear" style="height: 70%;">
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #666; font-size: 12px; font-weight: bold;">HCl</div>
                                        </div>
                                    </div>
                                    <p>Hydrochloric Acid</p>
                                </div>
                                
                                <div class="plus">+</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content solution-clear" style="height: 70%;">
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #666; font-size: 12px; font-weight: bold;">BaCl<sub>2</sub></div>
                                        </div>
                                    </div>
                                    <p>Barium Chloride</p>
                                </div>
                                
                                <div class="arrow">→</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div id="sulfatePrecipitate" class="test-tube-content solution-clear" style="height: 70%; position: relative; transition: all 1.5s ease;"></div>
                                    </div>
                                    <p>Precipitate Forms</p>
                                </div>
                            </div>
                            <div id="sulfateAnimationExplanation" style="margin-top: 15px; text-align: center; font-weight: bold;">
                                Step 1: Starting with the sulfate solution
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- CATION TESTS SECTION -->
            <div id="cationTests" class="tutorial-section" style="display: none;">
                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="flameTests">Flame Tests</button>
                        <button class="tab-btn" data-tab="naohTests">Sodium Hydroxide Tests</button>
                    </div>
                    
                    <div id="flameTests" class="tab-content active">
                        <h3>Flame Tests for Positive Ions (Cations)</h3>
                        <p>Flame tests can be used to identify some metal ions based on the characteristic color they produce when heated in a flame.</p>
                        
                        <table>
                            <tr>
                                <th>Metal Ion</th>
                                <th>Flame Color</th>
                                <th>Chemical Behind Color</th>
                            </tr>
                            <tr>
                                <td>Lithium (Li<sup>+</sup>)</td>
                                <td>Crimson red</td>
                                <td>Li atoms emit red light (670 nm)</td>
                            </tr>
                            <tr>
                                <td>Sodium (Na<sup>+</sup>)</td>
                                <td>Yellow</td>
                                <td>Na atoms emit yellow light (589 nm)</td>
                            </tr>
                            <tr>
                                <td>Potassium (K<sup>+</sup>)</td>
                                <td>Lilac</td>
                                <td>K atoms emit violet light with mix of wavelengths</td>
                            </tr>
                            <tr>
                                <td>Calcium (Ca<sup>2+</sup>)</td>
                                <td>Orange-red</td>
                                <td>Ca atoms emit orange-red light</td>
                            </tr>
                            <tr>
                                <td>Copper(II) (Cu<sup>2+</sup>)</td>
                                <td>Green</td>
                                <td>Cu atoms emit green light</td>
                            </tr>
                        </table>
                        
                        <div class="warning-box">
                            <p><strong>Note:</strong> If a sample contains a mixture of ions, some flame colors can be masked. For example, the bright yellow of sodium can mask other colors.</p>
                        </div>
                        
                        <div class="animation-controls">
                            <button class="button" onclick="showFlameTestAnimation('lithium')">Lithium</button>
                            <button class="button" onclick="showFlameTestAnimation('sodium')">Sodium</button>
                            <button class="button" onclick="showFlameTestAnimation('potassium')">Potassium</button>
                            <button class="button" onclick="showFlameTestAnimation('calcium')">Calcium</button>
                            <button class="button" onclick="showFlameTestAnimation('copper')">Copper</button>
                            <button class="button reset" onclick="resetFlameAnimation()" style="display: none;" id="resetFlameBtn">Reset</button>
                        </div>
                        
                        <div id="flameTestAnimation" class="animation-container" style="display: none;">
                            <div style="display: flex; justify-content: center; align-items: center; gap: 40px; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div id="wireLoopContainer" style="width: 40px; height: 80px; position: relative;">
                                        <div style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 2px; height: 60px; background-color: #9e9e9e;"></div>
                                        <div style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 10px; height: 10px; border-radius: 50%; background-color: #f5f5f5; border: 1px solid #ddd;"></div>
                                    </div>
                                    <p>Nichrome Wire Loop<br>with Sample</p>
                                </div>
                                
                                <div class="arrow">→</div>
                                
                                <div style="text-align: center;">
                                    <div class="flame" style="width: 60px; height: 100px; position: relative;">
                                        <div style="position: absolute; bottom: 0; left: 10px; width: 40px; height: 80px; background-color: #f57c00; border-radius: 40% 40% 20% 20% / 60% 60% 40% 40%; opacity: 0.7;"></div>
                                        <div id="flameColorAnimation" class="flame-inner" style="position: absolute; bottom: 10px; left: 15px; width: 30px; height: 60px; border-radius: 50% 50% 20% 20% / 40% 40% 60% 60%; background-color: #ffffff; transition: background-color 1s ease;"></div>
                                    </div>
                                    <p>Flame Test</p>
                                </div>
                            </div>
                            <div id="flameTestExplanation" style="margin-top: 15px; font-weight: bold; text-align: center;">
                                Preparing to insert sample into flame
                            </div>
                        </div>
                    </div>
                    
                    <div id="naohTests" class="tab-content">
                        <h3>Sodium Hydroxide Tests for Metal Ions</h3>
                        <p>Sodium hydroxide solution can be used to identify some metal ions based on the color and properties of the precipitate formed.</p>
                        
                        <table>
                            <tr>
                                <th>Metal Ion</th>
                                <th>Chemical Formula</th>
                                <th>Precipitate with NaOH</th>
                                <th>With Excess NaOH</th>
                            </tr>
                            <tr>
                                <td>Aluminum (Al<sup>3+</sup>)</td>
                                <td>Al(OH)<sub>3</sub></td>
                                <td>White precipitate</td>
                                <td>Dissolves to form colorless solution</td>
                            </tr>
                            <tr>
                                <td>Calcium (Ca<sup>2+</sup>)</td>
                                <td>Ca(OH)<sub>2</sub></td>
                                <td>White precipitate</td>
                                <td>Does not dissolve</td>
                            </tr>
                            <tr>
                                <td>Magnesium (Mg<sup>2+</sup>)</td>
                                <td>Mg(OH)<sub>2</sub></td>
                                <td>White precipitate</td>
                                <td>Does not dissolve</td>
                            </tr>
                            <tr>
                                <td>Copper(II) (Cu<sup>2+</sup>)</td>
                                <td>Cu(OH)<sub>2</sub></td>
                                <td>Blue precipitate</td>
                                <td>Does not dissolve</td>
                            </tr>
                            <tr>
                                <td>Iron(II) (Fe<sup>2+</sup>)</td>
                                <td>Fe(OH)<sub>2</sub></td>
                                <td>Green precipitate</td>
                                <td>Does not dissolve</td>
                            </tr>
                            <tr>
                                <td>Iron(III) (Fe<sup>3+</sup>)</td>
                                <td>Fe(OH)<sub>3</sub></td>
                                <td>Brown precipitate</td>
                                <td>Does not dissolve</td>
                            </tr>
                        </table>
                        
                        <div class="info-box">
                            <p><strong>Key Distinction:</strong> Aluminum hydroxide is the only precipitate that dissolves in excess sodium hydroxide, which can help identify aluminum ions.</p>
                            <p>The equation for this reaction is:</p>
                            <p>Al(OH)<sub>3</sub>(s) + NaOH(aq) → Na[Al(OH)<sub>4</sub>](aq)</p>
                        </div>
                        
                        <div class="animation-controls">
                            <button class="button" onclick="showNaOHAnimation('aluminum')">Aluminum</button>
                            <button class="button" onclick="showNaOHAnimation('calcium')">Calcium</button>
                            <button class="button" onclick="showNaOHAnimation('magnesium')">Magnesium</button>
                            <button class="button" onclick="showNaOHAnimation('copper')">Copper(II)</button>
                            <button class="button" onclick="showNaOHAnimation('iron2')">Iron(II)</button>
                            <button class="button" onclick="showNaOHAnimation('iron3')">Iron(III)</button>
                            <button class="button reset" onclick="resetNaOHAnimation()" style="display: none;" id="resetNaOHBtn">Reset</button>
                        </div>
                        
                        <div id="naohAnimation" class="animation-container" style="display: none;">
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div id="ionSolution" class="test-tube-content solution-clear" style="height: 70%; transition: background-color 1s ease;"></div>
                                    </div>
                                    <p id="ionSolutionLabel">Metal Ion Solution</p>
                                </div>
                                
                                <div class="plus">+</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content solution-clear" style="height: 70%;">
                                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #666; font-size: 12px; font-weight: bold;">NaOH</div>
                                        </div>
                                    </div>
                                    <p>Sodium Hydroxide</p>
                                </div>
                                
                                <div class="arrow">→</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div id="naohPrecipitate" class="test-tube-content solution-clear" style="height: 70%; position: relative; transition: all 1s ease;"></div>
                                    </div>
                                    <p>Initial Precipitate</p>
                                </div>
                                
                                <div class="arrow">→</div>
                                
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div id="excessNaohResult" class="test-tube-content solution-clear" style="height: 70%; position: relative; transition: all 1s ease;"></div>
                                    </div>
                                    <p>With Excess NaOH</p>
                                </div>
                            </div>
                            <div id="naohAnimationExplanation" style="margin-top: 15px; text-align: center; font-weight: bold;">
                                Step 1: Starting with the metal ion solution
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- SUMMARY SECTION -->
            <div id="testSummary" class="tutorial-section" style="display: none;">
                <div class="section">
                    <h3>Comprehensive Summary of Chemical Tests for Ions</h3>
                    <p>This summary provides a detailed reference for all the chemical tests covered in the tutorial.</p>
                    
                    <div class="card">
                        <h4>Tests for Carbonate Ions (CO<sub>3</sub><sup>2-</sup>)</h4>
                        <ul>
                            <li><strong>Reagent:</strong> Dilute acid (e.g., HCl, H<sub>2</sub>SO<sub>4</sub>, HNO<sub>3</sub>)</li>
                            <li><strong>Observation:</strong> Effervescence (bubbling) due to CO<sub>2</sub> gas production</li>
                            <li><strong>Confirmation:</strong> CO<sub>2</sub> gas turns limewater (Ca(OH)<sub>2</sub> solution) cloudy/milky</li>
                            <li><strong>Chemical Equations:</strong>
                                <ul>
                                    <li>CO<sub>3</sub><sup>2-</sup>(aq) + 2H<sup>+</sup>(aq) → CO<sub>2</sub>(g) + H<sub>2</sub>O(l)</li>
                                    <li>Ca(OH)<sub>2</sub>(aq) + CO<sub>2</sub>(g) → CaCO<sub>3</sub>(s) + H<sub>2</sub>O(l)</li>
                                </ul>
                            </li>
                            <li><strong>Common Examples:</strong> 
                                <ul>
                                    <li>CaCO<sub>3</sub>(s) + 2HCl(aq) → CaCl<sub>2</sub>(aq) + H<sub>2</sub>O(l) + CO<sub>2</sub>(g)</li>
                                    <li>Na<sub>2</sub>CO<sub>3</sub>(s) + 2HCl(aq) → 2NaCl(aq) + H<sub>2</sub>O(l) + CO<sub>2</sub>(g)</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h4>Tests for Halide Ions (Cl<sup>-</sup>, Br<sup>-</sup>, I<sup>-</sup>)</h4>
                        <ul>
                            <li><strong>Reagents:</strong> Dilute nitric acid followed by silver nitrate solution</li>
                            <li><strong>Observations:</strong> 
                                <ul>
                                    <li>Chloride (Cl<sup>-</sup>): White precipitate of AgCl</li>
                                    <li>Bromide (Br<sup>-</sup>): Cream precipitate of AgBr</li>
                                    <li>Iodide (I<sup>-</sup>): Yellow precipitate of AgI</li>
                                </ul>
                            </li>
                            <li><strong>Reason for Nitric Acid:</strong> To remove carbonate ions that would also form a precipitate with silver nitrate</li>
                            <li><strong>Chemical Equations:</strong>
                                <ul>
                                    <li>Ag<sup>+</sup>(aq) + Cl<sup>-</sup>(aq) → AgCl(s)</li>
                                    <li>Ag<sup>+</sup>(aq) + Br<sup>-</sup>(aq) → AgBr(s)</li>
                                    <li>Ag<sup>+</sup>(aq) + I<sup>-</sup>(aq) → AgI(s)</li>
                                </ul>
                            </li>
                            <li><strong>Solubility Patterns:</strong> The silver halides are insoluble in water but have different solubilities in ammonia:
                                <ul>
                                    <li>AgCl dissolves in dilute ammonia</li>
                                    <li>AgBr dissolves in concentrated ammonia</li>
                                    <li>AgI is insoluble in ammonia (additional distinguishing test)</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h4>Tests for Sulfate Ions (SO<sub>4</sub><sup>2-</sup>)</h4>
                        <ul>
                            <li><strong>Reagents:</strong> Dilute hydrochloric acid followed by barium chloride solution</li>
                            <li><strong>Observation:</strong> White precipitate of barium sulfate (BaSO<sub>4</sub>)</li>
                            <li><strong>Reason for Hydrochloric Acid:</strong> To remove carbonate ions that would also form a precipitate with barium chloride</li>
                            <li><strong>Chemical Equation:</strong> Ba<sup>2+</sup>(aq) + SO<sub>4</sub><sup>2-</sup>(aq) → BaSO<sub>4</sub>(s)</li>
                            <li><strong>Common Examples:</strong>
                                <ul>
                                    <li>K<sub>2</sub>SO<sub>4</sub>(aq) + BaCl<sub>2</sub>(aq) → 2KCl(aq) + BaSO<sub>4</sub>(s)</li>
                                    <li>(NH<sub>4</sub>)<sub>2</sub>SO<sub>4</sub>(aq) + BaCl<sub>2</sub>(aq) → 2NH<sub>4</sub>Cl(aq) + BaSO<sub>4</sub>(s)</li>
                                </ul>
                            </li>
                            <li><strong>Important Note:</strong> Never use sulfuric acid when testing for sulfate ions, as it contains sulfate ions itself</li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h4>Flame Tests for Metal Ions</h4>
                        <ul>
                            <li><strong>Method:</strong> Clean platinum/nichrome wire loop is dipped in sample and held in hot Bunsen flame</li>
                            <li><strong>Principle:</strong> Metal ions emit light of characteristic wavelengths when heated to high temperatures</li>
                            <li><strong>Characteristic Colors:</strong>
                                <ul>
                                    <li>Lithium (Li<sup>+</sup>) - Crimson red flame</li>
                                    <li>Sodium (Na<sup>+</sup>) - Bright yellow flame</li>
                                    <li>Potassium (K<sup>+</sup>) - Lilac flame</li>
                                    <li>Calcium (Ca<sup>2+</sup>) - Orange-red flame</li>
                                    <li>Copper(II) (Cu<sup>2+</sup>) - Green/blue-green flame</li>
                                </ul>
                            </li>
                            <li><strong>Limitations:</strong> Sodium contamination can mask other colors due to its intense yellow flame. Some metals give similar colors and may be difficult to distinguish.</li>
                        </ul>
                    </div>
                    
                    <div class="card">
                        <h4>Sodium Hydroxide Tests for Metal Ions</h4>
                        <ul>
                            <li><strong>Method:</strong> Add sodium hydroxide solution to test solution, then observe color and properties of precipitate</li>
                            <li><strong>Key Reactions:</strong>
                                <ul>
                                    <li>Aluminum (Al<sup>3+</sup>) + 3OH<sup>-</sup> → Al(OH)<sub>3</sub>(s) [white precipitate]
                                        <ul>
                                            <li>Dissolves in excess NaOH: Al(OH)<sub>3</sub>(s) + OH<sup>-</sup>(aq) → [Al(OH)<sub>4</sub>]<sup>-</sup>(aq)</li>
                                        </ul>
                                    </li>
                                    <li>Calcium (Ca<sup>2+</sup>) + 2OH<sup>-</sup> → Ca(OH)<sub>2</sub>(s) [white precipitate, does not dissolve in excess NaOH]</li>
                                    <li>Magnesium (Mg<sup>2+</sup>) + 2OH<sup>-</sup> → Mg(OH)<sub>2</sub>(s) [white precipitate, does not dissolve in excess NaOH]</li>
                                    <li>Copper(II) (Cu<sup>2+</sup>) + 2OH<sup>-</sup> → Cu(OH)<sub>2</sub>(s) [blue precipitate, does not dissolve in excess NaOH]</li>
                                    <li>Iron(II) (Fe<sup>2+</sup>) + 2OH<sup>-</sup> → Fe(OH)<sub>2</sub>(s) [green precipitate, does not dissolve in excess NaOH]</li>
                                    <li>Iron(III) (Fe<sup>3+</sup>) + 3OH<sup>-</sup> → Fe(OH)<sub>3</sub>(s) [brown precipitate, does not dissolve in excess NaOH]</li>
                                </ul>
                            </li>
                            <li><strong>Key Distinction:</strong> Only aluminum hydroxide dissolves in excess sodium hydroxide, forming a colorless solution</li>
                        </ul>
                    </div>
                    
                    <div class="info-box">
                        <h4>Identifying Unknown Ionic Compounds</h4>
                        <p>To identify an unknown ionic compound:</p>
                        <ol>
                            <li>First test for the cation (positive ion) using flame tests and/or sodium hydroxide tests</li>
                            <li>Then test for the anion (negative ion) using the appropriate tests for carbonates, halides, or sulfates</li>
                            <li>Combine the identified ions to determine the complete ionic compound</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="practiceMode" class="mode-section">
            <div class="section">
                <h2>Practice Mode</h2>
                <p>Test your knowledge of chemical tests for ions with these self-marking activities.</p>
                
                <div class="progress-container">
                    <div class="progress-bar" id="quizProgress"></div>
                </div>
                
                <div class="score-display">
                    Score: <span id="currentScore">0</span>/<span id="totalQuestions">0</span>
                </div>
            </div>
            
            <div id="quizContainer" class="section">
                <!-- Quiz questions will be loaded here -->
            </div>
            
            <div class="section">
                <button class="button" id="checkAnswersBtn" style="display: none;">Check Answers</button>
                <button class="button" id="nextQuestionBtn" style="display: none;">Next Question</button>
                <button class="button" id="restartQuizBtn" style="display: none;">Restart Quiz</button>
            </div>
            
            <div class="section" id="finalResults" style="display: none;">
                <h3>Quiz Results</h3>
                <p>You scored <span id="finalScore">0</span> out of <span id="totalQuestionsResult">0</span>.</p>
                <div id="feedbackMessage"></div>
                <button class="button" onclick="restartQuiz()">Try Again</button>
            </div>
        </div>
        
        <div id="requiredPractical" class="mode-section">
            <div class="section">
                <h2>Required Practical: Identifying Ions in Unknown Compounds</h2>
                <p>In this practical, you will learn how to identify ions in unknown single ionic compounds using the chemical tests you've learned.</p>
                
                <div class="info-box">
                    <p><strong>Safety Note:</strong> Always wear eye protection when performing chemical tests. Some reagents are corrosive or harmful.</p>
                </div>
            </div>
            
            <div class="section">
                <h3>Practical Simulator</h3>
                <p>Use this simulator to practice identifying unknown compounds.</p>
                
                <div id="practicalSimulator">
                    <p>You have an unknown compound labeled "Compound X". What tests would you perform to identify the ions present?</p>
                    
                    <div id="unknownCompound" style="text-align: center; margin: 20px 0;">
                        <div class="test-tube">
                            <div class="test-tube-content" id="unknownSample" style="background-color: #f5f5f5;"></div>
                        </div>
                        <p>Compound X</p>
                    </div>
                    
                    <h4>Available Tests:</h4>
                    <div class="animation-controls">
                        <button class="button" onclick="performTest('flame')">Flame Test</button>
                        <button class="button" onclick="performTest('naoh')">NaOH Test</button>
                        <button class="button" onclick="performTest('acid')">Acid Test</button>
                        <button class="button" onclick="performTest('agno3')">AgNO<sub>3</sub> Test</button>
                        <button class="button" onclick="performTest('bacl2')">BaCl<sub>2</sub> Test</button>
                    </div>
                    
                    <div id="testResults" style="display: none; margin-top: 20px;" class="animation-container">
                        <h4>Test Results:</h4>
                        <div id="resultDisplay"></div>
                    </div>
                    
                    <div id="identificationForm" style="margin-top: 20px; display: none;" class="animation-container">
                        <h4>Identify the Compound:</h4>
                        <p>Based on your tests, what ions are present in Compound X?</p>
                        
                        <div style="margin: 10px 0;">
                            <label>Positive Ion (Cation): </label>
                            <select id="cationSelect">
                                <option value="">Select...</option>
                                <option value="lithium">Lithium (Li⁺)</option>
                                <option value="sodium">Sodium (Na⁺)</option>
                                <option value="potassium">Potassium (K⁺)</option>
                                <option value="calcium">Calcium (Ca²⁺)</option>
                                <option value="magnesium">Magnesium (Mg²⁺)</option>
                                <option value="aluminum">Aluminum (Al³⁺)</option>
                                <option value="copper">Copper(II) (Cu²⁺)</option>
                                <option value="iron2">Iron(II) (Fe²⁺)</option>
                                <option value="iron3">Iron(III) (Fe³⁺)</option>
                            </select>
                        </div>
                        
                        <div style="margin: 10px 0;">
                            <label>Negative Ion (Anion): </label>
                            <select id="anionSelect">
                                <option value="">Select...</option>
                                <option value="chloride">Chloride (Cl⁻)</option>
                                <option value="bromide">Bromide (Br⁻)</option>
                                <option value="iodide">Iodide (I⁻)</option>
                                <option value="carbonate">Carbonate (CO₃²⁻)</option>
                                <option value="sulfate">Sulfate (SO₄²⁻)</option>
                            </select>
                        </div>
                        
                        <button class="button" id="identifyBtn">Identify Compound</button>
                    </div>
                    
                    <div id="identificationResult" style="margin-top: 20px; display: none;">
                        <div id="identificationFeedback"></div>
                        <button class="button" onclick="resetPractical()">Try Another Compound</button>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>Step-by-Step Guide</h3>
                <p>Follow these steps to identify unknown ionic compounds:</p>
                
                <ol>
                    <li><strong>Test for Cation:</strong>
                        <ul>
                            <li>Perform a flame test to identify potential metal ions</li>
                            <li>Perform a sodium hydroxide test to confirm the metal ion</li>
                        </ul>
                    </li>
                    <li><strong>Test for Anion:</strong>
                        <ul>
                            <li>Test with dilute acid to check for carbonates</li>
                            <li>Test with dilute nitric acid followed by silver nitrate to check for halides</li>
                            <li>Test with dilute hydrochloric acid followed by barium chloride to check for sulfates</li>
                        </ul>
                    </li>
                </ol>
            </div>
        </div>
    </div>
    
    <script>
        /* Make sure all text is contained within the script tags */
        /* Fix any text that might be leaking out at the bottom of the page */
        document.querySelectorAll('.tab-btn').forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.getAttribute('data-tab');
                
                // Hide all tab contents
                document.querySelectorAll('.tab-content').forEach(tab => {
                    tab.classList.remove('active');
                });
                
                // Remove active class from all buttons
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Show selected tab content and mark button as active
                document.getElementById(tabId).classList.add('active');
                button.classList.add('active');
            });
        });
        
        // Navigation between modes
        document.querySelectorAll('.nav-btn').forEach(button => {
            button.addEventListener('click', () => {
                const target = button.getAttribute('data-target');
                
                // Hide all sections
                document.querySelectorAll('.mode-section').forEach(section => {
                    section.style.display = 'none';
                });
                
                // Remove active class from all nav buttons
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Show selected section and mark button as active
                document.getElementById(target).style.display = 'block';
                button.classList.add('active');
                
                // Initialize quiz if practice mode is selected
                if (target === 'practiceMode' && !quizInitialized) {
                    initializeQuiz();
                }
                
                // Reset practical if required practical mode is selected
                if (target === 'requiredPractical') {
                    resetPractical();
                }
            });
        });
        
        // Show tutorial mode by default
        document.getElementById('tutorialMode').style.display = 'block';
        
        // Tutorial navigation
        document.querySelectorAll('.tutorial-nav').forEach(button => {
            button.addEventListener('click', () => {
                const sectionId = button.getAttribute('data-section');
                
                // Hide all sections
                document.querySelectorAll('.tutorial-section').forEach(section => {
                    section.style.display = 'none';
                });
                
                // Remove active class from all buttons
                document.querySelectorAll('.tutorial-nav').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Show selected section and mark button as active
                document.getElementById(sectionId).style.display = 'block';
                button.classList.add('active');
            });
        });
        
        // Animation buttons
        document.querySelectorAll('.show-animation').forEach(button => {
            button.addEventListener('click', () => {
                const animationId = button.getAttribute('data-animation');
                
                if (animationId === 'carbonateTest') {
                    runCarbonateAnimation();
                    
                    // Show the reset button
                    document.querySelector('.reset-animation[data-animation="carbonateTest"]').style.display = 'inline-block';
                    button.style.display = 'none';
                } else if (animationId === 'sulfateTest') {
                    runSulfateAnimation();
                    
                    // Show the reset button
                    document.querySelector('.reset-animation[data-animation="sulfateTest"]').style.display = 'inline-block';
                    button.style.display = 'none';
                }
            });
        });
        
        // Reset animation buttons
        document.querySelectorAll('.reset-animation').forEach(button => {
            button.addEventListener('click', () => {
                const animationId = button.getAttribute('data-animation');
                
                if (animationId === 'carbonateTest') {
                    resetCarbonateAnimation();
                    
                    // Hide reset button and show start button
                    button.style.display = 'none';
                    document.querySelector('.show-animation[data-animation="carbonateTest"]').style.display = 'inline-block';
                } else if (animationId === 'sulfateTest') {
                    resetSulfateAnimation();
                    
                    // Hide reset button and show start button
                    button.style.display = 'none';
                    document.querySelector('.show-animation[data-animation="sulfateTest"]').style.display = 'inline-block';
                }
            });
        });
        
        // Function to run the carbonate test animation
        function runCarbonateAnimation() {
            const animationDiv = document.getElementById('carbonateAnimation');
            const testTube = document.getElementById('carbTestTube');
            const bubbles = document.getElementById('carbBubbles');
            const limeWater = document.getElementById('limeWaterTube');
            const explanation = document.getElementById('animationExplanation');
            
            animationDiv.style.display = 'block';
            
            // Step 1: Initial state
            testTube.className = 'test-tube-content solution-clear';
            testTube.style.backgroundColor = '#f2f2f2';
            limeWater.className = 'test-tube-content solution-clear';
            bubbles.style.display = 'none';
            explanation.textContent = 'Step 1: Adding acid to carbonate';
            
            // Step 2: Add acid and produce bubbles
            setTimeout(() => {
                testTube.style.backgroundColor = '#ffecb3';
                bubbles.style.display = 'block';
                explanation.textContent = 'Step 2: Carbon dioxide gas is produced (bubbling)';
                
                // Step 3: CO2 bubbled through limewater
                setTimeout(() => {
                    // Create cloudy effect in limewater
                    const cloudyEffect = document.createElement('div');
                    cloudyEffect.className = 'cloudy-effect';
                    cloudyEffect.id = 'limewaterCloudy';
                    limeWater.appendChild(cloudyEffect);
                    explanation.textContent = 'Step 3: Carbon dioxide turns limewater cloudy (white precipitate of CaCO₃)';
                }, 3000);
            }, 1500);
        }
        
        // Function to reset the carbonate animation
        function resetCarbonateAnimation() {
            const animationDiv = document.getElementById('carbonateAnimation');
            const testTube = document.getElementById('carbTestTube');
            const bubbles = document.getElementById('carbBubbles');
            const limeWater = document.getElementById('limeWaterTube');
            const explanation = document.getElementById('animationExplanation');
            
            // Remove cloudy effect if exists
            const cloudyEffect = document.getElementById('limewaterCloudy');
            if (cloudyEffect) {
                cloudyEffect.remove();
            }
            
            // Reset to initial state
            testTube.className = 'test-tube-content solution-clear';
            testTube.style.backgroundColor = '#f2f2f2';
            limeWater.className = 'test-tube-content solution-clear';
            bubbles.style.display = 'none';
            explanation.textContent = 'Step 1: Adding acid to carbonate';
        }
        
        // Function to show halide precipitate animations
        function showHalideAnimation(halide) {
            const animationDiv = document.getElementById('halideAnimation');
            const startTube = document.getElementById('halideStartTube');
            const precipitateTube = document.getElementById('halidePrecipitate');
            const precipitateLabel = document.getElementById('precipitateLabel');
            const explanation = document.getElementById('halideAnimationExplanation');
            const resetButton = document.getElementById('resetHalideBtn');
            
            // Clear previous animation
            while (precipitateTube.firstChild) {
                precipitateTube.removeChild(precipitateTube.firstChild);
            }
            
            animationDiv.style.display = 'block';
            resetButton.style.display = 'inline-block';
            
            // Step 1: Initial state
            startTube.className = 'test-tube-content solution-clear';
            startTube.style.backgroundColor = '#e3f2fd';
            precipitateTube.className = 'test-tube-content solution-clear';
            explanation.textContent = 'Step 1: Starting with a halide solution';
            
            // Step 2: Add nitric acid
            setTimeout(() => {
                explanation.textContent = 'Step 2: Adding dilute nitric acid (HNO₃) to remove any carbonate ions';
                
                // Step 3: Add silver nitrate
                setTimeout(() => {
                    explanation.textContent = 'Step 3: Adding silver nitrate (AgNO₃) solution';
                    
                    // Step 4: Precipitate forms
                    setTimeout(() => {
                        // Create precipitation effect
                        const precipitateEffect = document.createElement('div');
                        precipitateEffect.className = 'precipitate-forming';
                        precipitateEffect.id = 'halidePrecipitateEffect';
                        
                        switch(halide) {
                            case 'chloride':
                                precipitateEffect.classList.add('precipitate-white');
                                precipitateLabel.textContent = 'White Precipitate (AgCl)';
                                explanation.textContent = 'Step 4: A white precipitate of silver chloride (AgCl) forms';
                                break;
                            case 'bromide':
                                precipitateEffect.style.backgroundColor = '#fff8e1';
                                precipitateEffect.style.backgroundImage = 'radial-gradient(circle, rgba(0,0,0,0.05) 1px, transparent 1px)';
                                precipitateLabel.textContent = 'Cream Precipitate (AgBr)';
                                explanation.textContent = 'Step 4: A cream precipitate of silver bromide (AgBr) forms';
                                break;
                            case 'iodide':
                                precipitateEffect.style.backgroundColor = '#fff59d';
                                precipitateEffect.style.backgroundImage = 'radial-gradient(circle, rgba(0,0,0,0.05) 1px, transparent 1px)';
                                precipitateLabel.textContent = 'Yellow Precipitate (AgI)';
                                explanation.textContent = 'Step 4: A yellow precipitate of silver iodide (AgI) forms';
                                break;
                        }
                        
                        precipitateTube.appendChild(precipitateEffect);
                    }, 2000);
                }, 2000);
            }, 1500);
        }
        
        // Function to reset halide animation
        function resetHalideAnimation() {
            const animationDiv = document.getElementById('halideAnimation');
            const startTube = document.getElementById('halideStartTube');
            const precipitateTube = document.getElementById('halidePrecipitate');
            const precipitateLabel = document.getElementById('precipitateLabel');
            const explanation = document.getElementById('halideAnimationExplanation');
            const resetButton = document.getElementById('resetHalideBtn');
            
            // Remove precipitate effect if exists
            const precipitateEffect = document.getElementById('halidePrecipitateEffect');
            if (precipitateEffect) {
                precipitateEffect.remove();
            }
            
            // Reset to initial state
            startTube.className = 'test-tube-content solution-clear';
            startTube.style.backgroundColor = '#e3f2fd';
            precipitateTube.className = 'test-tube-content solution-clear';
            precipitateLabel.textContent = 'Precipitate Forms';
            explanation.textContent = 'Step 1: Starting with a halide solution';
            
            // Hide reset button
            resetButton.style.display = 'none';
        }
        
        // Function to run the sulfate test animation
        function runSulfateAnimation() {
            const animationDiv = document.getElementById('sulfateAnimation');
            const precipitateTube = document.getElementById('sulfatePrecipitate');
            const explanation = document.getElementById('sulfateAnimationExplanation');
            
            // Clear previous animation
            while (precipitateTube.firstChild) {
                precipitateTube.removeChild(precipitateTube.firstChild);
            }
            
            animationDiv.style.display = 'block';
            
            // Step 1: Initial state
            precipitateTube.className = 'test-tube-content solution-clear';
            explanation.textContent = 'Step 1: Starting with the sulfate solution';
            
            // Step 2: Add hydrochloric acid
            setTimeout(() => {
                explanation.textContent = 'Step 2: Adding dilute hydrochloric acid (HCl) to remove any carbonate ions';
                
                // Step 3: Add barium chloride
                setTimeout(() => {
                    explanation.textContent = 'Step 3: Adding barium chloride (BaCl₂) solution';
                    
                    // Step 4: White precipitate forms
                    setTimeout(() => {
                        // Create white precipitate effect
                        const precipitateEffect = document.createElement('div');
                        precipitateEffect.className = 'precipitate-forming precipitate-white';
                        precipitateEffect.id = 'sulfatePrecipitateEffect';
                        precipitateTube.appendChild(precipitateEffect);
                        explanation.textContent = 'Step 4: A white precipitate of barium sulfate (BaSO₄) forms, confirming sulfate ions';
                    }, 2000);
                }, 2000);
            }, 1500);
        }
        
        // Function to reset sulfate animation
        function resetSulfateAnimation() {
            const animationDiv = document.getElementById('sulfateAnimation');
            const precipitateTube = document.getElementById('sulfatePrecipitate');
            const explanation = document.getElementById('sulfateAnimationExplanation');
            
            // Remove precipitate effect if exists
            const precipitateEffect = document.getElementById('sulfatePrecipitateEffect');
            if (precipitateEffect) {
                precipitateEffect.remove();
            }
            
            // Reset to initial state
            precipitateTube.className = 'test-tube-content solution-clear';
            explanation.textContent = 'Step 1: Starting with the sulfate solution';
        }
        
        // Function to show flame test animations
        function showFlameTestAnimation(metal) {
            const animationDiv = document.getElementById('flameTestAnimation');
            const flameColor = document.getElementById('flameColorAnimation');
            const wireLoop = document.getElementById('wireLoopContainer').querySelector('div:last-child');
            const explanation = document.getElementById('flameTestExplanation');
            const resetButton = document.getElementById('resetFlameBtn');
            
            animationDiv.style.display = 'block';
            resetButton.style.display = 'inline-block';
            
            // Reset animation
            flameColor.style.backgroundColor = '#ffffff';
            flameColor.className = 'flame-inner';
            wireLoop.style.backgroundColor = '#f5f5f5';
            explanation.textContent = 'Preparing to insert sample into flame';
            
            // Step 1: Sample on wire loop
            setTimeout(() => {
                explanation.textContent = 'Step 1: Sample placed on nichrome wire loop';
                
                // Step 2: Insert into flame
                setTimeout(() => {
                    explanation.textContent = 'Step 2: Wire loop inserted into flame';
                    flameColor.classList.add('flame-animation');
                    
                    // Step 3: Color changes
                    setTimeout(() => {
                        switch(metal) {
                            case 'lithium':
                                flameColor.style.backgroundColor = '#e91e63';
                                explanation.textContent = 'Step 3: Lithium produces a crimson red flame';
                                break;
                            case 'sodium':
                                flameColor.style.backgroundColor = '#ffeb3b';
                                explanation.textContent = 'Step 3: Sodium produces a bright yellow flame';
                                break;
                            case 'potassium':
                                flameColor.style.backgroundColor = '#ce93d8';
                                explanation.textContent = 'Step 3: Potassium produces a lilac flame';
                                break;
                            case 'calcium':
                                flameColor.style.backgroundColor = '#ff5722';
                                explanation.textContent = 'Step 3: Calcium produces an orange-red flame';
                                break;
                            case 'copper':
                                flameColor.style.backgroundColor = '#4caf50';
                                explanation.textContent = 'Step 3: Copper produces a green flame';
                                break;
                        }
                    }, 1500);
                }, 1500);
            }, 1000);
        }
        
        // Function to reset flame animation
        function resetFlameAnimation() {
            const animationDiv = document.getElementById('flameTestAnimation');
            const flameColor = document.getElementById('flameColorAnimation');
            const wireLoop = document.getElementById('wireLoopContainer').querySelector('div:last-child');
            const explanation = document.getElementById('flameTestExplanation');
            const resetButton = document.getElementById('resetFlameBtn');
            
            // Reset animation
            flameColor.style.backgroundColor = '#ffffff';
            flameColor.className = 'flame-inner';
            wireLoop.style.backgroundColor = '#f5f5f5';
            explanation.textContent = 'Preparing to insert sample into flame';
            
            // Hide reset button
            resetButton.style.display = 'none';
        }
        
        // Function to show sodium hydroxide test animations
        function showNaOHAnimation(metal) {
            const animationDiv = document.getElementById('naohAnimation');
            const ionSolution = document.getElementById('ionSolution');
            const ionLabel = document.getElementById('ionSolutionLabel');
            const precipitate = document.getElementById('naohPrecipitate');
            const excessResult = document.getElementById('excessNaohResult');
            const explanation = document.getElementById('naohAnimationExplanation');
            const resetButton = document.getElementById('resetNaOHBtn');
            
            animationDiv.style.display = 'block';
            resetButton.style.display = 'inline-block';
            
            // Clear previous animations
            while (precipitate.firstChild) {
                precipitate.removeChild(precipitate.firstChild);
            }
            
            while (excessResult.firstChild) {
                excessResult.removeChild(excessResult.firstChild);
            }
            
            // Set initial colors based on the metal ion
            switch(metal) {
                case 'aluminum':
                    ionSolution.className = 'test-tube-content solution-clear';
                    ionLabel.textContent = 'Aluminum (Al³⁺) Solution';
                    break;
                case 'calcium':
                    ionSolution.className = 'test-tube-content solution-clear';
                    ionLabel.textContent = 'Calcium (Ca²⁺) Solution';
                    break;
                case 'magnesium':
                    ionSolution.className = 'test-tube-content solution-clear';
                    ionLabel.textContent = 'Magnesium (Mg²⁺) Solution';
                    break;
                case 'copper':
                    ionSolution.style.backgroundColor = '#bbdefb';
                    ionSolution.className = 'test-tube-content';
                    ionLabel.textContent = 'Copper(II) (Cu²⁺) Solution';
                    break;
                case 'iron2':
                    ionSolution.style.backgroundColor = '#c8e6c9';
                    ionSolution.className = 'test-tube-content';
                    ionLabel.textContent = 'Iron(II) (Fe²⁺) Solution';
                    break;
                case 'iron3':
                    ionSolution.style.backgroundColor = '#ffe0b2';
                    ionSolution.className = 'test-tube-content';
                    ionLabel.textContent = 'Iron(III) (Fe³⁺) Solution';
                    break;
            }
            
            precipitate.className = 'test-tube-content solution-clear';
            excessResult.className = 'test-tube-content solution-clear';
            explanation.textContent = 'Step 1: Starting with the metal ion solution';
            
            // Step 2: Add sodium hydroxide
            setTimeout(() => {
                explanation.textContent = 'Step 2: Adding sodium hydroxide solution';
                
                // Step 3: Precipitate forms
                setTimeout(() => {
                    const precipitateEffect = document.createElement('div');
                    precipitateEffect.className = 'precipitate-forming';
                    precipitateEffect.id = 'naohPrecipitateEffect';
                    
                    switch(metal) {
                        case 'aluminum':
                            precipitateEffect.classList.add('precipitate-white');
                            explanation.textContent = 'Step 3: A white precipitate of aluminum hydroxide forms';
                            break;
                        case 'calcium':
                            precipitateEffect.classList.add('precipitate-white');
                            explanation.textContent = 'Step 3: A white precipitate of calcium hydroxide forms';
                            break;
                        case 'magnesium':
                            precipitateEffect.classList.add('precipitate-white');
                            explanation.textContent = 'Step 3: A white precipitate of magnesium hydroxide forms';
                            break;
                        case 'copper':
                            precipitateEffect.style.backgroundColor = '#2196f3';
                            precipitateEffect.style.boxShadow = 'inset 0 0 10px rgba(0, 0, 0, 0.1)';
                            explanation.textContent = 'Step 3: A blue precipitate of copper(II) hydroxide forms';
                            break;
                        case 'iron2':
                            precipitateEffect.style.backgroundColor = '#a5d6a7';
                            precipitateEffect.style.boxShadow = 'inset 0 0 10px rgba(0, 0, 0, 0.1)';
                            explanation.textContent = 'Step 3: A green precipitate of iron(II) hydroxide forms';
                            break;
                        case 'iron3':
                            precipitateEffect.style.backgroundColor = '#a1887f';
                            precipitateEffect.style.boxShadow = 'inset 0 0 10px rgba(0, 0, 0, 0.1)';
                            explanation.textContent = 'Step 3: A brown precipitate of iron(III) hydroxide forms';
                            break;
                    }
                    
                    precipitate.appendChild(precipitateEffect);
                    
                    // Step 4: Add excess sodium hydroxide
                    setTimeout(() => {
                        explanation.textContent = 'Step 4: Adding excess sodium hydroxide';
                        
                        // Step 5: Show result with excess NaOH
                        setTimeout(() => {
                            if (metal === 'aluminum') {
                                // For aluminum, the precipitate dissolves
                                const dissolvedEffect = document.createElement('div');
                                dissolvedEffect.className = 'test-tube-content solution-clear';
                                dissolvedEffect.style.height = '100%';
                                dissolvedEffect.id = 'naohExcessEffect';
                                excessResult.appendChild(dissolvedEffect);
                                explanation.textContent = 'Step 5: Aluminum hydroxide dissolves in excess NaOH to form a clear solution';
                            } else {
                                // For other metals, copy the precipitate to excessResult
                                const persistentPrecipitate = document.createElement('div');
                                persistentPrecipitate.className = precipitateEffect.className;
                                persistentPrecipitate.style.cssText = precipitateEffect.style.cssText;
                                persistentPrecipitate.style.animation = 'none';
                                persistentPrecipitate.style.height = '100%';
                                persistentPrecipitate.id = 'naohExcessEffect';
                                excessResult.appendChild(persistentPrecipitate);
                                explanation.textContent = 'Step 5: The precipitate does not dissolve in excess NaOH';
                            }
                        }, 2000);
                    }, 2000);
                }, 2000);
            }, 1500);
        }
        
        // Function to reset NaOH animation
        function resetNaOHAnimation() {
            const animationDiv = document.getElementById('naohAnimation');
            const ionSolution = document.getElementById('ionSolution');
            const ionLabel = document.getElementById('ionSolutionLabel');
            const precipitate = document.getElementById('naohPrecipitate');
            const excessResult = document.getElementById('excessNaohResult');
            const explanation = document.getElementById('naohAnimationExplanation');
            const resetButton = document.getElementById('resetNaOHBtn');
            
            // Remove precipitate effects if they exist
            const precipitateEffect = document.getElementById('naohPrecipitateEffect');
            if (precipitateEffect) {
                precipitateEffect.remove();
            }
            
            const excessEffect = document.getElementById('naohExcessEffect');
            if (excessEffect) {
                excessEffect.remove();
            }
            
            // Reset to initial state
            ionSolution.className = 'test-tube-content solution-clear';
            ionSolution.style.backgroundColor = '';
            ionLabel.textContent = 'Metal Ion Solution';
            precipitate.className = 'test-tube-content solution-clear';
            excessResult.className = 'test-tube-content solution-clear';
            explanation.textContent = 'Step 1: Starting with the metal ion solution';
            
            // Hide reset button
            resetButton.style.display = 'none';
        }
        
        // Quiz functionality
        let quizQuestions = [
            {
                question: "Which test would you use to identify carbonate ions?",
                options: [
                    "Add dilute acid and observe for bubbles/fizzing",
                    "Add silver nitrate and observe for a precipitate",
                    "Add barium chloride and observe for a precipitate",
                    "Perform a flame test"
                ],
                correctAnswer: 0,
                explanation: "Carbonates react with dilute acids to produce carbon dioxide gas, which causes bubbling/fizzing. This gas can turn limewater cloudy, confirming it's CO₂."
            },
            {
                question: "Which of the following is NOT a correct match between a halide ion and its silver nitrate precipitate color?",
                options: [
                    "Chloride ions - White precipitate",
                    "Bromide ions - Cream precipitate",
                    "Iodide ions - Yellow precipitate",
                    "Sulfate ions - White precipitate"
                ],
                correctAnswer: 3,
                explanation: "Sulfate ions are not halide ions. Halides (chloride, bromide, iodide) form precipitates with silver nitrate, but sulfate ions do not."
            },
            {
                question: "What color precipitate forms when sulfate ions react with barium chloride solution?",
                options: [
                    "Blue",
                    "Green",
                    "White",
                    "Yellow"
                ],
                correctAnswer: 2,
                explanation: "Sulfate ions form a white precipitate of barium sulfate (BaSO₄) when they react with barium chloride solution."
            },
            {
                question: "Which acid must be added before testing for halide ions with silver nitrate?",
                options: [
                    "Hydrochloric acid",
                    "Sulfuric acid",
                    "Nitric acid",
                    "Ethanoic acid"
                ],
                correctAnswer: 2,
                explanation: "Dilute nitric acid is added first to remove any carbonate ions that would also form a precipitate with silver nitrate, causing false results."
            },
            {
                question: "Which metal ion produces a lilac flame in a flame test?",
                options: [
                    "Sodium",
                    "Potassium",
                    "Lithium",
                    "Calcium"
                ],
                correctAnswer: 1,
                explanation: "Potassium compounds produce a distinctive lilac flame in flame tests."
            },
            {
                question: "Which metal hydroxide precipitate dissolves in excess sodium hydroxide?",
                options: [
                    "Calcium hydroxide",
                    "Copper(II) hydroxide",
                    "Aluminum hydroxide",
                    "Iron(III) hydroxide"
                ],
                correctAnswer: 2,
                explanation: "Aluminum hydroxide is the only precipitate among these that dissolves in excess sodium hydroxide to form a clear solution."
            },
            {
                question: "When identifying an unknown compound, a student adds dilute HCl and observes fizzing. What ion is likely present?",
                options: [
                    "Chloride ion",
                    "Sulfate ion",
                    "Carbonate ion",
                    "Hydroxide ion"
                ],
                correctAnswer: 2,
                explanation: "Fizzing or effervescence when acid is added indicates the evolution of a gas, which is characteristic of carbonate ions producing carbon dioxide."
            },
            {
                question: "A student is testing for sulfate ions. Which reagent should NOT be used?",
                options: [
                    "Barium chloride",
                    "Hydrochloric acid",
                    "Sulfuric acid",
                    "Water"
                ],
                correctAnswer: 2,
                explanation: "Sulfuric acid should not be used when testing for sulfate ions because it contains sulfate ions itself, which would lead to false positive results."
            },
            {
                question: "Which flame color could easily mask other flame colors in a mixture?",
                options: [
                    "Crimson (Lithium)",
                    "Yellow (Sodium)",
                    "Lilac (Potassium)",
                    "Green (Copper)"
                ],
                correctAnswer: 1,
                explanation: "The bright yellow flame of sodium is very intense and can easily mask other flame colors when present in a mixture."
            },
            {
                question: "A compound produces a white precipitate with silver nitrate in the presence of dilute nitric acid. What halide ion is present?",
                options: [
                    "Fluoride",
                    "Chloride",
                    "Bromide",
                    "Iodide"
                ],
                correctAnswer: 1,
                explanation: "A white precipitate with silver nitrate indicates the presence of chloride ions, forming silver chloride (AgCl)."
            }
        ];
        
        let currentQuestion = 0;
        let score = 0;
        let quizInitialized = false;
        let selectedOption = null;
        
        function initializeQuiz() {
            currentQuestion = 0;
            score = 0;
            quizInitialized = true;
            
            document.getElementById('totalQuestions').textContent = quizQuestions.length;
            document.getElementById('totalQuestionsResult').textContent = quizQuestions.length;
            
            showQuestion();
            updateProgress();
        }
        
        function showQuestion() {
            const questionData = quizQuestions[currentQuestion];
            const quizContainer = document.getElementById('quizContainer');
            
            // Reset selected option
            selectedOption = null;
            
            // Create question HTML
            let questionHTML = `
                <h3>Question ${currentQuestion + 1} of ${quizQuestions.length}</h3>
                <div class="question">
                    <p>${questionData.question}</p>
                    <div class="options">
            `;
            
            // Add options
            questionData.options.forEach((option, index) => {
                questionHTML += `
                    <div class="option" data-index="${index}" onclick="selectOption(this, ${index})">
                        ${option}
                    </div>
                `;
            });
            
            questionHTML += `
                    </div>
                </div>
                <div class="result" id="questionResult"></div>
            `;
            
            quizContainer.innerHTML = questionHTML;
            
            // Show check answer button
            document.getElementById('checkAnswersBtn').style.display = 'inline-block';
            document.getElementById('nextQuestionBtn').style.display = 'none';
            document.getElementById('restartQuizBtn').style.display = 'none';
            
            // Add event listener to check answer button
            document.getElementById('checkAnswersBtn').addEventListener('click', checkAnswer);
            document.getElementById('nextQuestionBtn').addEventListener('click', nextQuestion);
        }
        
        function selectOption(element, index) {
            // Remove selected class from all options
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Store selected option index
            selectedOption = index;
        }
        
        function checkAnswer() {
            if (selectedOption === null) {
                alert("Please select an answer.");
                return;
            }
            
            const questionData = quizQuestions[currentQuestion];
            const options = document.querySelectorAll('.option');
            const resultDisplay = document.getElementById('questionResult');
            
            // Mark selected option as correct or incorrect
            options.forEach((option, index) => {
                if (index === questionData.correctAnswer) {
                    option.classList.add('correct');
                } else if (index === selectedOption) {
                    option.classList.add('incorrect');
                }
            });
            
            // Update score if answer is correct
            if (selectedOption === questionData.correctAnswer) {
                score++;
                document.getElementById('currentScore').textContent = score;
                resultDisplay.textContent = "Correct! " + questionData.explanation;
                resultDisplay.classList.add('success');
            } else {
                resultDisplay.textContent = "Incorrect. " + questionData.explanation;
                resultDisplay.classList.add('error');
            }
            
            resultDisplay.style.display = 'block';
            
            // Show next question button or finish button
            document.getElementById('checkAnswersBtn').style.display = 'none';
            if (currentQuestion < quizQuestions.length - 1) {
                document.getElementById('nextQuestionBtn').style.display = 'inline-block';
            } else {
                document.getElementById('restartQuizBtn').style.display = 'inline-block';
                finishQuiz();
            }
        }
        
        function nextQuestion() {
            currentQuestion++;
            showQuestion();
            updateProgress();
        }
        
        function updateProgress() {
            const progressBar = document.getElementById('quizProgress');
            const progressPercentage = ((currentQuestion + 1) / quizQuestions.length) * 100;
            progressBar.style.width = progressPercentage + '%';
        }
        
        function finishQuiz() {
            document.getElementById('finalScore').textContent = score;
            document.getElementById('finalResults').style.display = 'block';
            
            // Add feedback based on score
            const feedbackMessage = document.getElementById('feedbackMessage');
            const percentage = (score / quizQuestions.length) * 100;
            
            if (percentage >= 90) {
                feedbackMessage.innerHTML = "<p>Excellent! You have a very good understanding of chemical tests for ions.</p>";
            } else if (percentage >= 70) {
                feedbackMessage.innerHTML = "<p>Good job! You understand most of the key concepts about chemical tests for ions.</p>";
            } else if (percentage >= 50) {
                feedbackMessage.innerHTML = "<p>You've made a good start, but you might want to review the tutorial again to strengthen your understanding.</p>";
            } else {
                feedbackMessage.innerHTML = "<p>It looks like you need more practice. Try reviewing the tutorial again and pay attention to the different tests and their results.</p>";
            }
        }
        
        function restartQuiz() {
            document.getElementById('finalResults').style.display = 'none';
            initializeQuiz();
        }
        
        // Practical simulator functionality
        let currentCompound = {};
        let testsPerformed = [];
        
        function resetPractical() {
            // Generate a random compound
            const cations = [
                { name: 'lithium', formula: 'Li⁺', flameColor: 'crimson' },
                { name: 'sodium', formula: 'Na⁺', flameColor: 'yellow' },
                { name: 'potassium', formula: 'K⁺', flameColor: 'lilac' },
                { name: 'calcium', formula: 'Ca²⁺', flameColor: 'orange-red', naohPrecipitate: 'white', dissolves: false },
                { name: 'magnesium', formula: 'Mg²⁺', naohPrecipitate: 'white', dissolves: false },
                { name: 'aluminum', formula: 'Al³⁺', naohPrecipitate: 'white', dissolves: true },
                { name: 'copper', formula: 'Cu²⁺', flameColor: 'green', naohPrecipitate: 'blue', dissolves: false },
                { name: 'iron2', formula: 'Fe²⁺', naohPrecipitate: 'green', dissolves: false },
                { name: 'iron3', formula: 'Fe³⁺', naohPrecipitate: 'brown', dissolves: false }
            ];
            
            const anions = [
                { name: 'chloride', formula: 'Cl⁻', agnoPrecipitate: 'white' },
                { name: 'bromide', formula: 'Br⁻', agnoPrecipitate: 'cream' },
                { name: 'iodide', formula: 'I⁻', agnoPrecipitate: 'yellow' },
                { name: 'carbonate', formula: 'CO₃²⁻', acidReaction: 'fizz' },
                { name: 'sulfate', formula: 'SO₄²⁻', baclPrecipitate: 'white' }
            ];
            
            const randomCation = cations[Math.floor(Math.random() * cations.length)];
            const randomAnion = anions[Math.floor(Math.random() * anions.length)];
            
            currentCompound = {
                cation: randomCation,
                anion: randomAnion
            };
            
            // Reset the interface
            document.getElementById('unknownSample').style.backgroundColor = getCompoundColor(randomCation, randomAnion);
            document.getElementById('testResults').style.display = 'none';
            document.getElementById('resultDisplay').innerHTML = '';
            document.getElementById('identificationForm').style.display = 'none';
            document.getElementById('identificationResult').style.display = 'none';
            document.getElementById('cationSelect').value = '';
            document.getElementById('anionSelect').value = '';
            
            // Reset tests performed
            testsPerformed = [];
        }
        
        function getCompoundColor(cation, anion) {
            // Simple logic to give color hints based on the compound
            if (cation.name === 'copper') {
                return '#bbdefb'; // Light blue for copper compounds
            } else if (anion.name === 'iodide') {
                return '#fff59d'; // Light yellow for iodides
            } else if (cation.name === 'iron3') {
                return '#ffe0b2'; // Light orange for iron(III) compounds
            } else if (cation.name === 'iron2') {
                return '#e8f5e9'; // Very light green for iron(II) compounds
            } else {
                return '#f1f5f9'; // Off-white with subtle texture for other compounds
            }
        }
        
        function performTest(test) {
            // Prevent repeating the same test
            if (testsPerformed.includes(test)) {
                alert("You've already performed this test. Try a different one.");
                return;
            }
            
            testsPerformed.push(test);
            
            // Display test results
            document.getElementById('testResults').style.display = 'block';
            const resultDisplay = document.getElementById('resultDisplay');
            
            let result = '';
            
            switch(test) {
                case 'flame':
                    if (currentCompound.cation.flameColor) {
                        // Create flame animation display
                        const flameAnimation = `
                            <div style="text-align: center; margin: 15px 0;">
                                <div class="flame" style="width: 60px; height: 100px; position: relative; display: inline-block;">
                                    <div style="position: absolute; bottom: 0; left: 10px; width: 40px; height: 80px; background-color: #f57c00; border-radius: 40% 40% 20% 20% / 60% 60% 40% 40%; opacity: 0.7;"></div>
                                    <div class="flame-inner flame-animation" style="position: absolute; bottom: 10px; left: 15px; width: 30px; height: 60px; border-radius: 50% 50% 20% 20% / 40% 40% 60% 60%; background-color: ${getFlameColor(currentCompound.cation.flameColor)};"></div>
                                </div>
                            </div>
                        `;
                        
                        result = `<p>Flame Test: The compound produces a <strong>${currentCompound.cation.flameColor}</strong> flame.</p>${flameAnimation}`;
                    } else {
                        result = `<p>Flame Test: No distinctive flame color observed.</p>`;
                    }
                    break;
                    
                case 'naoh':
                    if (currentCompound.cation.naohPrecipitate) {
                        // Create precipitate animation
                        const precipitateColor = getNaOHPrecipitateColor(currentCompound.cation.naohPrecipitate);
                        const dissolveAnimation = currentCompound.cation.dissolves ? 
                            `<div style="text-align: center; margin: 10px 0;">
                                <div class="test-tube">
                                    <div class="test-tube-content solution-clear" style="height: 70%;"></div>
                                </div>
                                <p>With excess NaOH: Dissolves</p>
                            </div>` 
                            : 
                            `<div style="text-align: center; margin: 10px 0;">
                                <div class="test-tube">
                                    <div class="test-tube-content" style="height: 70%;">
                                        <div class="precipitate-forming" style="background-color: ${precipitateColor}; animation: none; height: 100%;"></div>
                                    </div>
                                </div>
                                <p>With excess NaOH: Remains</p>
                            </div>`;
                        
                        const precipitateAnimation = `
                            <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap; margin: 15px 0;">
                                <div style="text-align: center;">
                                    <div class="test-tube">
                                        <div class="test-tube-content" style="height: 70%;">
                                            <div class="precipitate-forming" style="background-color: ${precipitateColor}; animation: none; height: 100%;"></div>
                                        </div>
                                    </div>
                                    <p>Precipitate forms</p>
                                </div>
                                <div class="arrow">→</div>
                                ${dissolveAnimation}
                            </div>
                        `;
                        
                        result = `<p>Sodium Hydroxide Test: A <strong>${currentCompound.cation.naohPrecipitate}</strong> precipitate forms.`;
                        if (currentCompound.cation.dissolves) {
                            result += ` The precipitate <strong>dissolves</strong> in excess NaOH.</p>${precipitateAnimation}`;
                        } else {
                            result += ` The precipitate <strong>does not dissolve</strong> in excess NaOH.</p>${precipitateAnimation}`;
                        }
                    } else {
                        result = `<p>Sodium Hydroxide Test: Results inconclusive.</p>`;
                    }
                    break;
                    
                case 'acid':
                    if (currentCompound.anion.acidReaction === 'fizz') {
                        // Create bubbling animation
                        const bubblesAnimation = `
                            <div style="text-align: center; margin: 15px 0;">
                                <div class="test-tube">
                                    <div class="test-tube-content" style="height: 70%; background-color: #ffecb3; position: relative;">
                                        <div class="bubble" style="width: 8px; height: 8px; left: 25%; top: 70%;"></div>
                                        <div class="bubble" style="width: 6px; height: 6px; left: 40%; top: 50%; animation-delay: 0.3s;"></div>
                                        <div class="bubble" style="width: 10px; height: 10px; left: 15%; top: 30%; animation-delay: 0.7s;"></div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        result = `<p>Acid Test: The compound <strong>fizzes</strong> when acid is added, producing a gas that turns limewater cloudy.</p>${bubblesAnimation}<p>This confirms the presence of <strong>carbonate ions</strong>.</p>`;
                    } else {
                        result = `<p>Acid Test: No fizzing observed when acid is added. This suggests <strong>carbonate ions are not present</strong>.</p>`;
                    }
                    break;
                    
                case 'agno3':
                    if (currentCompound.anion.agnoPrecipitate) {
                        // Create precipitate animation
                        const precipitateColor = getAgNO3PrecipitateColor(currentCompound.anion.agnoPrecipitate);
                        const precipitateAnimation = `
                            <div style="text-align: center; margin: 15px 0;">
                                <div class="test-tube">
                                    <div class="test-tube-content" style="height: 70%; position: relative;">
                                        <div class="precipitate-forming" style="background-color: ${precipitateColor}; animation: none; height: 100%;"></div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        result = `<p>Silver Nitrate Test: A <strong>${currentCompound.anion.agnoPrecipitate}</strong> precipitate forms when silver nitrate is added (with dilute nitric acid).</p>${precipitateAnimation}`;
                        
                        // Add interpretation
                        if (currentCompound.anion.agnoPrecipitate === 'white') {
                            result += `<p>This suggests the presence of <strong>chloride ions</strong>.</p>`;
                        } else if (currentCompound.anion.agnoPrecipitate === 'cream') {
                            result += `<p>This suggests the presence of <strong>bromide ions</strong>.</p>`;
                        } else if (currentCompound.anion.agnoPrecipitate === 'yellow') {
                            result += `<p>This suggests the presence of <strong>iodide ions</strong>.</p>`;
                        }
                    } else {
                        result = `<p>Silver Nitrate Test: No precipitate forms with silver nitrate and dilute nitric acid. This suggests <strong>halide ions are not present</strong>.</p>`;
                    }
                    break;
                    
                case 'bacl2':
                    if (currentCompound.anion.baclPrecipitate) {
                        // Create white precipitate animation
                        const precipitateAnimation = `
                            <div style="text-align: center; margin: 15px 0;">
                                <div class="test-tube">
                                    <div class="test-tube-content" style="height: 70%; position: relative;">
                                        <div class="precipitate-forming precipitate-white" style="animation: none; height: 100%;"></div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        result = `<p>Barium Chloride Test: A <strong>${currentCompound.anion.baclPrecipitate}</strong> precipitate forms when barium chloride is added (with dilute hydrochloric acid).</p>${precipitateAnimation}<p>This confirms the presence of <strong>sulfate ions</strong>.</p>`;
                    } else {
                        result = `<p>Barium Chloride Test: No precipitate forms with barium chloride and dilute hydrochloric acid. This suggests <strong>sulfate ions are not present</strong>.</p>`;
                    }
                    break;
            }
            
            // Helper functions for getting animation colors
            function getFlameColor(flameColorName) {
                switch(flameColorName) {
                    case 'crimson': return '#e91e63';
                    case 'yellow': return '#ffeb3b';
                    case 'lilac': return '#ce93d8';
                    case 'orange-red': return '#ff5722';
                    case 'green': return '#4caf50';
                    default: return '#ffffff';
                }
            }
            
            function getNaOHPrecipitateColor(precipitateColor) {
                switch(precipitateColor) {
                    case 'white': return '#ffffff';
                    case 'blue': return '#2196f3';
                    case 'green': return '#a5d6a7';
                    case 'brown': return '#a1887f';
                    default: return '#ffffff';
                }
            }
            
            function getAgNO3PrecipitateColor(precipitateColor) {
                switch(precipitateColor) {
                    case 'white': return '#ffffff';
                    case 'cream': return '#fff8e1';
                    case 'yellow': return '#fff59d';
                    default: return '#ffffff';
                }
            }
            
            resultDisplay.innerHTML += result;
            
            // Show identification form after at least 2 tests
            if (testsPerformed.length >= 2) {
                document.getElementById('identificationForm').style.display = 'block';
                
                // Add event listener to identify button
                document.getElementById('identifyBtn').addEventListener('click', identifyCompound);
            }
        }
        
        function identifyCompound() {
            const selectedCation = document.getElementById('cationSelect').value;
            const selectedAnion = document.getElementById('anionSelect').value;
            
            if (!selectedCation || !selectedAnion) {
                alert("Please select both a cation and an anion.");
                return;
            }
            
            document.getElementById('identificationResult').style.display = 'block';
            const feedback = document.getElementById('identificationFeedback');
            
            if (selectedCation === currentCompound.cation.name && selectedAnion === currentCompound.anion.name) {
                feedback.innerHTML = `
                    <div class="result success">
                        <h4>Correct!</h4>
                        <p>The unknown compound contains ${currentCompound.cation.formula} and ${currentCompound.anion.formula}.</p>
                        <p>The chemical formula is ${getCompoundFormula(currentCompound.cation, currentCompound.anion)}.</p>
                    </div>
                `;
            } else {
                feedback.innerHTML = `
                    <div class="result error">
                        <h4>Incorrect</h4>
                        <p>The unknown compound actually contains ${currentCompound.cation.formula} and ${currentCompound.anion.formula}.</p>
                        <p>The chemical formula is ${getCompoundFormula(currentCompound.cation, currentCompound.anion)}.</p>
                        <p>Review the test results and try again with a new compound.</p>
                    </div>
                `;
            }
        }
        
        function getCompoundFormula(cation, anion) {
            // Simple logic to create compound formulas
            let cationCharge = 1;
            let anionCharge = 1;
            
            if (cation.formula.includes('²⁺')) {
                cationCharge = 2;
            } else if (cation.formula.includes('³⁺')) {
                cationCharge = 3;
            }
            
            if (anion.formula.includes('²⁻')) {
                anionCharge = 2;
            } else if (anion.formula.includes('³⁻')) {
                anionCharge = 3;
            }
            
            // Extract base symbols
            let cationSymbol = cation.formula.split('⁺')[0].split('²')[0].split('³')[0];
            let anionSymbol = anion.formula.split('⁻')[0].split('²')[0].split('³')[0];
            
            // Special case for polyatomic ions
            if (anion.name === 'carbonate') {
                anionSymbol = 'CO₃';
                anionCharge = 2;
            } else if (anion.name === 'sulfate') {
                anionSymbol = 'SO₄';
                anionCharge = 2;
            }
            
            // Calculate subscripts
            const gcd = getGCD(cationCharge, anionCharge);
            const cationSubscript = anionCharge / gcd;
            const anionSubscript = cationCharge / gcd;
            
            // Format the formula
            let formula = cationSymbol;
            if (cationSubscript > 1) {
                formula += subscriptNumber(cationSubscript);
            }
            
            formula += anionSymbol;
            if (anionSubscript > 1) {
                formula += subscriptNumber(anionSubscript);
            }
            
            return formula;
        }
        
        function subscriptNumber(num) {
            // Convert numbers to subscript characters
            const subscripts = {
                '1': '₁', '2': '₂', '3': '₃', '4': '₄', '5': '₅',
                '6': '₆', '7': '₇', '8': '₈', '9': '₉', '0': '₀'
            };
            
            return num.toString().split('').map(digit => subscripts[digit]).join('');
        }
        
        function getGCD(a, b) {
            // Euclidean algorithm to find greatest common divisor
            while (b !== 0) {
                const temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }
        
        // Initialize the practical simulator
        window.onload = function() {
            // Set up the nav functionality
            const activeMode = document.querySelector('.nav-btn.active').getAttribute('data-target');
            document.getElementById(activeMode).style.display = 'block';
            
            // Reset practical if required
            if (activeMode === 'requiredPractical') {
                resetPractical();
            }
            
            // Make sure any text that might be on the page outside of containers is removed
            document.querySelectorAll('body > :not(.container):not(header):not(script)').forEach(el => {
                el.remove();
            });
        };
    </script>
</body>
</html>
